import{a as b,p as t,t as ue,w as Ct,v as Tt,x as St}from"./chunk-PVWAREVJ-BCzKU303.js";import{Q as He,a as _t,b as Rt,e as $t,c as Mt,d as Dt,f as Le,g as Ae,w as Lt,h as At,s as Q,u as xe}from"./supabaseClient-BnqcRS6D.js";import{S as Ot,n as je,r as Et,u as ge,b as Pt,k as Ve,Q as It,a as Ft}from"./QueryClientProvider-C6_AEzee.js";import{g as L}from"./index-DKtf60Sy.js";import{u as Ke,Q as W,T as K}from"./TaskForm-BEfxIYoC.js";import{D as Je}from"./DarkModeToggle-2kuRDiJV.js";function Oe(e,r){const n=new Set(r);return e.filter(s=>!n.has(s))}function zt(e,r,n){const s=e.slice(0);return s[r]=n,s}var qt=class extends Ot{#s;#e;#n;#o;#t;#r;#a;#i;#l=[];constructor(e,r,n){super(),this.#s=e,this.#o=n,this.#n=[],this.#t=[],this.#e=[],this.setQueries(r)}onSubscribe(){this.listeners.size===1&&this.#t.forEach(e=>{e.subscribe(r=>{this.#m(e,r)})})}onUnsubscribe(){this.listeners.size||this.destroy()}destroy(){this.listeners=new Set,this.#t.forEach(e=>{e.destroy()})}setQueries(e,r){this.#n=e,this.#o=r,je.batch(()=>{const n=this.#t,s=this.#u(this.#n);this.#l=s,s.forEach(l=>l.observer.setOptions(l.defaultedQueryOptions));const o=s.map(l=>l.observer),a=o.map(l=>l.getCurrentResult()),i=o.some((l,c)=>l!==n[c]);n.length===o.length&&!i||(this.#t=o,this.#e=a,this.hasListeners()&&(Oe(n,o).forEach(l=>{l.destroy()}),Oe(o,n).forEach(l=>{l.subscribe(c=>{this.#m(l,c)})}),this.#h()))})}getCurrentResult(){return this.#e}getQueries(){return this.#t.map(e=>e.getCurrentQuery())}getObservers(){return this.#t}getOptimisticResult(e,r){const n=this.#u(e),s=n.map(o=>o.observer.getOptimisticResult(o.defaultedQueryOptions));return[s,o=>this.#d(o??s,r),()=>this.#c(s,n)]}#c(e,r){return r.map((n,s)=>{const o=e[s];return n.defaultedQueryOptions.notifyOnChangeProps?o:n.observer.trackResult(o,a=>{r.forEach(i=>{i.observer.trackProp(a)})})})}#d(e,r){return r?((!this.#r||this.#e!==this.#i||r!==this.#a)&&(this.#a=r,this.#i=this.#e,this.#r=Et(this.#r,r(e))),this.#r):e}#u(e){const r=new Map(this.#t.map(s=>[s.options.queryHash,s])),n=[];return e.forEach(s=>{const o=this.#s.defaultQueryOptions(s),a=r.get(o.queryHash);a?n.push({defaultedQueryOptions:o,observer:a}):n.push({defaultedQueryOptions:o,observer:new He(this.#s,o)})}),n}#m(e,r){const n=this.#t.indexOf(e);n!==-1&&(this.#e=zt(this.#e,n,r),this.#h())}#h(){if(this.hasListeners()){const e=this.#r,r=this.#c(this.#e,this.#l),n=this.#d(r,this.#o?.combine);e!==n&&je.batch(()=>{this.listeners.forEach(s=>{s(this.#e)})})}}};function Ye({queries:e,...r},n){const s=ge(),o=_t(),a=Rt(),i=b.useMemo(()=>e.map(f=>{const j=s.defaultQueryOptions(f);return j._optimisticResults=o?"isRestoring":"optimistic",j}),[e,s,o]);i.forEach(f=>{$t(f),Mt(f,a)}),Dt(a);const[l]=b.useState(()=>new qt(s,i,r)),[c,u,p]=l.getOptimisticResult(i,r.combine),m=!o&&r.subscribed!==!1;b.useSyncExternalStore(b.useCallback(f=>m?l.subscribe(je.batchCalls(f)):Pt,[l,m]),()=>l.getCurrentResult(),()=>l.getCurrentResult()),b.useEffect(()=>{l.setQueries(i,r)},[i,r,l]);const k=c.some((f,j)=>Le(i[j],f))?c.flatMap((f,j)=>{const C=i[j];if(C){const _=new He(s,C);if(Le(C,f))return Ae(C,_,a);Lt(f,o)&&Ae(C,_,a)}return[]}):[];if(k.length>0)throw Promise.all(k);const N=c.find((f,j)=>{const C=i[j];return C&&At({result:f,errorResetBoundary:a,throwOnError:C.throwOnError,query:s.getQueryCache().get(C.queryHash),suspense:C.suspense})});if(N?.error)throw N.error;return u(p())}/*!
 * @gsap/react 2.1.2
 * https://gsap.com
 *
 * Copyright 2008-2025, GreenSock. All rights reserved.
 * Subject to the terms at https://gsap.com/standard-license or for
 * Club GSAP members, the agreement issued with that membership.
 * @author: Jack Doyle, jack@greensock.com
*/let Ee=typeof document<"u"?b.useLayoutEffect:b.useEffect,Pe=e=>e&&!Array.isArray(e)&&typeof e=="object",le=[],Ut={},Xe=L;const Se=(e,r=le)=>{let n=Ut;Pe(e)?(n=e,e=null,r="dependencies"in n?n.dependencies:le):Pe(r)&&(n=r,r="dependencies"in n?n.dependencies:le),e&&typeof e!="function"&&console.warn("First parameter must be a function or config object");const{scope:s,revertOnUpdate:o}=n,a=b.useRef(!1),i=b.useRef(Xe.context(()=>{},s)),l=b.useRef(u=>i.current.add(null,u)),c=r&&r.length&&!o;return c&&Ee(()=>(a.current=!0,()=>i.current.revert()),le),Ee(()=>{if(e&&i.current.add(e,s),!c||!a.current)return()=>i.current.revert()},r),{context:i.current,contextSafe:l.current}};Se.register=e=>{Xe=e};Se.headless=!0;function fe(e,r,n){if(!e||!r||!n)return 1;const s=new Date,a=new Date(e).getTime()-s.getTime(),i=Math.ceil(a/(1e3*3600*24));if(i<=0||n>=i)return 10;try{const l=n/i*(r/i)+Math.exp(4*(n/i)/(1-n/i))-1;return l<.25?1:l>=.25&&l<.5?2:l>=.5&&l<1?3:l>=1&&l<1.75?4:l>=1.75&&l<2.5?5:l>=2.5&&l<4?6:l>=4&&l<5.5?7:l>=5.5&&l<7.5?8:l>=7.5&&l<10?9:10}catch(l){return console.warn("Urgency calculation failed:",l),1}}function Bt(e){return e.type!=="task"?1:fe(e.deadline,e.completion_time,e.unique_days_required)}function Qt(e=1){switch(e){case 1:return"";case 2:return"bg-lime-400";case 3:return"bg-yellow-400";case 4:return"bg-yellow-500";case 5:return"bg-amber-500";case 6:return"bg-orange-400";case 7:return"bg-orange-500";case 8:return"bg-red-400";case 9:return"bg-red-500";case 10:return"bg-red-600";default:return""}}function Gt(e=1){if(e<=1)return"";switch(e){case 2:case 3:return"w-2 h-2";case 4:case 5:case 6:return"w-3 h-3";case 7:case 8:return"w-4 h-4";case 9:case 10:return"w-5 h-5";default:return"w-2 h-2"}}function Wt(e=1){if(e<=1)return 0;switch(e){case 2:return 4;case 3:return 3.5;case 4:return 3;case 5:return 2.5;case 6:return 2;case 7:return 1.5;case 8:return 1.2;case 9:return 1;case 10:return .8;default:return 2}}function Ht(e=1){if(e<=1)return"";switch(e){case 2:return"shadow-sm shadow-lime-400/50";case 3:return"shadow-sm shadow-yellow-400/50";case 4:return"shadow-sm shadow-yellow-500/50";case 5:return"shadow-md shadow-amber-500/50";case 6:return"shadow-md shadow-orange-400/50";case 7:return"shadow-md shadow-orange-500/50";case 8:return"shadow-lg shadow-red-400/60";case 9:return"shadow-lg shadow-red-500/70";case 10:return"shadow-xl shadow-red-600/80";default:return""}}function ke(e=1){return e>1}function Ie(e){const r=e.getBoundingClientRect(),n=r.width,s=r.height,o=window.getComputedStyle(e),a=parseFloat(o.borderRadius)||8,i=Math.min(n,s)/2,l=Math.min(a,i),c=[],u=0,p=n,m=0,h=s;return c.push(`M ${n/2} ${m}`),c.push(`L ${p-l} ${m}`),c.push(`Q ${p} ${m} ${p} ${m+l}`),c.push(`L ${p} ${h-l}`),c.push(`Q ${p} ${h} ${p-l} ${h}`),c.push(`L ${u+l} ${h}`),c.push(`Q ${u} ${h} ${u} ${h-l}`),c.push(`L ${u} ${m+l}`),c.push(`Q ${u} ${m} ${u+l} ${m}`),c.push(`L ${n/2} ${m}`),c.join(" ")}function ye(e=1){return{duration:Wt(e),ease:"none",repeat:-1,autoRotate:e>=7,yoyo:!1}}function Ze(e){if(e.type==="task")return Bt(e);if(!e.children||e.children.length===0)return 1;const r=e.children.map(n=>Ze(n));return Math.max(...r)}function et(e){return Ze(e)}function Vt(e=1){switch(e){case 1:return"";case 2:return"border-2 border-cyan-400";case 3:return"border-2 border-cyan-500";case 4:return"border-2 border-blue-400";case 5:return"border-2 border-blue-500";case 6:return"border-2 border-indigo-400";case 7:return"border-2 border-indigo-500";case 8:return"border-2 border-purple-400";case 9:return"border-2 border-purple-500";case 10:return"border-2 border-purple-600";default:return""}}function Kt(e=1){if(e<=1)return"";switch(e){case 2:return"shadow-lg shadow-cyan-400/50";case 3:return"shadow-lg shadow-cyan-500/50";case 4:return"shadow-lg shadow-blue-400/50";case 5:return"shadow-lg shadow-blue-500/50";case 6:return"shadow-lg shadow-indigo-400/50";case 7:return"shadow-lg shadow-indigo-500/50";case 8:return"shadow-lg shadow-purple-400/50";case 9:return"shadow-lg shadow-purple-500/50";case 10:return"shadow-xl shadow-purple-600/75";default:return""}}function tt(e){if(e.type==="task")return e.importance??1;if(!e.children||e.children.length===0)return 1;const r=e.children.map(n=>tt(n));return Math.max(...r)}function _e(e){return tt(e)}function Jt(e){return!e||e<=1?"rgba(0, 0, 0, 0)":e<=3?"rgba(6, 182, 212, 0.6)":e<=5?"rgba(59, 130, 246, 0.6)":e<=7?"rgba(99, 102, 241, 0.6)":e<=9?"rgba(147, 51, 234, 0.6)":"rgba(126, 34, 206, 0.8)"}function rt(e,r,n){const s=n?`${n}/${e.name}`:`/${e.name}`;if(et(e)<=1)return[];if(e.type==="task")return[s];if(!r[s])return[s];const i=[];if(e.children)for(const l of e.children){const c=rt(l,r,s);i.push(...c)}return i}function st(e,r,n){const s=n?`${n}/${e.name}`:`/${e.name}`;if(_e(e)!==10)return null;if(e.type==="task"||!r[s])return s;if(e.children)for(const i of e.children){const l=st(i,r,s);if(l)return l}return null}function Yt({containerRef:e,tree:r,openMap:n,tabName:s,isMobile:o,activePath:a}){Se(()=>{const i=e?.current;if(!i){console.log("ðŸ” GSAP: No container found, skipping animations");return}L.killTweensOf("*"),L.set("*",{clearProps:"all"});const l=setTimeout(()=>{try{o?u():(c(),p())}catch(m){console.error("ðŸš¨ GSAP: Animation error:",m)}},100),c=()=>{const m=new Set;if(r.children)for(const k of r.children)rt(k,n,`/${s}`).forEach(f=>m.add(f));i.querySelectorAll("[data-urgency-ball]").forEach(k=>{const N=k.getAttribute("data-urgency-ball");if(!N)return;if(!m.has(N)){L.set(k,{opacity:0});return}L.set(k,{opacity:1});const f=i.querySelector(`[data-node-path="${N}"]`);if(!f)return;const j=parseInt(f.getAttribute("data-urgency")||"1");if(ke(j))try{const C=Ie(f),_=ye(j);L.set(k,{position:"absolute",left:0,top:0,xPercent:-50,yPercent:-50}),L.to(k,{motionPath:{path:C,autoRotate:_.autoRotate,alignOrigin:[.5,.5]},duration:_.duration,ease:_.ease,repeat:_.repeat})}catch(C){console.error(`ðŸš¨ GSAP: Failed animating ball for ${N}`,C)}})},u=()=>{i.querySelectorAll("[data-urgency-ball]").forEach(h=>{const k=h.getAttribute("data-urgency-ball");if(!k)return;const N=i.querySelector(`[data-node-path="${k}"]`);if(!N){L.set(h,{opacity:0});return}const f=parseInt(N.getAttribute("data-urgency")||"1");if(!ke(f)){L.set(h,{opacity:0});return}try{L.set(h,{opacity:1});const j=Ie(N),C=ye(f);L.set(h,{position:"absolute",left:0,top:0,xPercent:-50,yPercent:-50}),L.to(h,{motionPath:{path:j,autoRotate:C.autoRotate,alignOrigin:[.5,.5]},duration:C.duration,ease:C.ease,repeat:C.repeat})}catch(j){console.error(`ðŸš¨ GSAP: Failed animating mobile ball for ${k}`,j),L.set(h,{position:"absolute",left:"50%",top:"0px",xPercent:-50,yPercent:-50}),L.to(h,{rotation:360,duration:ye(f).duration,repeat:-1,ease:"none",transformOrigin:"50% 100px"})}})},p=()=>{if(r.children)for(const m of r.children){const h=st(m,n,`/${s}`);if(!h)continue;const k=i.querySelector(`[data-node-path="${h}"]`);if(!k)continue;const N=_e(m),f=Jt(N);L.set(k,{boxShadow:`0 0 20px ${f}`}),L.to(k,{scale:1.03,duration:1.2,ease:"power2.inOut",yoyo:!0,repeat:-1})}};return()=>{clearTimeout(l),L.killTweensOf("*"),L.set("*",{clearProps:"all"})}},{scope:e,dependencies:[r,n,s,o,a],revertOnUpdate:!0})}function nt(e,r,n="",s){const o=n?`${n}/${e.name}`:`/${s}`;if(e.children){for(const a of e.children)if(`${o}/${a.name}`===r)return e.children.map(l=>`${o}/${l.name}`);for(const a of e.children){const i=nt(a,r,o,s);if(i.length>0)return i}}return[]}function Xt(e,r,n){return b.useCallback(s=>{n(o=>{const a={...o};return o[s]?Object.keys(o).filter(c=>c.startsWith(s+"/")||c===s).forEach(c=>{a[c]=!1}):(nt(e,s,"",r).forEach(c=>{c!==s&&(a[c]=!1,Object.keys(o).forEach(u=>{u.startsWith(c+"/")&&(a[u]=!1)}))}),a[s]=!0),a})},[e,r,n])}function ot(e=640){const[r,n]=b.useState(!1);return b.useEffect(()=>{const s=()=>n(window.innerWidth<e);return s(),window.addEventListener("resize",s),()=>window.removeEventListener("resize",s)},[e]),r}function Zt(e){const r=new Map,n={};return e.forEach(s=>{r.set(s.id,{id:s.id,name:s.name,type:s.type,details:s.details??void 0,importance:s.importance??(s.type==="task"?1:void 0),deadline:s.deadline??void 0,completion_time:s.completion_time??void 0,unique_days_required:s.unique_days_required??void 0,is_completed:s.is_completed??void 0,completed_at:s.completed_at??void 0,completion_comment:s.completion_comment??void 0,children:[],tab_name:s.tab_name,root_category:s.root_category,parent_id:s.parent_id,recurrence_type:s.recurrence_type??void 0,recurrence_interval:s.recurrence_interval??void 0,recurrence_day_of_week:s.recurrence_day_of_week??void 0,recurrence_day_of_month:s.recurrence_day_of_month??void 0,recurrence_end_date:s.recurrence_end_date??void 0,is_recurring_template:s.is_recurring_template??void 0,recurring_template_id:s.recurring_template_id??void 0})}),e.forEach(s=>{const o=r.get(s.id);if(s.parent_id){const a=r.get(s.parent_id);a&&a.children.push(o)}else n[s.root_category??"default"]=o}),n}async function Re(e){const{data:r,error:n}=await Q.from("org_nodes").select("*").eq("root_category",e).not("is_completed","is",!0),s=r;if(n)throw n;return Zt(s??[])[e]??{id:0,name:e,type:"category",root_category:e,children:[]}}const er=()=>{const e=ge();return Ke({mutationFn:async r=>{if(r.id){const{data:n,error:s}=await Q.from("org_nodes").update({...r,type:"category"}).eq("id",r.id).select().single();if(s)throw s;return n}else{const{data:n,error:s}=await Q.from("org_nodes").insert({...r,type:"category"}).select().single();if(s)throw s;return n}},onSuccess:r=>{e.setQueryData(W.category(r.id),r),e.invalidateQueries({queryKey:W.allOrgTrees()})},onError:r=>{console.error("âŒ Save category error:",r)}})},at=()=>{const e=ge();return Ke({mutationFn:async r=>{const{error:n}=await Q.from("org_nodes").delete().eq("id",r);if(n)throw n;return r},onSuccess:r=>{e.removeQueries({queryKey:W.category(r)}),e.invalidateQueries({queryKey:W.allOrgTrees()})},onError:r=>{console.error("âŒ Delete category error:",r)}})};function Fe({category:e,onCancel:r,parentId:n,parentName:s,rootCategory:o,tabName:a}){const[i,l]=b.useState(e?.name??""),c=er(),u=at(),p=!e,m=!!e;b.useEffect(()=>{e&&l(e.name)},[e]);const h=()=>m&&e?.root_category?e.root_category:p&&s&&o?`${o} > ${s}`:"Unknown",k=f=>{f.preventDefault();const j=e?.parent_id??n,C=e?.root_category??o,_=e?.tab_name??a;if(p&&(!j||!C||!_)){console.error("âŒ Missing required parent context for new category:",{parentId:j,rootCategory:C,tabName:_}),alert("Missing parent information. Please try again.");return}const O={id:e?.id,name:i.trim(),parent_id:j,root_category:C,tab_name:_,type:"category"};console.log("ðŸš€ Submitting category data:",O),c.mutate(O,{onSuccess:S=>{console.log("âœ… Category saved successfully:",S),r()},onError:S=>{console.error("âŒ Failed to save category:",S),alert(`Failed to save category: ${S.message}`)}})},N=()=>{if(e?.id){if(!confirm(`Are you sure you want to delete "${e.name}"?`))return;console.log("ðŸ—‘ï¸ Deleting category:",e.id),u.mutate(e.id,{onSuccess:()=>{console.log("âœ… Category deleted successfully"),r()},onError:f=>{console.error("âŒ Failed to delete category:",f),alert(`Failed to delete category: ${f.message}`)}})}};return t.jsx("div",{className:"bg-opacity-50 fixed inset-0 z-[70] flex items-center justify-center bg-black",children:t.jsxs("form",{onSubmit:k,className:"mx-4 max-h-[90vh] w-full max-w-md space-y-4 overflow-y-auto rounded-lg bg-white p-6 text-black shadow-md",children:[t.jsxs("div",{className:"mb-4 flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("h3",{className:"text-xl font-bold",children:p?"Create New Category":"Edit Category"}),t.jsx("p",{className:"text-sm text-gray-600",children:p?`Adding to: ${h()}`:`Location: ${h()}`})]}),t.jsx("button",{type:"button",onClick:r,className:"text-2xl font-bold text-gray-500 hover:text-gray-800",children:"Ã—"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"mb-1 block text-sm font-medium text-gray-700",children:"Category Name *"}),t.jsx("input",{className:"w-full rounded border border-gray-300 p-2 focus:border-blue-500 focus:ring-2 focus:ring-blue-500",value:i,onChange:f=>l(f.target.value),placeholder:"Enter category name",required:!0})]}),t.jsxs("div",{className:"flex justify-between border-t pt-4",children:[m&&t.jsx("button",{type:"button",onClick:N,disabled:u.isPending,className:"rounded bg-red-600 px-4 py-2 text-white hover:bg-red-700 disabled:opacity-50",children:u.isPending?"Deleting...":"Delete Category"}),t.jsxs("div",{className:`${m?"ml-auto":""} space-x-2`,children:[t.jsx("button",{type:"button",onClick:r,className:"rounded bg-gray-300 px-4 py-2 text-white hover:bg-gray-400",children:"Cancel"}),t.jsx("button",{type:"submit",disabled:c.isPending||!i.trim(),className:"rounded bg-blue-600 px-4 py-2 text-white hover:bg-blue-700 disabled:opacity-50",children:c.isPending?p?"Creating...":"Saving...":p?"Create Category":"Save Changes"})]})]})]})})}function me({node:e,level:r=0,onTaskClick:n,openMap:s,toggleOpen:o,path:a,disableExpand:i,isRoot:l=!1}){const c=e.type==="task",u=s[a]||!1,[p,m]=b.useState(!1),[h,k]=b.useState(!1),[N,f]=b.useState(!1),j=et(e),C=_e(e),_=()=>m(!1),O=()=>k(!1);return at(),l?t.jsxs("div",{className:"grid auto-cols-min grid-flow-col gap-8",children:[t.jsx("h2",{className:"mb-8 text-center text-3xl font-bold text-gray-900 dark:text-gray-100",children:e.name}),e.children&&e.children.length>0?t.jsx("div",{className:"node-with-children",children:e.children.map(S=>t.jsx(me,{node:S,level:r+1,onTaskClick:n,openMap:s,toggleOpen:o,path:`${a}/${S.name}`,disableExpand:i,isRoot:!1},S.name))}):t.jsx("div",{className:"py-12 text-center",children:t.jsx("p",{className:"text-gray-600 dark:text-gray-300",children:"No items in this category yet."})}),p&&t.jsx(K,{parentId:e.id,parentName:e.name,rootCategory:e.root_category,tabName:e.root_category,onCancel:_}),h&&t.jsx(Fe,{parentId:e.id,parentName:e.name,rootCategory:e.root_category,tabName:e.root_category,onCancel:_})]}):t.jsxs("div",{className:"flex w-full flex-col items-center",children:[t.jsxs("div",{"data-node-path":a,"data-urgency":j,className:`relative min-w-[120px] rounded-lg bg-white text-center shadow-amber-600 outline outline-gray-400 ${e.is_completed?"bg-green-50 opacity-60":""} ${Vt(C)} ${Kt(C)}`,children:[!e.is_completed&&ke(j)&&t.jsx("div",{className:`pointer-events-none absolute z-10 rounded-full ${Qt(j)} ${Gt(j)} ${Ht(j)}`,"data-urgency-ball":a,style:{left:"50%",top:"50%",transform:"translate(-50%, -50%)"}}),c?t.jsxs("button",{className:`h-full w-full rounded-lg p-2 text-lg font-semibold underline hover:text-blue-200 focus:outline-none ${e.is_completed?"bg-green-600 text-white line-through":"bg-blue-600 text-white"}`,onClick:()=>n(e),children:[e.name,e.is_completed&&t.jsx("span",{className:"ml-2 text-xs",children:"âœ“"})]}):t.jsx("button",{className:"w-full rounded-lg bg-gray-800 p-2 text-center text-lg font-semibold text-white focus:outline-none",onClick:()=>!i&&o(a),type:"button",disabled:i,children:t.jsxs("span",{className:"flex items-center justify-center gap-2",children:[e.name,!i&&t.jsx("span",{className:"ml-1 text-gray-400",children:u?"â–¼":"â–¶"})]})})]}),!c&&u&&!i&&t.jsxs("div",{className:"mt-4 grid w-full auto-cols-min grid-flow-col gap-4",children:[e.children?.map(S=>t.jsx(me,{node:S,level:r+1,onTaskClick:n,openMap:s,toggleOpen:o,path:`${a}/${S.name}`,disableExpand:i,isRoot:!1},S.name)),t.jsxs("div",{className:"flex gap-2",children:[t.jsx("button",{className:"flex h-8 w-8 items-center justify-center rounded-full bg-blue-600 text-xl font-bold text-white hover:bg-blue-700",onClick:()=>m(!0),title:"Add Task",type:"button",children:"+"}),t.jsx("button",{className:"flex h-8 w-8 items-center justify-center rounded-full bg-green-600 text-xl font-bold text-white hover:bg-green-700",onClick:()=>k(!0),title:"Add Category",type:"button",children:"ðŸ“"}),(!e.children||e.children.length===0)&&t.jsx("button",{className:"flex h-8 w-8 items-center justify-center rounded-full bg-red-600 text-xl font-bold text-white hover:bg-red-700",onClick:()=>{f(!0)},title:"Delete Category",type:"button",children:"ðŸ—‘ï¸"})]})]}),p&&t.jsx(K,{parentId:e.id,parentName:e.name,rootCategory:e.root_category,tabName:e.root_category,onCancel:_}),N&&t.jsx("div",{className:"bg-opacity-50 fixed inset-0 z-[70] flex items-center justify-center bg-black",children:t.jsxs("div",{className:"mx-4 max-w-sm rounded-lg bg-white p-6 text-black",children:[t.jsx("h3",{className:"mb-4 text-lg font-bold",children:"Delete Category"}),t.jsxs("p",{className:"mb-4",children:['Are you sure you want to delete "',e.name,'"?']}),t.jsxs("div",{className:"flex justify-end gap-2",children:[t.jsx("button",{onClick:()=>f(!1),className:"rounded bg-gray-300 px-4 py-2 hover:bg-gray-400",children:"Cancel"}),t.jsx("button",{onClick:()=>{f(!1)},className:"rounded bg-red-600 px-4 py-2 text-white hover:bg-red-700",children:"Delete"})]})]})}),h&&t.jsx(Fe,{parentId:e.id,parentName:e.name,rootCategory:e.root_category,tabName:e.root_category,onCancel:O})]})}function tr({currentNode:e,activePath:r,setActivePath:n,onTaskClick:s,tabName:o}){const[a,i]=b.useState(!1),l=m=>{const h=`${r}/${m.name}`;console.log(`Mobile: navigating forward to ${h}`),n(h)},c=()=>{const m=r.split("/").slice(0,-1).join("/")||`/${o}`;console.log(`Mobile: navigating back to ${m}`),n(m)},u=()=>i(!1),p=()=>{if(!r||typeof r!="string")return console.warn("MobileOrgChart: activePath is undefined or not a string:",r),o;try{return r.replace(`/${o}`,o).replace(/\//g," â†’ ")}catch(m){return console.error("Error generating breadcrumb:",m),o}};return r?t.jsxs("div",{className:"mx-auto flex w-full max-w-md flex-col p-4",children:[t.jsx("h2",{className:"mb-4 text-center text-2xl font-bold text-gray-900 dark:text-gray-100",children:o}),t.jsx("div",{className:"mb-2 text-sm text-gray-600 dark:text-gray-400",children:p()}),r!==`/${o}`&&t.jsx("button",{onClick:c,className:"mb-4 text-left font-semibold text-blue-600 transition-colors hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300",children:"â† Back"}),e.type==="category"&&t.jsx("div",{className:"mb-4 flex justify-center",children:t.jsxs("button",{className:"flex items-center justify-center space-x-2 rounded-lg bg-blue-600 px-4 py-3 font-semibold text-white shadow-lg transition-colors hover:bg-blue-700 active:bg-blue-800",onClick:()=>i(!0),title:"Add new task or category",type:"button",children:[t.jsx("svg",{className:"h-5 w-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),t.jsx("span",{children:"Add Task"})]})}),t.jsxs("div",{className:"flex flex-col gap-4",children:[e.children?.map(m=>{const h=`${r}/${m.name}`;return t.jsxs("div",{className:"flex items-center justify-between gap-3",children:[t.jsx("div",{className:"flex-1",children:t.jsx(me,{node:m,level:1,onTaskClick:s,openMap:{},toggleOpen:()=>{},path:h,disableExpand:!0,isRoot:!1})}),!m.is_completed&&m.children?.length?t.jsx("button",{onClick:()=>l(m),className:"flex-shrink-0 rounded border border-blue-600 px-3 py-1 text-sm text-blue-600 transition-colors hover:bg-blue-50 hover:text-blue-800 dark:border-blue-400 dark:text-blue-400 dark:hover:bg-blue-900/20 dark:hover:text-blue-300",children:"Enter â†’"}):null]},h)}),!e.children?.length&&t.jsxs("div",{className:"py-8 text-center text-gray-500 dark:text-gray-400",children:["No items in this category",e.type==="category"&&t.jsx("div",{className:"mt-4",children:t.jsx("button",{className:"rounded-lg bg-blue-600 px-6 py-3 font-semibold text-white transition-colors hover:bg-blue-700",onClick:()=>i(!0),children:"Add First Task"})})]})]}),a&&t.jsx(K,{parentId:e.id,parentName:e.name,rootCategory:e.root_category,tabName:e.root_category,onCancel:u})]}):(console.error("MobileOrgChart: activePath is required but was:",r),t.jsx("div",{className:"mx-auto flex w-full max-w-md flex-col p-4",children:t.jsx("div",{className:"py-8 text-center text-red-600",children:"Navigation error: Invalid path"})}))}const rr=(e,r)=>{const n=r.split("/").filter(Boolean);if(!n.length)return e;let s=e;for(let o=1;o<n.length;o++)if(!s?.children||(s=s.children.find(a=>a.name===n[o]),!s))return null;return s||null};function sr({tabName:e}){const r=b.useRef(null),n=ot(),[s,o]=b.useState({}),[a,i]=b.useState(null),[l,c]=b.useState(`/${e}`);b.useEffect(()=>{c(`/${e}`)},[e]);const{data:u,isLoading:p,error:m}=xe({queryKey:W.orgTree(e),queryFn:()=>Re(e),placeholderData:Ve}),h=Xt(u||{},e,o);Yt({containerRef:r,tree:u||{},openMap:s,tabName:e,isMobile:n,activePath:n?l:void 0});const k=j=>i(j),N=()=>i(null);if(p)return t.jsxs("div",{className:"py-8 text-center text-gray-900 dark:text-gray-100",children:["Loading ",e," tree..."]});if(m)return t.jsxs("div",{className:"py-8 text-center text-red-600 dark:text-red-400",children:["Error loading ",e," tree"]});if(!u)return t.jsx("div",{className:"py-8 text-center text-gray-900 dark:text-gray-100",children:"No data found"});const f=n?rr(u,l):null;return t.jsxs(t.Fragment,{children:[t.jsx("div",{ref:r,className:"relative flex h-full w-full items-start p-4",children:n?f&&l?t.jsx(tr,{root:u,currentNode:f,activePath:l,setActivePath:c,onTaskClick:k,tabName:e}):t.jsxs("div",{className:"py-8 text-center text-red-600",children:["Navigation error: Node not found",t.jsxs("div",{className:"mt-2 text-sm",children:["Tab: ",e,", Path: ",l||"undefined"]})]}):t.jsx(me,{node:u,level:0,onTaskClick:k,openMap:s,toggleOpen:h,path:`/${e}`,isRoot:!0})}),a&&t.jsx(K,{task:a,onCancel:N})]})}function nr({isOpen:e,onClose:r,initialTaskId:n}){const[s,o]=b.useState("add"),[a,i]=b.useState([]),[l,c]=b.useState([]),[u,p]=b.useState(!0),[m,h]=b.useState(null),[k,N]=b.useState(""),[f,j]=b.useState(!1),[C,_]=b.useState(""),[O,S]=b.useState(null),F=k?a.find(v=>v.id===k):null,q=(v,$)=>{const R=[v.name];let A=v;for(;A.parent_id;){const P=$.find(d=>d.id===A.parent_id);if(P)R.unshift(P.name),A=P;else break}return R.join(" > ")},B=async()=>{try{p(!0),h(null);const{data:v,error:$}=await Q.from("org_nodes").select("*").order("root_category, name");if($)throw $;const R=v,A=R.filter(d=>d.type==="category").map(d=>({id:d.id,name:d.name,type:d.type,root_category:d.root_category,path:q(d,R)})),P=R.filter(d=>d.type==="task").map(d=>({id:d.id,name:d.name,type:d.type,root_category:d.root_category,path:q(d,R)}));i(A),c(P)}catch(v){console.error("Error fetching data:",v),h(v instanceof Error?v.message:"Failed to load data")}finally{p(!1)}},w=async v=>{try{const{data:$,error:R}=await Q.from("org_nodes").select("*").eq("id",v).single();if(R)throw R;S($)}catch($){console.error("Error loading task:",$),h("Failed to load task data")}},y=v=>{o(v),N(""),_(""),j(!1),S(null)},E=v=>{N(v),j(!!v)},U=async v=>{_(v),v==="new"?(j(!1),S(null)):typeof v=="number"?await w(v):(S(null),j(!1))},H=()=>{S(null),_(""),B(),r()};return b.useEffect(()=>{e&&B()},[e]),b.useEffect(()=>{e&&n&&(o("edit"),U(n))},[e,n]),e?t.jsxs("div",{className:"bg-opacity-50 fixed inset-0 z-[60] overflow-y-auto bg-black",children:[t.jsx("div",{className:"flex min-h-screen items-start justify-center px-4 py-6",children:t.jsxs("div",{className:"mx-auto w-full max-w-md rounded-lg bg-white shadow-xl dark:bg-gray-800",children:[t.jsxs("div",{className:"flex items-center justify-between border-b border-gray-200 p-6 dark:border-gray-600",children:[t.jsx("h2",{className:"text-xl font-bold text-gray-900 dark:text-gray-100",children:"Quick Task Manager"}),t.jsx("button",{onClick:r,className:"text-2xl font-bold text-gray-400 hover:text-gray-600 dark:text-gray-300 dark:hover:text-gray-100","aria-label":"Close",children:"Ã—"})]}),t.jsx("div",{className:"border-b border-gray-200 p-6 dark:border-gray-600",children:t.jsxs("div",{className:"flex space-x-1 rounded-lg bg-gray-100 p-1 dark:bg-gray-700",children:[t.jsx("button",{type:"button",onClick:()=>y("add"),className:`flex-1 rounded-md px-4 py-2 text-sm font-medium transition-colors ${s==="add"?"bg-white text-blue-600 shadow-sm dark:bg-gray-600 dark:text-blue-400":"text-gray-600 hover:text-gray-900 dark:text-gray-300 dark:hover:text-gray-100"}`,children:"Add Task"}),t.jsx("button",{type:"button",onClick:()=>y("edit"),className:`flex-1 rounded-md px-4 py-2 text-sm font-medium transition-colors ${s==="edit"?"bg-white text-blue-600 shadow-sm dark:bg-gray-600 dark:text-blue-400":"text-gray-600 hover:text-gray-900 dark:text-gray-300 dark:hover:text-gray-100"}`,children:"Edit Task"})]})}),u&&t.jsxs("div",{className:"p-8 text-center",children:[t.jsx("div",{className:"mx-auto mb-4 h-8 w-8 animate-spin rounded-full border-b-2 border-blue-600"}),t.jsx("p",{className:"text-gray-600 dark:text-gray-300",children:"Loading..."})]}),m&&t.jsx("div",{className:"border-l-4 border-red-400 bg-red-50 p-4 text-sm text-red-700 dark:bg-red-900/20 dark:text-red-300",children:m}),!u&&t.jsxs("div",{className:"space-y-4 p-6",children:[s==="add"&&t.jsxs(t.Fragment,{children:[t.jsxs("div",{children:[t.jsx("label",{className:"mb-2 block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Add to Category *"}),t.jsxs("select",{value:k,onChange:v=>E(v.target.value?Number(v.target.value):""),className:"w-full rounded-lg border border-gray-300 bg-white p-3 text-gray-900 focus:border-blue-500 focus:ring-2 focus:ring-blue-500 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-100",children:[t.jsx("option",{value:"",children:"Select a category..."}),a.map(v=>t.jsx("option",{value:v.id,children:v.path},v.id))]})]}),!k&&t.jsx("p",{className:"text-sm text-gray-500 italic dark:text-gray-400",children:"Select a category above to add a new task"})]}),s==="edit"&&t.jsxs(t.Fragment,{children:[t.jsxs("div",{children:[t.jsx("label",{className:"mb-2 block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Select Task *"}),t.jsxs("select",{value:C,onChange:v=>{const $=v.target.value;U($==="new"?"new":$===""?"":Number($))},className:"w-full rounded-lg border border-gray-300 bg-white p-3 text-gray-900 focus:border-blue-500 focus:ring-2 focus:ring-blue-500 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-100",children:[t.jsx("option",{value:"",children:"Choose an option..."}),t.jsx("option",{value:"new",children:"Create New Task"}),t.jsx("optgroup",{label:"Existing Tasks",children:l.map(v=>t.jsx("option",{value:v.id,children:v.path},v.id))})]})]}),C==="new"&&t.jsxs("div",{children:[t.jsx("label",{className:"mb-2 block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Add to Category *"}),t.jsxs("select",{value:k,onChange:v=>E(v.target.value?Number(v.target.value):""),className:"w-full rounded-lg border border-gray-300 bg-white p-3 text-gray-900 focus:border-blue-500 focus:ring-2 focus:ring-blue-500 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-100",children:[t.jsx("option",{value:"",children:"Select a category..."}),a.map(v=>t.jsx("option",{value:v.id,children:v.path},v.id))]})]}),!C&&t.jsx("p",{className:"text-sm text-gray-500 italic dark:text-gray-400",children:"Select a task above to edit, or create a new one"})]})]})]})}),f&&F&&t.jsx(K,{parentId:k,parentName:F.name,rootCategory:F.root_category,tabName:F.root_category,onCancel:()=>{j(!1),N("")}}),O&&t.jsx(K,{task:O,onCancel:H})]}):null}function it({icon:e,title:r,description:n,action:s}){const o=t.jsx("svg",{fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",className:"w-full h-full",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})});return t.jsxs("div",{className:"text-center py-12",children:[t.jsx("div",{className:"mx-auto h-24 w-24 text-gray-400 mb-4",children:e||o}),t.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:r}),n&&t.jsx("p",{className:"text-gray-600 mb-4",children:n}),s]})}function lt({tasks:e}){const r=e.filter(o=>o.urgencyLevel>=7).length,n=e.filter(o=>(o.importance||1)>=7).length,s=e.reduce((o,a)=>o+(a.completion_time||0),0);return t.jsx("div",{className:"mb-6",children:t.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[t.jsxs("div",{className:"bg-red-50 p-4 rounded border-l-4 border-red-500",children:[t.jsx("div",{className:"text-sm text-red-700",children:"High Urgency"}),t.jsx("div",{className:"text-2xl font-bold text-red-800",children:r})]}),t.jsxs("div",{className:"bg-purple-50 p-4 rounded border-l-4 border-purple-500",children:[t.jsx("div",{className:"text-sm text-purple-700",children:"High Importance"}),t.jsx("div",{className:"text-2xl font-bold text-purple-800",children:n})]}),t.jsxs("div",{className:"bg-gray-50 p-4 rounded border-l-4 border-gray-500",children:[t.jsx("div",{className:"text-sm text-gray-700",children:"Total Time"}),t.jsxs("div",{className:"text-2xl font-bold text-gray-800",children:[s.toFixed(1),"h"]})]})]})})}function or({task:e,onClick:r}){const n=i=>i<=3?{dot:"bg-green-400",text:"text-green-600"}:i<=6?{dot:"bg-yellow-400",text:"text-yellow-600"}:i<=8?{dot:"bg-orange-400",text:"text-orange-600"}:{dot:"bg-red-500",text:"text-red-600"},s=i=>i<=3?{dot:"bg-gray-300",text:"text-gray-600"}:i<=6?{dot:"bg-blue-400",text:"text-blue-600"}:i<=8?{dot:"bg-purple-400",text:"text-purple-600"}:{dot:"bg-purple-600",text:"text-purple-800"},o=n(e.urgencyLevel),a=s(e.importance||1);return t.jsx("div",{className:"bg-white rounded-lg border border-gray-200 p-4 hover:bg-gray-50 cursor-pointer transition-colors shadow-sm",onClick:()=>r(e),children:t.jsxs("div",{className:"flex items-start justify-between",children:[t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsx("h3",{className:"font-semibold text-gray-900 hover:text-blue-600 transition-colors",children:e.name}),e.details&&t.jsx("p",{className:"text-sm text-gray-600 mt-1 line-clamp-2",children:e.details}),t.jsxs("div",{className:"flex items-center space-x-4 mt-2",children:[t.jsx("span",{className:"inline-block bg-blue-100 text-blue-800 text-xs px-2 py-1 rounded",children:e.root_category}),e.completion_time&&t.jsxs("span",{className:"text-xs text-gray-500",children:[e.completion_time,"h estimated"]})]})]}),t.jsxs("div",{className:"flex flex-col items-end space-y-2 ml-4",children:[t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx("span",{className:`inline-block w-3 h-3 rounded-full ${o.dot}`}),t.jsxs("span",{className:`text-xs font-medium ${o.text}`,children:["U",e.urgencyLevel]})]}),t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx("span",{className:`inline-block w-3 h-3 rounded-full ${a.dot}`}),t.jsxs("span",{className:`text-xs font-medium ${a.text}`,children:["I",e.importance||1]})]})]})]})})}function ar(e){const r=new Date().toISOString().split("T")[0],n=new Date(r),s=[],o=a=>{a.type==="task"&&a.deadline&&!a.is_completed&&new Date(a.deadline)<=n&&s.push(a),a.children&&a.children.forEach(o)};return e.forEach(o),console.log(`Collected ${s.length} tasks due today/overdue from ${e.length} org trees`),s}function ir(e){return e.map(r=>({...r,urgencyLevel:fe(r.deadline,r.completion_time,r.unique_days_required),daysUntilDeadline:r.deadline?ze(r.deadline):0,isOverdue:r.deadline?ze(r.deadline)<0:!1}))}function ze(e){const r=new Date,s=new Date(e).getTime()-r.getTime();return Math.ceil(s/(1e3*60*60*24))}const lr={byUrgencyThenImportance:(e,r)=>r.urgencyLevel!==e.urgencyLevel?r.urgencyLevel-e.urgencyLevel:(r.importance||1)-(e.importance||1)},cr=["Household","Finances","Cleo","Job","Social","Personal","Orphans"];function dr({isOpen:e,onClose:r}){const[n,s]=b.useState(null),o=ge(),a=Ye({queries:cr.map(h=>({queryKey:W.orgTree(h),queryFn:()=>Re(h),enabled:e,staleTime:300*1e3}))});if(!e)return null;const i=a.some(h=>h.isLoading),l=a.some(h=>h.error);if(i)return t.jsx("div",{className:"bg-opacity-50 fixed inset-0 z-50 flex items-center justify-center bg-black",children:t.jsx("div",{className:"rounded-lg bg-white p-8",children:t.jsxs("div",{className:"flex items-center space-x-3",children:[t.jsx("div",{className:"h-6 w-6 animate-spin rounded-full border-b-2 border-blue-600"}),t.jsx("span",{children:"Loading tasks from all categories..."})]})})});if(l)return t.jsx("div",{className:"bg-opacity-50 fixed inset-0 z-50 flex items-center justify-center bg-black",children:t.jsx("div",{className:"rounded-lg bg-white p-8",children:t.jsx("div",{className:"text-red-600",children:"Error loading tasks. Please try again."})})});const c=a.filter(h=>h.data&&h.isSuccess).map(h=>h.data);console.log(`Found ${c.length} org tree roots from all tabs`);const u=ir(ar(c)).sort(lr.byUrgencyThenImportance);console.log(`Found ${u.length} tasks due today/overdue across all tabs`);const p=()=>{s(null),o.invalidateQueries({queryKey:W.allOrgTrees()})},m=new Date().toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"});return t.jsx("div",{className:"bg-opacity-50 fixed inset-0 z-50 flex items-start justify-center bg-black pt-10",children:t.jsxs("div",{className:"mx-4 max-h-[calc(90vh-2.5rem)] w-full max-w-4xl overflow-y-auto rounded-lg bg-white p-6 shadow-lg",children:[t.jsxs("div",{className:"mb-6 flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:"Tasks Due Today & Overdue"}),t.jsxs("p",{className:"text-sm text-gray-600",children:[m," â€¢ ",u.length," task",u.length!==1?"s":""," due or overdue across all categories"]})]}),t.jsx("button",{onClick:r,className:"text-2xl font-bold text-gray-500 transition-colors hover:text-gray-800","aria-label":"Close",children:"Ã—"})]}),u.length===0&&t.jsx(it,{title:"No tasks due today!",description:"Great job staying on top of your schedule. Enjoy your day!"}),u.length>0&&t.jsxs(t.Fragment,{children:[t.jsx(lt,{tasks:u}),t.jsxs("div",{children:[t.jsxs("h3",{className:"mb-4 text-lg font-semibold text-gray-800",children:["Today's Tasks & Overdue Items",t.jsx("span",{className:"ml-2 text-sm font-normal text-gray-600",children:"(Click any task to edit)"})]}),t.jsx("div",{className:"space-y-3",children:u.map(h=>t.jsx(or,{task:h,onClick:s},h.id))})]})]}),n&&t.jsx(K,{task:n,onCancel:p})]})})}const he=["Household","Finances","Cleo","Job","Social","Personal","Orphans"];function ur(){return Ye({queries:he.map(r=>({queryKey:W.criticalTaskCount(r),queryFn:async()=>{const{data:n,error:s}=await Q.from("org_nodes").select("deadline, completion_time, unique_days_required").eq("type","task").eq("root_category",r).not("deadline","is",null).not("completion_time","is",null).not("unique_days_required","is",null).not("is_completed","is",!0);if(s)throw s;return(n||[]).reduce((a,i)=>fe(i.deadline,i.completion_time,i.unique_days_required)===10?a+1:a,0)},staleTime:12e4,gcTime:3e5})),combine:r=>{const n={},s=r.some(a=>a.isLoading),o=r.some(a=>a.error);return r.forEach((a,i)=>{n[he[i]]=a.data||0}),{counts:n,isLoading:s,hasError:o}}}).counts}function ct({activeTab:e,variant:r="desktop",onTabClick:n}){const s=ur();return r==="mobile"?t.jsx("div",{className:"flex flex-col gap-2",children:he.map(o=>{const a=s[o]||0,i=e===o;return t.jsxs(ue,{to:`/org-chart/${o}`,onClick:n,className:`flex items-center justify-between rounded-lg px-4 py-3 text-base font-medium transition-all ${i?"bg-blue-600 text-white dark:bg-blue-700":"text-gray-300 hover:bg-gray-800/60 hover:text-white dark:hover:bg-gray-700/60"}`,children:[t.jsx("span",{children:o}),a>0&&t.jsx("span",{className:"flex h-6 min-w-[24px] items-center justify-center rounded-full bg-red-500 px-2 text-xs font-bold text-white",children:a>99?"99+":a})]},o)})}):t.jsx("div",{className:"flex items-center gap-1",children:he.map(o=>{const a=s[o]||0,i=e===o;return t.jsxs(ue,{to:`/org-chart/${o}`,onClick:n,className:`relative flex items-center gap-2 rounded-lg px-4 py-2.5 text-sm font-semibold transition-all ${i?"bg-blue-600/20 text-blue-400 shadow-inner dark:bg-blue-700/30 dark:text-blue-300":"text-gray-300 hover:bg-gray-800/60 hover:text-white dark:hover:bg-gray-700/60"}`,children:[t.jsx("span",{children:o}),a>0&&t.jsx("span",{className:"flex h-5 min-w-[20px] items-center justify-center rounded-full bg-red-500 px-1.5 text-[10px] font-bold text-white shadow-sm",children:a>99?"99+":a}),i&&t.jsx("span",{className:"absolute bottom-0 left-1/2 h-0.5 w-3/4 -translate-x-1/2 rounded-full bg-blue-400 dark:bg-blue-300"})]},o)})})}async function mr(){const{data:e,error:r}=await Q.from("org_nodes").select("*").eq("type","task").not("is_completed","is",!0).order("last_touched_at",{ascending:!1}).limit(10);return e}function dt(){return xe({queryKey:W.recentTasks(),queryFn:mr,staleTime:1e3*60})}function hr({isOpen:e,onClose:r,activeTab:n,onRecentTaskClick:s}){const{data:o,isLoading:a}=dt(),i=l=>{s?.(l),r()};return e?t.jsxs("div",{className:"fixed inset-0 z-50 lg:hidden",children:[t.jsx("div",{className:"bg-opacity-50 fixed inset-0 bg-black",onClick:r}),t.jsxs("div",{className:"fixed top-0 left-0 h-full w-80 transform bg-gray-900 shadow-xl transition-transform dark:bg-gray-800",children:[t.jsxs("div",{className:"flex items-center justify-between border-b border-gray-700 p-4",children:[t.jsx("h2",{className:"text-lg font-semibold text-white",children:"Navigation"}),t.jsx("button",{onClick:r,className:"text-2xl text-gray-400 hover:text-white","aria-label":"Close menu",children:"Ã—"})]}),t.jsxs("div",{className:"p-4",children:[t.jsx(ue,{to:"/",className:"mb-2 block rounded px-4 py-3 text-gray-300 transition-colors hover:bg-gray-800 hover:text-white",onClick:r,children:"â† Home"}),t.jsxs("div",{className:"mt-4 border-t border-gray-700 pt-4",children:[t.jsx("h3",{className:"mb-3 text-sm font-medium tracking-wide text-gray-400 uppercase",children:"Categories"}),t.jsx(ct,{activeTab:n,variant:"mobile",onTabClick:r})]}),s&&t.jsxs("div",{className:"mt-4 border-t border-gray-700 pt-4",children:[t.jsx("h3",{className:"mb-3 text-sm font-medium tracking-wide text-gray-400 uppercase",children:"Recent Tasks"}),a&&t.jsx("div",{className:"flex items-center justify-center py-4",children:t.jsx("div",{className:"h-5 w-5 animate-spin rounded-full border-b-2 border-blue-600"})}),!a&&(!o||o.length===0)&&t.jsx("p",{className:"px-4 py-2 text-sm text-gray-500",children:"No recent tasks yet"}),!a&&o&&o.length>0&&t.jsx("div",{className:"space-y-1",children:o.map(l=>t.jsxs("button",{onClick:()=>i(l),className:"w-full rounded px-4 py-2 text-left text-sm text-gray-300 transition-colors hover:bg-gray-800 hover:text-white",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("span",{className:"truncate",children:l.name}),l.importance&&l.importance>=8&&t.jsx("span",{className:"ml-2 text-purple-400",children:"â˜…"})]}),t.jsx("div",{className:"mt-0.5 text-xs text-gray-500",children:l.root_category})]},l.id))})]})]})]})]}):null}function xr(e,r){const n=new Date,s=e==="28-days"?new Date(n.getTime()+672*60*60*1e3):r?new Date(r):new Date(n.getTime()+672*60*60*1e3);return{startDate:n,endDate:s}}function gr(e,r){if(r==="All levels")return!0;const n=e||1;return{1:o=>o===1,"2-4":o=>o>=2&&o<=4,"5-6":o=>o>=5&&o<=6,"7-9":o=>o>=7&&o<=9,10:o=>o===10,"All levels":()=>!0}[r](n)}function fr(e,r){const n=r.getTime()-e.getTime();return Math.ceil(n/(1e3*60*60*24))/7*25}function qe(e){const r=new Date,s=new Date(e).getTime()-r.getTime();return Math.ceil(s/(1e3*60*60*24))}function Ue(e){return e<=.5?"text-green-600":e<=.8?"text-yellow-600":e<=1?"text-orange-600":"text-red-600"}function pr(e){return e<=.5?"Light load":e<=.8?"Moderate load":e<=1?"Heavy load":"Overloaded"}function br(e){return e.toISOString().split("T")[0]}function ut(e){return e.map(r=>({...r,daysUntilDeadline:r.deadline?qe(r.deadline):0,isOverdue:r.deadline?qe(r.deadline)<0:!1})).sort((r,n)=>r.daysUntilDeadline-n.daysUntilDeadline)}function yr(e,r,n){let s=0;const o=[],a=[];return e.forEach(i=>{if(!i.deadline||!i.completion_time)return;const l=new Date(i.deadline),c=new Date,u=Math.ceil((l.getTime()-c.getTime())/(1e3*60*60*24));if(l<=n)s+=i.completion_time,o.push(i);else{const m=i.completion_time/u*r;s+=m,a.push({task:i,partialTime:m,totalTime:i.completion_time})}}),{totalRequiredTime:s,tasksInWindow:o,tasksWithPartialTime:a}}function vr(e,r){const n=[...e,...r.map(o=>o.task)];return ut(n).map(o=>{const a=r.find(i=>i.task.id===o.id);return{...o,isPartialTime:!!a,partialRequiredTime:a?.partialTime,effectiveRequiredTime:a?a.partialTime:o.completion_time||0}})}async function wr(){const{data:e,error:r}=await Q.from("org_nodes").select("*").eq("type","task").not("deadline","is",null).not("is_completed","is",!0);if(r)throw r;return ut(e).map(o=>({...o,urgencyLevel:fe(o.deadline,o.completion_time,o.unique_days_required)})).sort((o,a)=>o.isOverdue&&!a.isOverdue?-1:!o.isOverdue&&a.isOverdue?1:o.isOverdue&&a.isOverdue?a.daysUntilDeadline-o.daysUntilDeadline:o.daysUntilDeadline-a.daysUntilDeadline)}function jr(e=!0){const{data:r=[],isLoading:n,error:s,refetch:o}=xe({queryKey:["allTasks"],queryFn:wr,enabled:e,staleTime:3e5,gcTime:18e5});return{tasks:r,isLoading:n,error:s?.message||null,refetch:o,reload:o}}function kr({tasks:e,onTaskSelect:r}){return t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"min-w-full border border-gray-200",children:[t.jsx("thead",{className:"bg-gray-50",children:t.jsx("tr",{children:["Task","Category","Deadline","Days Left","Time Required","Unique Days","Urgency","Importance"].map(n=>t.jsx("th",{className:"px-3 py-2 text-left text-sm font-medium text-gray-700",children:n},n))})}),t.jsx("tbody",{children:e.map((n,s)=>t.jsxs("tr",{className:`${s%2===0?"bg-gray-50":"bg-white"} ${n.isOverdue?"bg-red-50":""} hover:bg-blue-50 cursor-pointer transition-colors`,onClick:()=>r(n),title:"Click to view/edit task details",children:[t.jsxs("td",{className:"px-3 py-2 text-sm",children:[t.jsx("div",{className:"font-medium text-gray-800 hover:text-blue-600",children:n.name}),n.details&&t.jsx("div",{className:"text-xs text-gray-500 mt-1 max-w-xs truncate",title:n.details,children:n.details})]}),t.jsx("td",{className:"px-3 py-2 text-sm text-gray-600",children:t.jsx("span",{className:"inline-block bg-blue-100 text-blue-800 text-xs px-2 py-1 rounded",children:n.root_category})}),t.jsx("td",{className:"px-3 py-2 text-sm text-gray-600",children:n.deadline?new Date(n.deadline).toLocaleDateString():"No deadline"}),t.jsx("td",{className:`px-3 py-2 text-sm font-medium ${n.isOverdue?"text-red-600":n.daysUntilDeadline<=7?"text-orange-600":n.daysUntilDeadline<=30?"text-yellow-600":"text-gray-600"}`,children:n.isOverdue?`${Math.abs(n.daysUntilDeadline)} overdue`:`${n.daysUntilDeadline} days`}),t.jsxs("td",{className:"px-3 py-2 text-sm text-gray-600",children:[n.completion_time?.toFixed(1)||0,"h"]}),t.jsx("td",{className:"px-3 py-2 text-sm text-gray-600",children:n.unique_days_required?.toFixed(1)||0}),t.jsx("td",{className:"px-3 py-2 text-sm",children:t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx("span",{className:`inline-block w-3 h-3 rounded-full ${n.urgencyLevel<=3?"bg-green-400":n.urgencyLevel<=6?"bg-yellow-400":n.urgencyLevel<=8?"bg-orange-400":"bg-red-500"}`}),t.jsxs("span",{className:"text-xs font-medium",children:["Level ",n.urgencyLevel]})]})}),t.jsx("td",{className:"px-3 py-2 text-sm",children:t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx("span",{className:`inline-block w-3 h-3 rounded-full ${(n.importance||1)<=3?"bg-gray-300":(n.importance||1)<=6?"bg-blue-400":(n.importance||1)<=8?"bg-purple-400":"bg-purple-600"}`}),t.jsxs("span",{className:"text-xs font-medium",children:["Level ",n.importance||1]})]})})]},n.id))})]})})}function Nr(){return t.jsx("div",{className:"text-center py-8",children:t.jsxs("div",{className:"inline-flex items-center space-x-2 text-gray-600",children:[t.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-blue-600"}),t.jsx("span",{children:"Loading tasks..."})]})})}function Cr({error:e,onClick:r}){return t.jsxs("div",{className:"text-center py-8 text-red-600",children:[t.jsxs("p",{className:"mt-2",children:["Error: ",e]}),t.jsx("button",{onClick:()=>r(),className:"mt-2 px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700",children:"Try Again"})]})}function Tr({isOpen:e,onClose:r}){const{tasks:n=[],isLoading:s,error:o,reload:a}=jr(e),[i,l]=b.useState(null),c=()=>{l(null),a()};return e?t.jsx("div",{className:"bg-opacity-50 fixed inset-0 z-50 flex items-start justify-center bg-black pt-20",children:t.jsxs("div",{className:"mx-4 max-h-[calc(90vh-5rem)] w-full max-w-6xl overflow-y-auto rounded-lg bg-white p-6 shadow-lg",children:[t.jsxs("div",{className:"mb-4 flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:"Complete Task List"}),t.jsxs("p",{className:"text-sm text-gray-600",children:["All tasks sorted by deadline â€¢ Total: ",n.length," tasks"]})]}),t.jsx("button",{onClick:r,className:"text-2xl font-bold text-gray-500 hover:text-gray-800",children:"Ã—"})]}),s&&t.jsx(Nr,{}),o&&t.jsx(Cr,{error:o,onClick:()=>a()}),!s&&!o&&n.length===0&&t.jsx(it,{title:"No tasks found with deadlines"}),!s&&!o&&n.length>0&&t.jsxs(t.Fragment,{children:[t.jsx(lt,{tasks:n}),t.jsxs("div",{children:[t.jsx("h3",{className:"mb-3 text-lg font-semibold text-gray-800",children:"Task Details"}),t.jsx("p",{className:"mb-3 text-sm text-gray-600",children:"Click on any task to view or edit its details"}),t.jsx(kr,{tasks:n,onTaskSelect:l})]})]}),i&&t.jsx(K,{task:i,onCancel:c})]})}):null}function Sr(){const[e,r]=b.useState({totalRequiredTime:0,totalAvailableTime:0,taskCount:0,ratio:0,tasks:[]}),[n,s]=b.useState(!0),[o,a]=b.useState(null),[i,l]=b.useState(!1),[c,u]=b.useState(!1),[p,m]=b.useState("28-days"),[h,k]=b.useState(""),[N,f]=b.useState("All levels"),j=async()=>{try{s(!0),a(null);const{startDate:y,endDate:E}=xr(p,h),U=Math.ceil((E.getTime()-y.getTime())/(1e3*60*60*24)),{data:H,error:v}=await Q.from("org_nodes").select("*").eq("type","task").gte("deadline",y.toISOString().split("T")[0]).not("deadline","is",null).not("completion_time","is",null).not("is_completed","is",!0);if(v)throw v;const $=H.filter(se=>gr(se.importance,N)),{totalRequiredTime:R,tasksInWindow:A,tasksWithPartialTime:P}=yr($,U,E),d=fr(y,E),te=d>0?R/d:0,re=vr(A,P);r({totalRequiredTime:R,totalAvailableTime:d,taskCount:$.length,ratio:te,tasks:re})}catch(y){console.error("Error fetching time report data:",y),a(y instanceof Error?y.message:"An error occurred")}finally{s(!1)}};if(b.useEffect(()=>{j()},[p,h,N]),n)return t.jsxs("div",{className:"flex items-center space-x-2 text-sm text-white",children:[t.jsx("div",{className:"h-4 w-4 animate-spin rounded-full border-b-2 border-white"}),t.jsx("span",{children:"Loading..."})]});if(o)return t.jsxs("div",{className:"text-sm text-red-400",children:["Error: ",o]});const C=()=>t.jsxs("div",{className:"flex flex-col",children:[t.jsx("label",{className:"text-xs text-gray-300",children:"Time Window:"}),t.jsxs("select",{className:"rounded border-gray-600 bg-gray-700 px-2 py-1 text-xs text-white",value:p,onChange:y=>m(y.target.value),children:[t.jsx("option",{value:"28-days",children:"Next 28 days"}),t.jsx("option",{value:"custom",children:"Custom date"})]}),p==="custom"&&t.jsx("input",{type:"date",className:"mt-1 rounded border border-gray-600 bg-gray-700 px-2 py-1 text-xs text-white",value:h,onChange:y=>k(y.target.value),min:br(new Date)})]}),_=()=>t.jsxs("div",{className:"flex flex-col",children:[t.jsx("label",{className:"text-xs text-gray-300",children:"Importance:"}),t.jsxs("select",{className:"rounded border border-gray-600 bg-gray-700 px-2 py-1 text-xs text-white",value:N,onChange:y=>f(y.target.value),children:[t.jsx("option",{value:"All levels",children:"All levels"}),t.jsx("option",{value:"1",children:"Level 1"}),t.jsx("option",{value:"2-4",children:"Levels 2-4"}),t.jsx("option",{value:"5-6",children:"Levels 5-6"}),t.jsx("option",{value:"7-9",children:"Levels 7-9"}),t.jsx("option",{value:"10",children:"Level 10"})]})]}),O=()=>t.jsxs("button",{onClick:()=>l(!0),className:"flex flex-col rounded border-l border-gray-600 p-2 pl-4 transition-colors hover:bg-gray-800",children:[t.jsx("div",{className:"text-xs text-gray-300",children:"Time Analysis:"}),t.jsxs("div",{className:"flex items-center",children:[t.jsxs("div",{className:`font-bold ${Ue(e.ratio)}`,children:[(e.ratio*100).toFixed(1),"%"]}),t.jsxs("div",{className:"text-xs text-gray-400",children:["(",e.totalRequiredTime.toFixed(1),"h /"," ",e.totalAvailableTime.toFixed(1),"h)"]})]}),t.jsxs("div",{className:"text-xs text-gray-400",children:[e.taskCount," tasks â€¢ ",pr(e.ratio)]})]}),S=()=>t.jsx("button",{onClick:()=>u(!0),className:"text-gray-400 transition-colors hover:text-white",title:"View all tasks",children:t.jsx("svg",{className:"h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-3 7h3m-3 4h3m-6-4h.01M9 16h.01"})})}),F=()=>t.jsx("button",{onClick:j,className:"text-gray-400 transition-colors hover:text-white",title:"Refresh report",children:t.jsx("svg",{className:"h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})}),q=()=>{const y=[{label:"Total Required Time",value:`${e.totalRequiredTime.toFixed(1)}h`,color:"text-gray-800"},{label:"Available Time",value:`${e.totalAvailableTime.toFixed(1)}h`,color:"text-gray-800"},{label:"Utilization",value:`${(e.ratio*100).toFixed(1)}%`,color:Ue(e.ratio).replace("text-","text-")},{label:"Task Count",value:`${e.taskCount}`,color:"text-gray-800"}];return t.jsx("div",{className:"grid grid-cols-2 gap-4 sm:grid-cols-4",children:y.map((E,U)=>t.jsxs("div",{className:"rounded bg-gray-100 p-4",children:[t.jsx("div",{className:"text-sm text-gray-600",children:E.label}),t.jsx("div",{className:`text-xl font-bold ${E.color} sm:text-2xl`,children:E.value})]},U))})},B=()=>t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"min-w-full border border-gray-200",children:[t.jsx("thead",{className:"bg-gray-50",children:t.jsx("tr",{children:["Task","Deadline","Days Left","Time Required","Effective Time","Importance","Category"].map(y=>t.jsx("th",{className:"px-4 py-2 text-left text-sm font-medium text-gray-700",children:y},y))})}),t.jsx("tbody",{children:e.tasks.map((y,E)=>t.jsxs("tr",{className:E%2===0?"bg-gray-50":"bg-white",children:[t.jsxs("td",{className:"px-4 py-2 text-sm text-gray-800",children:[y.name,y.isPartialTime&&t.jsx("span",{className:"ml-2 text-xs font-medium text-blue-600",children:"(Partial)"})]}),t.jsx("td",{className:"px-4 py-2 text-sm text-gray-600",children:y.deadline?new Date(y.deadline).toLocaleDateString():"No deadline"}),t.jsx("td",{className:`px-4 py-2 text-sm ${y.isOverdue?"font-bold text-red-600":y.daysUntilDeadline<=7?"text-orange-600":"text-gray-600"}`,children:y.isOverdue?`${Math.abs(y.daysUntilDeadline)} overdue`:`${y.daysUntilDeadline} days`}),t.jsxs("td",{className:"px-4 py-2 text-sm text-gray-600",children:[y.completion_time?.toFixed(1)||0,"h"]}),t.jsxs("td",{className:"px-4 py-2 text-sm text-gray-600",children:[t.jsxs("span",{className:y.isPartialTime?"font-medium text-blue-600":"",children:[y.effectiveRequiredTime?.toFixed(1)||y.completion_time?.toFixed(1)||0,"h"]}),y.isPartialTime&&t.jsxs("div",{className:"text-xs text-gray-500",children:["(",((y.partialRequiredTime||0)/(y.completion_time||1)*100).toFixed(1),"% of total)"]})]}),t.jsxs("td",{className:"px-4 py-2 text-sm text-gray-600",children:["Level ",y.importance||1]}),t.jsx("td",{className:"px-4 py-2 text-sm text-gray-600",children:y.root_category})]},y.id))})]})}),w=()=>t.jsx("div",{className:"bg-opacity-50 fixed inset-0 z-50 flex items-start justify-center bg-black p-4 pt-8",children:t.jsxs("div",{className:"mx-auto max-h-[90vh] w-full max-w-6xl overflow-y-auto rounded-lg bg-white shadow-lg",children:[t.jsxs("div",{className:"sticky top-0 z-10 flex items-center justify-between border-b border-gray-200 bg-white px-6 py-4",children:[t.jsx("h2",{className:"text-xl font-bold text-gray-800 sm:text-2xl",children:"Time Availability Report"}),t.jsx("button",{onClick:()=>l(!1),className:"text-2xl font-bold text-gray-500 hover:text-gray-800","aria-label":"Close modal",children:"Ã—"})]}),t.jsxs("div",{className:"space-y-6 p-6",children:[t.jsx(q,{}),t.jsxs("div",{children:[t.jsx("h3",{className:"mb-3 text-lg font-semibold text-gray-800",children:"Task Breakdown"}),t.jsx(B,{})]})]})]})});return t.jsxs(t.Fragment,{children:[t.jsx("aside",{className:"aside",children:t.jsxs("div",{className:"flex flex-col items-center space-y-2 text-sm text-white",children:[t.jsx(C,{}),t.jsx(_,{}),t.jsx(O,{}),t.jsxs("div",{className:"flex space-x-2",children:[t.jsx(S,{}),t.jsx(F,{})]})]})}),i&&t.jsx(w,{}),t.jsx(Tr,{isOpen:c,onClose:()=>u(!1)})]})}function _r({isOpen:e,onClose:r}){return e?t.jsxs("div",{className:"fixed inset-0 z-50",children:[t.jsx("div",{className:"bg-opacity-50 fixed inset-0 bg-black",onClick:r}),t.jsxs("div",{className:"fixed inset-4 flex max-h-full flex-col rounded-lg bg-white shadow-xl dark:bg-gray-800",children:[t.jsxs("div",{className:"flex items-center justify-between border-b border-gray-200 p-4 dark:border-gray-600",children:[t.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100",children:"Time Report"}),t.jsx("button",{onClick:r,className:"text-2xl text-gray-500 hover:text-gray-800 dark:text-gray-400 dark:hover:text-gray-200","aria-label":"Close",children:"Ã—"})]}),t.jsx("div",{className:"flex-1 overflow-y-auto p-4",children:t.jsx(Sr,{})})]})]}):null}function mt(e){var r,n,s="";if(typeof e=="string"||typeof e=="number")s+=e;else if(typeof e=="object")if(Array.isArray(e)){var o=e.length;for(r=0;r<o;r++)e[r]&&(n=mt(e[r]))&&(s&&(s+=" "),s+=n)}else for(n in e)e[n]&&(s&&(s+=" "),s+=n);return s}function Rr(){for(var e,r,n=0,s="",o=arguments.length;n<o;n++)(e=arguments[n])&&(r=mt(e))&&(s&&(s+=" "),s+=r);return s}const $e="-",$r=e=>{const r=Dr(e),{conflictingClassGroups:n,conflictingClassGroupModifiers:s}=e;return{getClassGroupId:i=>{const l=i.split($e);return l[0]===""&&l.length!==1&&l.shift(),ht(l,r)||Mr(i)},getConflictingClassGroupIds:(i,l)=>{const c=n[i]||[];return l&&s[i]?[...c,...s[i]]:c}}},ht=(e,r)=>{if(e.length===0)return r.classGroupId;const n=e[0],s=r.nextPart.get(n),o=s?ht(e.slice(1),s):void 0;if(o)return o;if(r.validators.length===0)return;const a=e.join($e);return r.validators.find(({validator:i})=>i(a))?.classGroupId},Be=/^\[(.+)\]$/,Mr=e=>{if(Be.test(e)){const r=Be.exec(e)[1],n=r?.substring(0,r.indexOf(":"));if(n)return"arbitrary.."+n}},Dr=e=>{const{theme:r,classGroups:n}=e,s={nextPart:new Map,validators:[]};for(const o in n)Ne(n[o],s,o,r);return s},Ne=(e,r,n,s)=>{e.forEach(o=>{if(typeof o=="string"){const a=o===""?r:Qe(r,o);a.classGroupId=n;return}if(typeof o=="function"){if(Lr(o)){Ne(o(s),r,n,s);return}r.validators.push({validator:o,classGroupId:n});return}Object.entries(o).forEach(([a,i])=>{Ne(i,Qe(r,a),n,s)})})},Qe=(e,r)=>{let n=e;return r.split($e).forEach(s=>{n.nextPart.has(s)||n.nextPart.set(s,{nextPart:new Map,validators:[]}),n=n.nextPart.get(s)}),n},Lr=e=>e.isThemeGetter,Ar=e=>{if(e<1)return{get:()=>{},set:()=>{}};let r=0,n=new Map,s=new Map;const o=(a,i)=>{n.set(a,i),r++,r>e&&(r=0,s=n,n=new Map)};return{get(a){let i=n.get(a);if(i!==void 0)return i;if((i=s.get(a))!==void 0)return o(a,i),i},set(a,i){n.has(a)?n.set(a,i):o(a,i)}}},Ce="!",Te=":",Or=Te.length,Er=e=>{const{prefix:r,experimentalParseClassName:n}=e;let s=o=>{const a=[];let i=0,l=0,c=0,u;for(let N=0;N<o.length;N++){let f=o[N];if(i===0&&l===0){if(f===Te){a.push(o.slice(c,N)),c=N+Or;continue}if(f==="/"){u=N;continue}}f==="["?i++:f==="]"?i--:f==="("?l++:f===")"&&l--}const p=a.length===0?o:o.substring(c),m=Pr(p),h=m!==p,k=u&&u>c?u-c:void 0;return{modifiers:a,hasImportantModifier:h,baseClassName:m,maybePostfixModifierPosition:k}};if(r){const o=r+Te,a=s;s=i=>i.startsWith(o)?a(i.substring(o.length)):{isExternal:!0,modifiers:[],hasImportantModifier:!1,baseClassName:i,maybePostfixModifierPosition:void 0}}if(n){const o=s;s=a=>n({className:a,parseClassName:o})}return s},Pr=e=>e.endsWith(Ce)?e.substring(0,e.length-1):e.startsWith(Ce)?e.substring(1):e,Ir=e=>{const r=Object.fromEntries(e.orderSensitiveModifiers.map(s=>[s,!0]));return s=>{if(s.length<=1)return s;const o=[];let a=[];return s.forEach(i=>{i[0]==="["||r[i]?(o.push(...a.sort(),i),a=[]):a.push(i)}),o.push(...a.sort()),o}},Fr=e=>({cache:Ar(e.cacheSize),parseClassName:Er(e),sortModifiers:Ir(e),...$r(e)}),zr=/\s+/,qr=(e,r)=>{const{parseClassName:n,getClassGroupId:s,getConflictingClassGroupIds:o,sortModifiers:a}=r,i=[],l=e.trim().split(zr);let c="";for(let u=l.length-1;u>=0;u-=1){const p=l[u],{isExternal:m,modifiers:h,hasImportantModifier:k,baseClassName:N,maybePostfixModifierPosition:f}=n(p);if(m){c=p+(c.length>0?" "+c:c);continue}let j=!!f,C=s(j?N.substring(0,f):N);if(!C){if(!j){c=p+(c.length>0?" "+c:c);continue}if(C=s(N),!C){c=p+(c.length>0?" "+c:c);continue}j=!1}const _=a(h).join(":"),O=k?_+Ce:_,S=O+C;if(i.includes(S))continue;i.push(S);const F=o(C,j);for(let q=0;q<F.length;++q){const B=F[q];i.push(O+B)}c=p+(c.length>0?" "+c:c)}return c};function Ur(){let e=0,r,n,s="";for(;e<arguments.length;)(r=arguments[e++])&&(n=xt(r))&&(s&&(s+=" "),s+=n);return s}const xt=e=>{if(typeof e=="string")return e;let r,n="";for(let s=0;s<e.length;s++)e[s]&&(r=xt(e[s]))&&(n&&(n+=" "),n+=r);return n};function Br(e,...r){let n,s,o,a=i;function i(c){const u=r.reduce((p,m)=>m(p),e());return n=Fr(u),s=n.cache.get,o=n.cache.set,a=l,l(c)}function l(c){const u=s(c);if(u)return u;const p=qr(c,n);return o(c,p),p}return function(){return a(Ur.apply(null,arguments))}}const M=e=>{const r=n=>n[e]||[];return r.isThemeGetter=!0,r},gt=/^\[(?:(\w[\w-]*):)?(.+)\]$/i,ft=/^\((?:(\w[\w-]*):)?(.+)\)$/i,Qr=/^\d+\/\d+$/,Gr=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,Wr=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,Hr=/^(rgba?|hsla?|hwb|(ok)?(lab|lch)|color-mix)\(.+\)$/,Vr=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,Kr=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,Y=e=>Qr.test(e),T=e=>!!e&&!Number.isNaN(Number(e)),V=e=>!!e&&Number.isInteger(Number(e)),ve=e=>e.endsWith("%")&&T(e.slice(0,-1)),G=e=>Gr.test(e),Jr=()=>!0,Yr=e=>Wr.test(e)&&!Hr.test(e),pt=()=>!1,Xr=e=>Vr.test(e),Zr=e=>Kr.test(e),es=e=>!x(e)&&!g(e),ts=e=>X(e,vt,pt),x=e=>gt.test(e),J=e=>X(e,wt,Yr),we=e=>X(e,as,T),Ge=e=>X(e,bt,pt),rs=e=>X(e,yt,Zr),ce=e=>X(e,jt,Xr),g=e=>ft.test(e),ee=e=>Z(e,wt),ss=e=>Z(e,is),We=e=>Z(e,bt),ns=e=>Z(e,vt),os=e=>Z(e,yt),de=e=>Z(e,jt,!0),X=(e,r,n)=>{const s=gt.exec(e);return s?s[1]?r(s[1]):n(s[2]):!1},Z=(e,r,n=!1)=>{const s=ft.exec(e);return s?s[1]?r(s[1]):n:!1},bt=e=>e==="position"||e==="percentage",yt=e=>e==="image"||e==="url",vt=e=>e==="length"||e==="size"||e==="bg-size",wt=e=>e==="length",as=e=>e==="number",is=e=>e==="family-name",jt=e=>e==="shadow",ls=()=>{const e=M("color"),r=M("font"),n=M("text"),s=M("font-weight"),o=M("tracking"),a=M("leading"),i=M("breakpoint"),l=M("container"),c=M("spacing"),u=M("radius"),p=M("shadow"),m=M("inset-shadow"),h=M("text-shadow"),k=M("drop-shadow"),N=M("blur"),f=M("perspective"),j=M("aspect"),C=M("ease"),_=M("animate"),O=()=>["auto","avoid","all","avoid-page","page","left","right","column"],S=()=>["center","top","bottom","left","right","top-left","left-top","top-right","right-top","bottom-right","right-bottom","bottom-left","left-bottom"],F=()=>[...S(),g,x],q=()=>["auto","hidden","clip","visible","scroll"],B=()=>["auto","contain","none"],w=()=>[g,x,c],y=()=>[Y,"full","auto",...w()],E=()=>[V,"none","subgrid",g,x],U=()=>["auto",{span:["full",V,g,x]},V,g,x],H=()=>[V,"auto",g,x],v=()=>["auto","min","max","fr",g,x],$=()=>["start","end","center","between","around","evenly","stretch","baseline","center-safe","end-safe"],R=()=>["start","end","center","stretch","center-safe","end-safe"],A=()=>["auto",...w()],P=()=>[Y,"auto","full","dvw","dvh","lvw","lvh","svw","svh","min","max","fit",...w()],d=()=>[e,g,x],te=()=>[...S(),We,Ge,{position:[g,x]}],re=()=>["no-repeat",{repeat:["","x","y","space","round"]}],se=()=>["auto","cover","contain",ns,ts,{size:[g,x]}],pe=()=>[ve,ee,J],I=()=>["","none","full",u,g,x],z=()=>["",T,ee,J],ne=()=>["solid","dashed","dotted","double"],Me=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],D=()=>[T,ve,We,Ge],De=()=>["","none",N,g,x],oe=()=>["none",T,g,x],ae=()=>["none",T,g,x],be=()=>[T,g,x],ie=()=>[Y,"full",...w()];return{cacheSize:500,theme:{animate:["spin","ping","pulse","bounce"],aspect:["video"],blur:[G],breakpoint:[G],color:[Jr],container:[G],"drop-shadow":[G],ease:["in","out","in-out"],font:[es],"font-weight":["thin","extralight","light","normal","medium","semibold","bold","extrabold","black"],"inset-shadow":[G],leading:["none","tight","snug","normal","relaxed","loose"],perspective:["dramatic","near","normal","midrange","distant","none"],radius:[G],shadow:[G],spacing:["px",T],text:[G],"text-shadow":[G],tracking:["tighter","tight","normal","wide","wider","widest"]},classGroups:{aspect:[{aspect:["auto","square",Y,x,g,j]}],container:["container"],columns:[{columns:[T,x,g,l]}],"break-after":[{"break-after":O()}],"break-before":[{"break-before":O()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],sr:["sr-only","not-sr-only"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:F()}],overflow:[{overflow:q()}],"overflow-x":[{"overflow-x":q()}],"overflow-y":[{"overflow-y":q()}],overscroll:[{overscroll:B()}],"overscroll-x":[{"overscroll-x":B()}],"overscroll-y":[{"overscroll-y":B()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:y()}],"inset-x":[{"inset-x":y()}],"inset-y":[{"inset-y":y()}],start:[{start:y()}],end:[{end:y()}],top:[{top:y()}],right:[{right:y()}],bottom:[{bottom:y()}],left:[{left:y()}],visibility:["visible","invisible","collapse"],z:[{z:[V,"auto",g,x]}],basis:[{basis:[Y,"full","auto",l,...w()]}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["nowrap","wrap","wrap-reverse"]}],flex:[{flex:[T,Y,"auto","initial","none",x]}],grow:[{grow:["",T,g,x]}],shrink:[{shrink:["",T,g,x]}],order:[{order:[V,"first","last","none",g,x]}],"grid-cols":[{"grid-cols":E()}],"col-start-end":[{col:U()}],"col-start":[{"col-start":H()}],"col-end":[{"col-end":H()}],"grid-rows":[{"grid-rows":E()}],"row-start-end":[{row:U()}],"row-start":[{"row-start":H()}],"row-end":[{"row-end":H()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":v()}],"auto-rows":[{"auto-rows":v()}],gap:[{gap:w()}],"gap-x":[{"gap-x":w()}],"gap-y":[{"gap-y":w()}],"justify-content":[{justify:[...$(),"normal"]}],"justify-items":[{"justify-items":[...R(),"normal"]}],"justify-self":[{"justify-self":["auto",...R()]}],"align-content":[{content:["normal",...$()]}],"align-items":[{items:[...R(),{baseline:["","last"]}]}],"align-self":[{self:["auto",...R(),{baseline:["","last"]}]}],"place-content":[{"place-content":$()}],"place-items":[{"place-items":[...R(),"baseline"]}],"place-self":[{"place-self":["auto",...R()]}],p:[{p:w()}],px:[{px:w()}],py:[{py:w()}],ps:[{ps:w()}],pe:[{pe:w()}],pt:[{pt:w()}],pr:[{pr:w()}],pb:[{pb:w()}],pl:[{pl:w()}],m:[{m:A()}],mx:[{mx:A()}],my:[{my:A()}],ms:[{ms:A()}],me:[{me:A()}],mt:[{mt:A()}],mr:[{mr:A()}],mb:[{mb:A()}],ml:[{ml:A()}],"space-x":[{"space-x":w()}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":w()}],"space-y-reverse":["space-y-reverse"],size:[{size:P()}],w:[{w:[l,"screen",...P()]}],"min-w":[{"min-w":[l,"screen","none",...P()]}],"max-w":[{"max-w":[l,"screen","none","prose",{screen:[i]},...P()]}],h:[{h:["screen","lh",...P()]}],"min-h":[{"min-h":["screen","lh","none",...P()]}],"max-h":[{"max-h":["screen","lh",...P()]}],"font-size":[{text:["base",n,ee,J]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:[s,g,we]}],"font-stretch":[{"font-stretch":["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded",ve,x]}],"font-family":[{font:[ss,x,r]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:[o,g,x]}],"line-clamp":[{"line-clamp":[T,"none",g,we]}],leading:[{leading:[a,...w()]}],"list-image":[{"list-image":["none",g,x]}],"list-style-position":[{list:["inside","outside"]}],"list-style-type":[{list:["disc","decimal","none",g,x]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"placeholder-color":[{placeholder:d()}],"text-color":[{text:d()}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...ne(),"wavy"]}],"text-decoration-thickness":[{decoration:[T,"from-font","auto",g,J]}],"text-decoration-color":[{decoration:d()}],"underline-offset":[{"underline-offset":[T,"auto",g,x]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:w()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",g,x]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],wrap:[{wrap:["break-word","anywhere","normal"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",g,x]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:te()}],"bg-repeat":[{bg:re()}],"bg-size":[{bg:se()}],"bg-image":[{bg:["none",{linear:[{to:["t","tr","r","br","b","bl","l","tl"]},V,g,x],radial:["",g,x],conic:[V,g,x]},os,rs]}],"bg-color":[{bg:d()}],"gradient-from-pos":[{from:pe()}],"gradient-via-pos":[{via:pe()}],"gradient-to-pos":[{to:pe()}],"gradient-from":[{from:d()}],"gradient-via":[{via:d()}],"gradient-to":[{to:d()}],rounded:[{rounded:I()}],"rounded-s":[{"rounded-s":I()}],"rounded-e":[{"rounded-e":I()}],"rounded-t":[{"rounded-t":I()}],"rounded-r":[{"rounded-r":I()}],"rounded-b":[{"rounded-b":I()}],"rounded-l":[{"rounded-l":I()}],"rounded-ss":[{"rounded-ss":I()}],"rounded-se":[{"rounded-se":I()}],"rounded-ee":[{"rounded-ee":I()}],"rounded-es":[{"rounded-es":I()}],"rounded-tl":[{"rounded-tl":I()}],"rounded-tr":[{"rounded-tr":I()}],"rounded-br":[{"rounded-br":I()}],"rounded-bl":[{"rounded-bl":I()}],"border-w":[{border:z()}],"border-w-x":[{"border-x":z()}],"border-w-y":[{"border-y":z()}],"border-w-s":[{"border-s":z()}],"border-w-e":[{"border-e":z()}],"border-w-t":[{"border-t":z()}],"border-w-r":[{"border-r":z()}],"border-w-b":[{"border-b":z()}],"border-w-l":[{"border-l":z()}],"divide-x":[{"divide-x":z()}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":z()}],"divide-y-reverse":["divide-y-reverse"],"border-style":[{border:[...ne(),"hidden","none"]}],"divide-style":[{divide:[...ne(),"hidden","none"]}],"border-color":[{border:d()}],"border-color-x":[{"border-x":d()}],"border-color-y":[{"border-y":d()}],"border-color-s":[{"border-s":d()}],"border-color-e":[{"border-e":d()}],"border-color-t":[{"border-t":d()}],"border-color-r":[{"border-r":d()}],"border-color-b":[{"border-b":d()}],"border-color-l":[{"border-l":d()}],"divide-color":[{divide:d()}],"outline-style":[{outline:[...ne(),"none","hidden"]}],"outline-offset":[{"outline-offset":[T,g,x]}],"outline-w":[{outline:["",T,ee,J]}],"outline-color":[{outline:d()}],shadow:[{shadow:["","none",p,de,ce]}],"shadow-color":[{shadow:d()}],"inset-shadow":[{"inset-shadow":["none",m,de,ce]}],"inset-shadow-color":[{"inset-shadow":d()}],"ring-w":[{ring:z()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:d()}],"ring-offset-w":[{"ring-offset":[T,J]}],"ring-offset-color":[{"ring-offset":d()}],"inset-ring-w":[{"inset-ring":z()}],"inset-ring-color":[{"inset-ring":d()}],"text-shadow":[{"text-shadow":["none",h,de,ce]}],"text-shadow-color":[{"text-shadow":d()}],opacity:[{opacity:[T,g,x]}],"mix-blend":[{"mix-blend":[...Me(),"plus-darker","plus-lighter"]}],"bg-blend":[{"bg-blend":Me()}],"mask-clip":[{"mask-clip":["border","padding","content","fill","stroke","view"]},"mask-no-clip"],"mask-composite":[{mask:["add","subtract","intersect","exclude"]}],"mask-image-linear-pos":[{"mask-linear":[T]}],"mask-image-linear-from-pos":[{"mask-linear-from":D()}],"mask-image-linear-to-pos":[{"mask-linear-to":D()}],"mask-image-linear-from-color":[{"mask-linear-from":d()}],"mask-image-linear-to-color":[{"mask-linear-to":d()}],"mask-image-t-from-pos":[{"mask-t-from":D()}],"mask-image-t-to-pos":[{"mask-t-to":D()}],"mask-image-t-from-color":[{"mask-t-from":d()}],"mask-image-t-to-color":[{"mask-t-to":d()}],"mask-image-r-from-pos":[{"mask-r-from":D()}],"mask-image-r-to-pos":[{"mask-r-to":D()}],"mask-image-r-from-color":[{"mask-r-from":d()}],"mask-image-r-to-color":[{"mask-r-to":d()}],"mask-image-b-from-pos":[{"mask-b-from":D()}],"mask-image-b-to-pos":[{"mask-b-to":D()}],"mask-image-b-from-color":[{"mask-b-from":d()}],"mask-image-b-to-color":[{"mask-b-to":d()}],"mask-image-l-from-pos":[{"mask-l-from":D()}],"mask-image-l-to-pos":[{"mask-l-to":D()}],"mask-image-l-from-color":[{"mask-l-from":d()}],"mask-image-l-to-color":[{"mask-l-to":d()}],"mask-image-x-from-pos":[{"mask-x-from":D()}],"mask-image-x-to-pos":[{"mask-x-to":D()}],"mask-image-x-from-color":[{"mask-x-from":d()}],"mask-image-x-to-color":[{"mask-x-to":d()}],"mask-image-y-from-pos":[{"mask-y-from":D()}],"mask-image-y-to-pos":[{"mask-y-to":D()}],"mask-image-y-from-color":[{"mask-y-from":d()}],"mask-image-y-to-color":[{"mask-y-to":d()}],"mask-image-radial":[{"mask-radial":[g,x]}],"mask-image-radial-from-pos":[{"mask-radial-from":D()}],"mask-image-radial-to-pos":[{"mask-radial-to":D()}],"mask-image-radial-from-color":[{"mask-radial-from":d()}],"mask-image-radial-to-color":[{"mask-radial-to":d()}],"mask-image-radial-shape":[{"mask-radial":["circle","ellipse"]}],"mask-image-radial-size":[{"mask-radial":[{closest:["side","corner"],farthest:["side","corner"]}]}],"mask-image-radial-pos":[{"mask-radial-at":S()}],"mask-image-conic-pos":[{"mask-conic":[T]}],"mask-image-conic-from-pos":[{"mask-conic-from":D()}],"mask-image-conic-to-pos":[{"mask-conic-to":D()}],"mask-image-conic-from-color":[{"mask-conic-from":d()}],"mask-image-conic-to-color":[{"mask-conic-to":d()}],"mask-mode":[{mask:["alpha","luminance","match"]}],"mask-origin":[{"mask-origin":["border","padding","content","fill","stroke","view"]}],"mask-position":[{mask:te()}],"mask-repeat":[{mask:re()}],"mask-size":[{mask:se()}],"mask-type":[{"mask-type":["alpha","luminance"]}],"mask-image":[{mask:["none",g,x]}],filter:[{filter:["","none",g,x]}],blur:[{blur:De()}],brightness:[{brightness:[T,g,x]}],contrast:[{contrast:[T,g,x]}],"drop-shadow":[{"drop-shadow":["","none",k,de,ce]}],"drop-shadow-color":[{"drop-shadow":d()}],grayscale:[{grayscale:["",T,g,x]}],"hue-rotate":[{"hue-rotate":[T,g,x]}],invert:[{invert:["",T,g,x]}],saturate:[{saturate:[T,g,x]}],sepia:[{sepia:["",T,g,x]}],"backdrop-filter":[{"backdrop-filter":["","none",g,x]}],"backdrop-blur":[{"backdrop-blur":De()}],"backdrop-brightness":[{"backdrop-brightness":[T,g,x]}],"backdrop-contrast":[{"backdrop-contrast":[T,g,x]}],"backdrop-grayscale":[{"backdrop-grayscale":["",T,g,x]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[T,g,x]}],"backdrop-invert":[{"backdrop-invert":["",T,g,x]}],"backdrop-opacity":[{"backdrop-opacity":[T,g,x]}],"backdrop-saturate":[{"backdrop-saturate":[T,g,x]}],"backdrop-sepia":[{"backdrop-sepia":["",T,g,x]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":w()}],"border-spacing-x":[{"border-spacing-x":w()}],"border-spacing-y":[{"border-spacing-y":w()}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["","all","colors","opacity","shadow","transform","none",g,x]}],"transition-behavior":[{transition:["normal","discrete"]}],duration:[{duration:[T,"initial",g,x]}],ease:[{ease:["linear","initial",C,g,x]}],delay:[{delay:[T,g,x]}],animate:[{animate:["none",_,g,x]}],backface:[{backface:["hidden","visible"]}],perspective:[{perspective:[f,g,x]}],"perspective-origin":[{"perspective-origin":F()}],rotate:[{rotate:oe()}],"rotate-x":[{"rotate-x":oe()}],"rotate-y":[{"rotate-y":oe()}],"rotate-z":[{"rotate-z":oe()}],scale:[{scale:ae()}],"scale-x":[{"scale-x":ae()}],"scale-y":[{"scale-y":ae()}],"scale-z":[{"scale-z":ae()}],"scale-3d":["scale-3d"],skew:[{skew:be()}],"skew-x":[{"skew-x":be()}],"skew-y":[{"skew-y":be()}],transform:[{transform:[g,x,"","none","gpu","cpu"]}],"transform-origin":[{origin:F()}],"transform-style":[{transform:["3d","flat"]}],translate:[{translate:ie()}],"translate-x":[{"translate-x":ie()}],"translate-y":[{"translate-y":ie()}],"translate-z":[{"translate-z":ie()}],"translate-none":["translate-none"],accent:[{accent:d()}],appearance:[{appearance:["none","auto"]}],"caret-color":[{caret:d()}],"color-scheme":[{scheme:["normal","dark","light","light-dark","only-dark","only-light"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",g,x]}],"field-sizing":[{"field-sizing":["fixed","content"]}],"pointer-events":[{"pointer-events":["auto","none"]}],resize:[{resize:["none","","y","x"]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":w()}],"scroll-mx":[{"scroll-mx":w()}],"scroll-my":[{"scroll-my":w()}],"scroll-ms":[{"scroll-ms":w()}],"scroll-me":[{"scroll-me":w()}],"scroll-mt":[{"scroll-mt":w()}],"scroll-mr":[{"scroll-mr":w()}],"scroll-mb":[{"scroll-mb":w()}],"scroll-ml":[{"scroll-ml":w()}],"scroll-p":[{"scroll-p":w()}],"scroll-px":[{"scroll-px":w()}],"scroll-py":[{"scroll-py":w()}],"scroll-ps":[{"scroll-ps":w()}],"scroll-pe":[{"scroll-pe":w()}],"scroll-pt":[{"scroll-pt":w()}],"scroll-pr":[{"scroll-pr":w()}],"scroll-pb":[{"scroll-pb":w()}],"scroll-pl":[{"scroll-pl":w()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",g,x]}],fill:[{fill:["none",...d()]}],"stroke-w":[{stroke:[T,ee,J,we]}],stroke:[{stroke:["none",...d()]}],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-x","border-w-y","border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-x","border-color-y","border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],translate:["translate-x","translate-y","translate-none"],"translate-none":["translate","translate-x","translate-y","translate-z"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]},orderSensitiveModifiers:["*","**","after","backdrop","before","details-content","file","first-letter","first-line","marker","placeholder","selection"]}},cs=Br(ls);function ds(...e){return cs(Rr(e))}function kt({onClick:e,showLabel:r=!1,className:n}){return t.jsxs("button",{onClick:e,className:ds("flex items-center space-x-1 rounded p-2 text-gray-300 transition-colors hover:text-white",!r&&"justify-center",n),title:"Quick Add Task",children:[t.jsx("svg",{className:"h-5 w-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),r&&t.jsx("span",{className:"hidden text-sm sm:inline",children:"Quick Add"})]})}function Nt({onClick:e}){return t.jsxs("button",{onClick:e,className:"text-gray-300 hover:text-white transition-colors flex items-center space-x-1",title:"Tasks Due Today",children:[t.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2 2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})}),t.jsx("span",{className:"hidden sm:inline text-sm",children:"Today"})]})}function us({onOpenTasksDueToday:e,onOpenQuickAdd:r,onOpenTimeReport:n,onOpenHamburger:s}){return t.jsx(t.Fragment,{children:t.jsxs("div",{className:"flex items-center justify-between px-4 py-3",children:[t.jsx("button",{onClick:s,className:"rounded p-2 text-gray-300 transition-colors hover:text-white","aria-label":"Open navigation menu",children:t.jsx("svg",{className:"h-6 w-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})}),t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx(Je,{}),t.jsx(Nt,{onClick:e}),t.jsx("button",{onClick:n,children:"â±ï¸"}),t.jsx(kt,{onClick:r})]})]})})}function ms({onTaskClick:e}){const[r,n]=b.useState(!1),s=b.useRef(null),{data:o,isLoading:a}=dt();b.useEffect(()=>{function c(u){s.current&&!s.current.contains(u.target)&&n(!1)}if(r)return document.addEventListener("mousedown",c),()=>{document.removeEventListener("mousedown",c)}},[r]);const i=c=>{n(!1),e(c)},l=o?.length??0;return t.jsxs("div",{className:"relative",ref:s,children:[t.jsxs("button",{onClick:()=>n(!r),className:"flex items-center space-x-1 text-gray-300 transition-colors hover:text-white",title:"Recent Tasks",children:[t.jsx("svg",{className:"h-5 w-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),t.jsx("span",{className:"hidden text-sm sm:inline",children:"Recent"}),l>0&&t.jsx("span",{className:"flex h-5 min-w-5 items-center justify-center rounded-full bg-blue-600 px-1.5 text-xs font-bold text-white",children:l})]}),r&&t.jsxs("div",{className:"absolute right-0 top-full z-50 mt-2 w-80 rounded-lg border border-gray-700 bg-gray-800 shadow-xl",children:[t.jsxs("div",{className:"border-b border-gray-700 px-4 py-3",children:[t.jsx("h3",{className:"font-semibold text-white",children:"Recently Touched Tasks"}),t.jsx("p",{className:"text-xs text-gray-400",children:"Last 10 tasks you've created, edited, or viewed"})]}),t.jsxs("div",{className:"max-h-96 overflow-y-auto",children:[a&&t.jsx("div",{className:"flex items-center justify-center py-8",children:t.jsx("div",{className:"h-6 w-6 animate-spin rounded-full border-b-2 border-blue-600"})}),!a&&l===0&&t.jsx("div",{className:"py-8 text-center",children:t.jsx("p",{className:"text-sm text-gray-400",children:"No recent tasks yet"})}),!a&&l>0&&t.jsx("ul",{className:"divide-y divide-gray-700",children:o?.map(c=>t.jsx("li",{children:t.jsxs("button",{onClick:()=>i(c),className:"w-full px-4 py-3 text-left transition-colors hover:bg-gray-700/50",children:[t.jsxs("div",{className:"flex items-start justify-between",children:[t.jsxs("div",{className:"flex-1",children:[t.jsx("p",{className:"font-medium text-white",children:c.name}),t.jsxs("p",{className:"text-xs text-gray-400",children:[c.root_category,c.deadline&&t.jsxs(t.Fragment,{children:[" ","â€¢ Due"," ",new Date(c.deadline).toLocaleDateString()]})]})]}),c.importance&&c.importance>=8&&t.jsx("span",{className:"ml-2 flex-shrink-0 text-xs text-purple-400",children:"â˜…"})]}),c.last_touched_at&&t.jsx("p",{className:"mt-1 text-xs text-gray-500",children:hs(c.last_touched_at)})]})},c.id))})]})]})]})}function hs(e){const r=new Date(e),s=Math.floor((new Date().getTime()-r.getTime())/1e3);return s<60?"Just now":s<3600?`${Math.floor(s/60)}m ago`:s<86400?`${Math.floor(s/3600)}h ago`:s<604800?`${Math.floor(s/86400)}d ago`:r.toLocaleDateString()}function xs({onOpenTasksDueToday:e,onOpenQuickAdd:r,onOpenHamburger:n,activeTab:s,onRecentTaskClick:o}){return t.jsx("div",{className:"border-b border-gray-700/50 bg-gray-900/95 shadow-md backdrop-blur-sm dark:border-gray-600/50 dark:bg-gray-800/95",children:t.jsxs("div",{className:"mx-auto flex max-w-[1800px] items-center justify-between px-6 py-3",children:[t.jsxs("div",{className:"flex items-center gap-6",children:[t.jsxs(ue,{to:"/",className:"flex items-center gap-2 rounded-lg px-3 py-2 text-base font-semibold text-gray-300 transition-all hover:bg-gray-800/60 hover:text-white dark:hover:bg-gray-700/60",children:[t.jsx("svg",{className:"h-5 w-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"})}),t.jsx("span",{children:"Home"})]}),t.jsx("div",{className:"block min-[1000px]:hidden",children:t.jsx("button",{onClick:n,className:"rounded-lg p-2 text-gray-300 transition-colors hover:bg-gray-800/60 hover:text-white","aria-label":"Open navigation menu",children:t.jsx("svg",{className:"h-6 w-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})})}),t.jsx("div",{className:"hidden min-[1000px]:block",children:t.jsx(ct,{activeTab:s,variant:"desktop"})})]}),t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx(Je,{}),t.jsx(ms,{onTaskClick:o}),t.jsx(Nt,{onClick:e}),t.jsx(kt,{onClick:r,showLabel:!0,className:"bg-blue-600 hover:bg-blue-700 dark:bg-blue-700 dark:hover:bg-blue-600"})]})]})})}const gs=new It,fs=["Household","Finances","Cleo","Job","Social","Personal","Orphans"];function ps(){const{tabName:e}=Tt(),r=e||"Household",[n,s]=b.useState(!1),[o,a]=b.useState(!1),[i,l]=b.useState(void 0),[c,u]=b.useState(!1),[p,m]=b.useState(!1),h=ot(),k=C=>{l(C.id),a(!0)},{data:N,isLoading:f,error:j}=xe({queryKey:["orgTree",r],queryFn:()=>Re(r),placeholderData:Ve});return e&&!fs.includes(e)?t.jsx(St,{to:"/org-chart/Household",replace:!0}):t.jsxs("div",{className:"app-layout",children:[t.jsx("nav",{className:"nav sticky top-0 z-40 bg-gray-900 dark:bg-gray-800",children:h?t.jsx(us,{onOpenTasksDueToday:()=>s(!0),onOpenTimeReport:()=>u(!0),onOpenQuickAdd:()=>a(!0),onOpenHamburger:()=>m(!0)}):t.jsx(xs,{onOpenTasksDueToday:()=>s(!0),onOpenQuickAdd:()=>a(!0),onOpenHamburger:()=>m(!0),activeTab:r,onRecentTaskClick:k})}),t.jsxs("main",{className:"main p-4",children:[f&&t.jsxs("div",{className:"text-gray-900 dark:text-gray-100",children:["Loading ",r," tree..."]}),j&&t.jsxs("div",{className:"text-red-600 dark:text-red-400",children:["Error loading ",r," tree"]}),N&&t.jsx(sr,{tabName:r})]}),n&&t.jsx(dr,{isOpen:n,onClose:()=>s(!1)}),o&&t.jsx(nr,{isOpen:o,onClose:()=>{a(!1),l(void 0)},initialTaskId:i}),c&&t.jsx(_r,{isOpen:c,onClose:()=>u(!1)}),p&&t.jsx(hr,{isOpen:p,onClose:()=>m(!1),activeTab:r})]})}const Ns=Ct(function(){return t.jsx(Ft,{client:gs,children:t.jsx(ps,{})})});export{Ns as default};
