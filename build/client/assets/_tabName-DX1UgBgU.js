import{a as g,p as t,t as pe,w as Ct,v as St,x as Tt}from"./chunk-PVWAREVJ-BCzKU303.js";import{Q as Ve,a as Dt,b as Et,e as Rt,c as Mt,d as Ot,f as $e,g as Ae,w as $t,h as At,s as Q,u as ve}from"./supabaseClient-BnqcRS6D.js";import{S as Lt,n as _e,r as qt,u as te,b as It,k as Ye,Q as Pt,a as Ft}from"./QueryClientProvider-C6_AEzee.js";import{g as z}from"./index-DKtf60Sy.js";import{u as le,Q as M}from"./queryKeys-DYvrcQe-.js";import{D as Je}from"./DarkModeToggle-2kuRDiJV.js";function Le(e,r){const n=new Set(r);return e.filter(s=>!n.has(s))}function zt(e,r,n){const s=e.slice(0);return s[r]=n,s}var Ut=class extends Lt{#s;#e;#n;#o;#t;#r;#a;#i;#l=[];constructor(e,r,n){super(),this.#s=e,this.#o=n,this.#n=[],this.#t=[],this.#e=[],this.setQueries(r)}onSubscribe(){this.listeners.size===1&&this.#t.forEach(e=>{e.subscribe(r=>{this.#m(e,r)})})}onUnsubscribe(){this.listeners.size||this.destroy()}destroy(){this.listeners=new Set,this.#t.forEach(e=>{e.destroy()})}setQueries(e,r){this.#n=e,this.#o=r,_e.batch(()=>{const n=this.#t,s=this.#u(this.#n);this.#l=s,s.forEach(l=>l.observer.setOptions(l.defaultedQueryOptions));const o=s.map(l=>l.observer),a=o.map(l=>l.getCurrentResult()),i=o.some((l,c)=>l!==n[c]);n.length===o.length&&!i||(this.#t=o,this.#e=a,this.hasListeners()&&(Le(n,o).forEach(l=>{l.destroy()}),Le(o,n).forEach(l=>{l.subscribe(c=>{this.#m(l,c)})}),this.#h()))})}getCurrentResult(){return this.#e}getQueries(){return this.#t.map(e=>e.getCurrentQuery())}getObservers(){return this.#t}getOptimisticResult(e,r){const n=this.#u(e),s=n.map(o=>o.observer.getOptimisticResult(o.defaultedQueryOptions));return[s,o=>this.#d(o??s,r),()=>this.#c(s,n)]}#c(e,r){return r.map((n,s)=>{const o=e[s];return n.defaultedQueryOptions.notifyOnChangeProps?o:n.observer.trackResult(o,a=>{r.forEach(i=>{i.observer.trackProp(a)})})})}#d(e,r){return r?((!this.#r||this.#e!==this.#i||r!==this.#a)&&(this.#a=r,this.#i=this.#e,this.#r=qt(this.#r,r(e))),this.#r):e}#u(e){const r=new Map(this.#t.map(s=>[s.options.queryHash,s])),n=[];return e.forEach(s=>{const o=this.#s.defaultQueryOptions(s),a=r.get(o.queryHash);a?n.push({defaultedQueryOptions:o,observer:a}):n.push({defaultedQueryOptions:o,observer:new Ve(this.#s,o)})}),n}#m(e,r){const n=this.#t.indexOf(e);n!==-1&&(this.#e=zt(this.#e,n,r),this.#h())}#h(){if(this.hasListeners()){const e=this.#r,r=this.#c(this.#e,this.#l),n=this.#d(r,this.#o?.combine);e!==n&&_e.batch(()=>{this.listeners.forEach(s=>{s(this.#e)})})}}};function Xe({queries:e,...r},n){const s=te(),o=Dt(),a=Et(),i=g.useMemo(()=>e.map(d=>{const k=s.defaultQueryOptions(d);return k._optimisticResults=o?"isRestoring":"optimistic",k}),[e,s,o]);i.forEach(d=>{Rt(d),Mt(d,a)}),Ot(a);const[l]=g.useState(()=>new Ut(s,i,r)),[c,m,h]=l.getOptimisticResult(i,r.combine),x=!o&&r.subscribed!==!1;g.useSyncExternalStore(g.useCallback(d=>x?l.subscribe(_e.batchCalls(d)):It,[l,x]),()=>l.getCurrentResult(),()=>l.getCurrentResult()),g.useEffect(()=>{l.setQueries(i,r)},[i,r,l]);const j=c.some((d,k)=>$e(i[k],d))?c.flatMap((d,k)=>{const S=i[k];if(S){const N=new Ve(s,S);if($e(S,d))return Ae(S,N,a);$t(d,o)&&Ae(S,N,a)}return[]}):[];if(j.length>0)throw Promise.all(j);const _=c.find((d,k)=>{const S=i[k];return S&&At({result:d,errorResetBoundary:a,throwOnError:S.throwOnError,query:s.getQueryCache().get(S.queryHash),suspense:S.suspense})});if(_?.error)throw _.error;return m(h())}/*!
 * @gsap/react 2.1.2
 * https://gsap.com
 *
 * Copyright 2008-2025, GreenSock. All rights reserved.
 * Subject to the terms at https://gsap.com/standard-license or for
 * Club GSAP members, the agreement issued with that membership.
 * @author: Jack Doyle, jack@greensock.com
*/let qe=typeof document<"u"?g.useLayoutEffect:g.useEffect,Ie=e=>e&&!Array.isArray(e)&&typeof e=="object",ge=[],Qt={},Ze=z;const Ee=(e,r=ge)=>{let n=Qt;Ie(e)?(n=e,e=null,r="dependencies"in n?n.dependencies:ge):Ie(r)&&(n=r,r="dependencies"in n?n.dependencies:ge),e&&typeof e!="function"&&console.warn("First parameter must be a function or config object");const{scope:s,revertOnUpdate:o}=n,a=g.useRef(!1),i=g.useRef(Ze.context(()=>{},s)),l=g.useRef(m=>i.current.add(null,m)),c=r&&r.length&&!o;return c&&qe(()=>(a.current=!0,()=>i.current.revert()),ge),qe(()=>{if(e&&i.current.add(e,s),!c||!a.current)return()=>i.current.revert()},r),{context:i.current,contextSafe:l.current}};Ee.register=e=>{Ze=e};Ee.headless=!0;function we(e,r,n){if(!e||!r||!n)return 1;const s=new Date,a=new Date(e).getTime()-s.getTime(),i=Math.ceil(a/(1e3*3600*24));if(i<=0||n>=i)return 10;try{const l=n/i*(r/i)+Math.exp(4*(n/i)/(1-n/i))-1;return l<.25?1:l>=.25&&l<.5?2:l>=.5&&l<1?3:l>=1&&l<1.75?4:l>=1.75&&l<2.5?5:l>=2.5&&l<4?6:l>=4&&l<5.5?7:l>=5.5&&l<7.5?8:l>=7.5&&l<10?9:10}catch(l){return console.warn("Urgency calculation failed:",l),1}}function Bt(e){return e.type!=="task"?1:we(e.deadline,e.completion_time,e.unique_days_required)}function Wt(e=1){switch(e){case 1:return"";case 2:return"bg-lime-400";case 3:return"bg-yellow-400";case 4:return"bg-yellow-500";case 5:return"bg-amber-500";case 6:return"bg-orange-400";case 7:return"bg-orange-500";case 8:return"bg-red-400";case 9:return"bg-red-500";case 10:return"bg-red-600";default:return""}}function Gt(e=1){if(e<=1)return"";switch(e){case 2:case 3:return"w-2 h-2";case 4:case 5:case 6:return"w-3 h-3";case 7:case 8:return"w-4 h-4";case 9:case 10:return"w-5 h-5";default:return"w-2 h-2"}}function Ht(e=1){if(e<=1)return 0;switch(e){case 2:return 4;case 3:return 3.5;case 4:return 3;case 5:return 2.5;case 6:return 2;case 7:return 1.5;case 8:return 1.2;case 9:return 1;case 10:return .8;default:return 2}}function Kt(e=1){if(e<=1)return"";switch(e){case 2:return"shadow-sm shadow-lime-400/50";case 3:return"shadow-sm shadow-yellow-400/50";case 4:return"shadow-sm shadow-yellow-500/50";case 5:return"shadow-md shadow-amber-500/50";case 6:return"shadow-md shadow-orange-400/50";case 7:return"shadow-md shadow-orange-500/50";case 8:return"shadow-lg shadow-red-400/60";case 9:return"shadow-lg shadow-red-500/70";case 10:return"shadow-xl shadow-red-600/80";default:return""}}function Ce(e=1){return e>1}function Pe(e){const r=e.getBoundingClientRect(),n=r.width,s=r.height,o=window.getComputedStyle(e),a=parseFloat(o.borderRadius)||8,i=Math.min(n,s)/2,l=Math.min(a,i),c=[],m=0,h=n,x=0,u=s;return c.push(`M ${n/2} ${x}`),c.push(`L ${h-l} ${x}`),c.push(`Q ${h} ${x} ${h} ${x+l}`),c.push(`L ${h} ${u-l}`),c.push(`Q ${h} ${u} ${h-l} ${u}`),c.push(`L ${m+l} ${u}`),c.push(`Q ${m} ${u} ${m} ${u-l}`),c.push(`L ${m} ${x+l}`),c.push(`Q ${m} ${x} ${m+l} ${x}`),c.push(`L ${n/2} ${x}`),c.join(" ")}function je(e=1){return{duration:Ht(e),ease:"none",repeat:-1,autoRotate:e>=7,yoyo:!1}}function et(e){if(e.type==="task")return Bt(e);if(!e.children||e.children.length===0)return 1;const r=e.children.map(n=>et(n));return Math.max(...r)}function tt(e){return et(e)}function Vt(e=1){switch(e){case 1:return"";case 2:return"border-2 border-cyan-400";case 3:return"border-2 border-cyan-500";case 4:return"border-2 border-blue-400";case 5:return"border-2 border-blue-500";case 6:return"border-2 border-indigo-400";case 7:return"border-2 border-indigo-500";case 8:return"border-2 border-purple-400";case 9:return"border-2 border-purple-500";case 10:return"border-2 border-purple-600";default:return""}}function Yt(e=1){if(e<=1)return"";switch(e){case 2:return"shadow-lg shadow-cyan-400/50";case 3:return"shadow-lg shadow-cyan-500/50";case 4:return"shadow-lg shadow-blue-400/50";case 5:return"shadow-lg shadow-blue-500/50";case 6:return"shadow-lg shadow-indigo-400/50";case 7:return"shadow-lg shadow-indigo-500/50";case 8:return"shadow-lg shadow-purple-400/50";case 9:return"shadow-lg shadow-purple-500/50";case 10:return"shadow-xl shadow-purple-600/75";default:return""}}function rt(e){if(e.type==="task")return e.importance??1;if(!e.children||e.children.length===0)return 1;const r=e.children.map(n=>rt(n));return Math.max(...r)}function Re(e){return rt(e)}function Jt(e){return!e||e<=1?"rgba(0, 0, 0, 0)":e<=3?"rgba(6, 182, 212, 0.6)":e<=5?"rgba(59, 130, 246, 0.6)":e<=7?"rgba(99, 102, 241, 0.6)":e<=9?"rgba(147, 51, 234, 0.6)":"rgba(126, 34, 206, 0.8)"}function st(e,r,n){const s=n?`${n}/${e.name}`:`/${e.name}`;if(tt(e)<=1)return[];if(e.type==="task")return[s];if(!r[s])return[s];const i=[];if(e.children)for(const l of e.children){const c=st(l,r,s);i.push(...c)}return i}function nt(e,r,n){const s=n?`${n}/${e.name}`:`/${e.name}`;if(Re(e)!==10)return null;if(e.type==="task"||!r[s])return s;if(e.children)for(const i of e.children){const l=nt(i,r,s);if(l)return l}return null}function Xt({containerRef:e,tree:r,openMap:n,tabName:s,isMobile:o,activePath:a}){Ee(()=>{const i=e?.current;if(!i){console.log("üîç GSAP: No container found, skipping animations");return}z.killTweensOf("*"),z.set("*",{clearProps:"all"});const l=setTimeout(()=>{try{o?m():(c(),h())}catch(x){console.error("üö® GSAP: Animation error:",x)}},100),c=()=>{const x=new Set;if(r.children)for(const j of r.children)st(j,n,`/${s}`).forEach(d=>x.add(d));i.querySelectorAll("[data-urgency-ball]").forEach(j=>{const _=j.getAttribute("data-urgency-ball");if(!_)return;if(!x.has(_)){z.set(j,{opacity:0});return}z.set(j,{opacity:1});const d=i.querySelector(`[data-node-path="${_}"]`);if(!d)return;const k=parseInt(d.getAttribute("data-urgency")||"1");if(Ce(k))try{const S=Pe(d),N=je(k);z.set(j,{position:"absolute",left:0,top:0,xPercent:-50,yPercent:-50}),z.to(j,{motionPath:{path:S,autoRotate:N.autoRotate,alignOrigin:[.5,.5]},duration:N.duration,ease:N.ease,repeat:N.repeat})}catch(S){console.error(`üö® GSAP: Failed animating ball for ${_}`,S)}})},m=()=>{i.querySelectorAll("[data-urgency-ball]").forEach(u=>{const j=u.getAttribute("data-urgency-ball");if(!j)return;const _=i.querySelector(`[data-node-path="${j}"]`);if(!_){z.set(u,{opacity:0});return}const d=parseInt(_.getAttribute("data-urgency")||"1");if(!Ce(d)){z.set(u,{opacity:0});return}try{z.set(u,{opacity:1});const k=Pe(_),S=je(d);z.set(u,{position:"absolute",left:0,top:0,xPercent:-50,yPercent:-50}),z.to(u,{motionPath:{path:k,autoRotate:S.autoRotate,alignOrigin:[.5,.5]},duration:S.duration,ease:S.ease,repeat:S.repeat})}catch(k){console.error(`üö® GSAP: Failed animating mobile ball for ${j}`,k),z.set(u,{position:"absolute",left:"50%",top:"0px",xPercent:-50,yPercent:-50}),z.to(u,{rotation:360,duration:je(d).duration,repeat:-1,ease:"none",transformOrigin:"50% 100px"})}})},h=()=>{if(r.children)for(const x of r.children){const u=nt(x,n,`/${s}`);if(!u)continue;const j=i.querySelector(`[data-node-path="${u}"]`);if(!j)continue;const _=Re(x),d=Jt(_);z.set(j,{boxShadow:`0 0 20px ${d}`}),z.to(j,{scale:1.03,duration:1.2,ease:"power2.inOut",yoyo:!0,repeat:-1})}};return()=>{clearTimeout(l),z.killTweensOf("*"),z.set("*",{clearProps:"all"})}},{scope:e,dependencies:[r,n,s,o,a],revertOnUpdate:!0})}function ot(e,r,n="",s){const o=n?`${n}/${e.name}`:`/${s}`;if(e.children){for(const a of e.children)if(`${o}/${a.name}`===r)return e.children.map(l=>`${o}/${l.name}`);for(const a of e.children){const i=ot(a,r,o,s);if(i.length>0)return i}}return[]}function Zt(e,r,n){return g.useCallback(s=>{n(o=>{const a={...o};return o[s]?Object.keys(o).filter(c=>c.startsWith(s+"/")||c===s).forEach(c=>{a[c]=!1}):(ot(e,s,"",r).forEach(c=>{c!==s&&(a[c]=!1,Object.keys(o).forEach(m=>{m.startsWith(c+"/")&&(a[m]=!1)}))}),a[s]=!0),a})},[e,r,n])}function at(e=640){const[r,n]=g.useState(!1);return g.useEffect(()=>{const s=()=>n(window.innerWidth<e);return s(),window.addEventListener("resize",s),()=>window.removeEventListener("resize",s)},[e]),r}function er(e){const r=new Map,n={};return e.forEach(s=>{r.set(s.id,{id:s.id,name:s.name,type:s.type,details:s.details??void 0,importance:s.importance??(s.type==="task"?1:void 0),deadline:s.deadline??void 0,completion_time:s.completion_time??void 0,unique_days_required:s.unique_days_required??void 0,is_completed:s.is_completed??void 0,completed_at:s.completed_at??void 0,completion_comment:s.completion_comment??void 0,children:[],tab_name:s.tab_name,root_category:s.root_category,parent_id:s.parent_id,recurrence_type:s.recurrence_type??void 0,recurrence_interval:s.recurrence_interval??void 0,recurrence_day_of_week:s.recurrence_day_of_week??void 0,recurrence_day_of_month:s.recurrence_day_of_month??void 0,recurrence_end_date:s.recurrence_end_date??void 0,is_recurring_template:s.is_recurring_template??void 0,recurring_template_id:s.recurring_template_id??void 0})}),e.forEach(s=>{const o=r.get(s.id);if(s.parent_id){const a=r.get(s.parent_id);a&&a.children.push(o)}else n[s.root_category??"default"]=o}),n}async function Me(e){const{data:r,error:n}=await Q.from("org_nodes").select("*").eq("root_category",e).not("is_completed","is",!0),s=r;if(n)throw n;return er(s??[])[e]??{id:0,name:e,type:"category",root_category:e,children:[]}}const tr=()=>{const e=te();return le({mutationFn:async r=>{if(r.id){const{data:n,error:s}=await Q.from("org_nodes").update(r).eq("id",r.id).select().single();if(s)throw s;return n}else{const{data:n,error:s}=await Q.from("org_nodes").insert({...r,type:"task"}).select().single();if(s)throw s;return n}},onSuccess:r=>{e.setQueryData(M.task(r.id),r),e.invalidateQueries({queryKey:M.allOrgTrees()}),e.invalidateQueries({queryKey:M.allTasks()}),e.invalidateQueries({queryKey:M.urgentTaskCount()})},onError:r=>{console.error("‚ùå Save task error:",r)}})},rr=()=>{const e=te();return le({mutationFn:async r=>{const{error:n}=await Q.from("org_nodes").delete().eq("id",r);if(n)throw n;return r},onSuccess:r=>{e.removeQueries({queryKey:M.task(r)}),e.invalidateQueries({queryKey:M.allOrgTrees()}),e.invalidateQueries({queryKey:M.allTasks()}),e.invalidateQueries({queryKey:M.urgentTaskCount()})},onError:r=>{console.error("‚ùå Delete task error:",r)}})};function sr(e,r){const n=new Date(e),s=new Date(n);switch(r.type){case"minutely":return s.setMinutes(s.getMinutes()+r.interval),s.toISOString();case"daily":s.setDate(s.getDate()+r.interval);break;case"weekly":if(r.dayOfWeek!==void 0){const o=(r.dayOfWeek-s.getDay()+7)%7;s.setDate(s.getDate()+o+(r.interval-1)*7)}else s.setDate(s.getDate()+r.interval*7);break;case"monthly":if(r.dayOfMonth!==void 0)s.setMonth(s.getMonth()+r.interval),s.setDate(Math.min(r.dayOfMonth,Fe(s)));else{const o=n.getDate();s.setMonth(s.getMonth()+r.interval),s.setDate(Math.min(o,Fe(s)))}break;case"yearly":s.setFullYear(s.getFullYear()+r.interval);break;default:throw new Error(`Unsupported recurrence type: ${r.type}`)}return r.type==="minutely"?s.toISOString():s.toISOString().split("T")[0]}function nr(e,r){if(!r)return!0;const n=new Date(e),s=new Date(r);return n<=s}function Fe(e){return new Date(e.getFullYear(),e.getMonth()+1,0).getDate()}function or(e){const{type:r,interval:n,dayOfWeek:s,dayOfMonth:o}=e,a=n===1?"Weekly":`Every ${n} weeks`,i=n===1?"Monthly":`Every ${n} months`,l=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];switch(r){case"minutely":return n===1?"Every minute":`Every ${n} minutes`;case"daily":return n===1?"Daily":`Every ${n} days`;case"weekly":return s!==void 0?`${a} on ${l[s]}`:a;case"monthly":if(o!==void 0){const c=ar(o);return`${i} on the ${o}${c}`}return i;case"yearly":return n===1?"Yearly":`Every ${n} years`;default:return"No recurrence"}}function ar(e){if(e>=11&&e<=13)return"th";switch(e%10){case 1:return"st";case 2:return"nd";case 3:return"rd";default:return"th"}}function ir({initialConfig:e,onChange:r,disabled:n=!1,className:s=""}){const[o,a]=g.useState(e?.type||"none"),[i,l]=g.useState(e?.interval||1),[c,m]=g.useState(e?.dayOfWeek??""),[h,x]=g.useState(e?.dayOfMonth??""),[u,j]=g.useState(e?.endDate||""),_=g.useRef("");return g.useEffect(()=>{if(e){const d=JSON.stringify(e);d!==_.current&&(console.log("üîÑ RecurrenceConfig: Updating from initialConfig:",e),a(e.type||"none"),l(e.interval||1),m(e.dayOfWeek??""),x(e.dayOfMonth??""),j(e.endDate||""),_.current=d)}},[e]),g.useEffect(()=>{const d={recurrence_type:o,recurrence_interval:o!=="none"?i:void 0,recurrence_day_of_week:o==="weekly"&&c!==""?Number(c):void 0,recurrence_day_of_month:o==="monthly"&&h!==""?Number(h):void 0,recurrence_end_date:o!=="none"&&u?u:void 0,is_recurring_template:o!=="none"};console.log("üîÑ RecurrenceConfig: Emitting config change:",d),r(d)},[o,i,c,h,u]),t.jsxs("div",{className:`rounded border bg-gray-50 p-4 dark:bg-gray-800 ${s}`,children:[t.jsxs("h4",{className:"mb-3 flex items-center font-medium text-gray-700 dark:text-gray-300",children:[t.jsx("svg",{className:"mr-2 h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),"Repeat Task"]}),t.jsxs("div",{className:"mb-3",children:[t.jsx("label",{className:"mb-1 block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Repeat:"}),t.jsxs("select",{className:"w-full rounded border border-gray-300 px-3 py-2 text-black focus:ring-2 focus:ring-blue-500 dark:border-gray-600 dark:bg-gray-700 dark:text-white",value:o,onChange:d=>{console.log("üîÑ RecurrenceConfig: Type changed to:",d.target.value),a(d.target.value)},disabled:n,children:[t.jsx("option",{value:"none",children:"No repeat"}),t.jsx("option",{value:"minutely",children:"Every minute (testing)"}),t.jsx("option",{value:"daily",children:"Daily"}),t.jsx("option",{value:"weekly",children:"Weekly"}),t.jsx("option",{value:"monthly",children:"Monthly"}),t.jsx("option",{value:"yearly",children:"Yearly"})]})]}),o!=="none"&&t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"mb-3",children:[t.jsx("label",{className:"mb-1 block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Every:"}),t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx("input",{type:"number",min:"1",max:"365",className:"w-20 rounded border border-gray-300 px-3 py-2 text-black focus:ring-2 focus:ring-blue-500 dark:border-gray-600 dark:bg-gray-700 dark:text-white",value:i,onChange:d=>l(Number(d.target.value)),disabled:n}),t.jsxs("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:[o==="minutely"&&(i===1?"minute":"minutes"),o==="daily"&&(i===1?"day":"days"),o==="weekly"&&(i===1?"week":"weeks"),o==="monthly"&&(i===1?"month":"months"),o==="yearly"&&(i===1?"year":"years")]})]})]}),o==="weekly"&&t.jsxs("div",{className:"mb-3",children:[t.jsx("label",{className:"mb-1 block text-sm font-medium text-gray-700 dark:text-gray-300",children:"On day:"}),t.jsxs("select",{className:"w-full rounded border border-gray-300 px-3 py-2 text-black focus:ring-2 focus:ring-blue-500 dark:border-gray-600 dark:bg-gray-700 dark:text-white",value:c,onChange:d=>m(d.target.value?Number(d.target.value):""),disabled:n,children:[t.jsx("option",{value:"",children:"Same day as deadline"}),t.jsx("option",{value:"0",children:"Sunday"}),t.jsx("option",{value:"1",children:"Monday"}),t.jsx("option",{value:"2",children:"Tuesday"}),t.jsx("option",{value:"3",children:"Wednesday"}),t.jsx("option",{value:"4",children:"Thursday"}),t.jsx("option",{value:"5",children:"Friday"}),t.jsx("option",{value:"6",children:"Saturday"})]})]}),o==="monthly"&&t.jsxs("div",{className:"mb-3",children:[t.jsx("label",{className:"mb-1 block text-sm font-medium text-gray-700 dark:text-gray-300",children:"On day of month:"}),t.jsxs("select",{className:"w-full rounded border border-gray-300 px-3 py-2 text-black focus:ring-2 focus:ring-blue-500 dark:border-gray-600 dark:bg-gray-700 dark:text-white",value:h,onChange:d=>x(d.target.value?Number(d.target.value):""),disabled:n,children:[t.jsx("option",{value:"",children:"Same day as deadline"}),Array.from({length:31},(d,k)=>k+1).map(d=>t.jsx("option",{value:d,children:d},d))]})]}),t.jsxs("div",{className:"mb-3",children:[t.jsx("label",{className:"mb-1 block text-sm font-medium text-gray-700 dark:text-gray-300",children:"End repeat (optional):"}),t.jsx("input",{type:"date",className:"w-full rounded border border-gray-300 px-3 py-2 text-black focus:ring-2 focus:ring-blue-500 dark:border-gray-600 dark:bg-gray-700 dark:text-white",value:u,onChange:d=>j(d.target.value),min:new Date().toISOString().split("T")[0],disabled:n})]}),t.jsxs("div",{className:"mt-3 rounded border-l-4 border-blue-400 bg-blue-50 p-2 dark:bg-blue-900/20",children:[t.jsxs("p",{className:"text-sm text-blue-700 dark:text-blue-300",children:[t.jsx("strong",{children:"Pattern:"})," ",or({type:o,interval:i,dayOfWeek:c!==""?Number(c):void 0,dayOfMonth:h!==""?Number(h):void 0})]}),u&&t.jsxs("p",{className:"mt-1 text-sm text-blue-700 dark:text-blue-300",children:[t.jsx("strong",{children:"Ends:"})," ",new Date(u).toLocaleDateString()]})]})]})]})}async function lr(e){if(console.log("üîç DEBUG - createRecurringInstance called with task:",{name:e.name,id:e.id,is_completed:e.is_completed,is_recurring_template:e.is_recurring_template,recurring_template_id:e.recurring_template_id,recurrence_type:e.recurrence_type,deadline:e.deadline,parent_id:e.parent_id}),console.log("üîÑ createRecurringInstance called for task:",e.name),!e.is_recurring_template&&!e.recurring_template_id)return console.log("‚ùå Check 1 FAILED: Task is not recurring",{is_recurring_template:e.is_recurring_template,recurring_template_id:e.recurring_template_id}),null;if(console.log("‚úÖ Check 1 PASSED: Task is recurring"),e.recurrence_type==="none"||!e.recurrence_type)return console.log("‚ùå Check 2 FAILED: No recurrence type set",{recurrence_type:e.recurrence_type}),null;if(console.log("‚úÖ Check 2 PASSED: Recurrence type is set:",e.recurrence_type),!e.is_completed)return console.log("‚ùå Check 3 FAILED: Task is not marked as completed",{is_completed:e.is_completed}),null;console.log("‚úÖ Check 3 PASSED: Task is completed"),console.log("üîç Check 4: Checking for recent instances...");const r=new Date(Date.now()-6e4).toISOString();let n=Q.from("org_nodes").select("id, name, created_at").eq("name",e.name).eq("recurring_template_id",e.is_recurring_template?e.id:e.recurring_template_id).gte("created_at",r);e.parent_id!=null?n=n.eq("parent_id",e.parent_id):n=n.is("parent_id",null);const{data:s,error:o}=await n;if(o)throw console.error("‚ùå Check 4 ERROR: Error checking for recent instances:",o),o;if(console.log("üîç Check 4 RESULT: Recent instances found:",s),s&&s.length>0)return console.log("‚ùå Check 4 FAILED: Recent instance already exists, skipping creation"),null;console.log("‚úÖ Check 4 PASSED: No recent instances found"),console.log("üîç Check 5: Calculating next deadline...");try{const a=sr(e.deadline||new Date().toISOString().split("T")[0],{type:e.recurrence_type,interval:e.recurrence_interval||1,dayOfWeek:e.recurrence_day_of_week,dayOfMonth:e.recurrence_day_of_month,endDate:e.recurrence_end_date});if(console.log("‚úÖ Check 5 PASSED: Next deadline calculated:",a),!nr(a,e.recurrence_end_date))return console.log("‚ùå Check 6 FAILED: Recurrence end date reached",{nextDeadline:a,endDate:e.recurrence_end_date}),null;console.log("‚úÖ Check 6 PASSED: Should create next instance"),console.log(e,"THE FUCKING COMPLETED TASK!!!"),console.log(e.parent_id,"THE FUCKING COMPLETED TASK PARENT_ID!!!!!!!!");const i={name:e.name,type:"task",details:e.details,importance:e.importance,deadline:a,completion_time:e.completion_time,unique_days_required:e.unique_days_required,parent_id:e.parent_id||null,tab_name:e.tab_name,root_category:e.root_category,recurrence_type:e.recurrence_type,recurrence_interval:e.recurrence_interval,recurrence_day_of_week:e.recurrence_day_of_week,recurrence_day_of_month:e.recurrence_day_of_month,recurrence_end_date:e.recurrence_end_date,is_recurring_template:!1,recurring_template_id:e.is_recurring_template?e.id:e.recurring_template_id};console.log("üîç DEBUG - newTaskData before insertion:",i),console.log("üîÑ Creating next recurring instance:",{originalTask:e.name,newDeadline:a,recurrenceType:e.recurrence_type,newTaskData:i});const{data:l,error:c}=await Q.from("org_nodes").insert([i]).select().single();if(c)throw console.error("‚ùå Database error creating recurring instance:",c),c;return console.log("‚úÖ Successfully created recurring instance:",l),l}catch(a){throw console.error("‚ùå Failed to create recurring instance:",a),a}}function cr(){const e=te();return le({mutationFn:async r=>{const{error:n}=await Q.from("org_nodes").update({last_touched_at:new Date().toISOString()}).eq("id",r);if(n)throw n},onSuccess:()=>{e.invalidateQueries({queryKey:M.recentTasks()})}})}async function dr({id:e,name:r,details:n,importance:s,deadline:o,completion_time:a,unique_days_required:i,is_completed:l,completed_at:c,completion_comment:m}){const h={};r!==void 0&&(h.name=r),n!==void 0&&(h.details=n),s!==void 0&&(h.importance=s),o!==void 0&&(h.deadline=o),a!==void 0&&(h.completion_time=a),i!==void 0&&(h.unique_days_required=i),l!==void 0&&(h.is_completed=l),c!==void 0&&(h.completed_at=c??void 0),m!==void 0&&(h.completion_comment=m),h.last_touched_at=new Date().toISOString();const{data:x,error:u}=await Q.from("org_nodes").update(h).eq("id",e).select().single();if(u)throw u;return x}const ur={traverse(e,r){r(e),e.children&&e.children.length>0&&e.children.forEach(n=>this.traverse(n,r))},findById(e,r){if(e.id===r)return e;if(e.children&&e.children.length>0)for(const n of e.children){const s=this.findById(n,r);if(s)return s}return null},updateNode(e,r,n){if(e.id===r)return{...e,...n};if(e.children&&e.children.length>0){const s=e.children.map(o=>this.updateNode(o,r,n));return{...e,children:s}}return e},addChild(e,r,n){return r?e.id===r?{...e,children:[...e.children??[],n]}:e.children&&e.children.length>0?{...e,children:e.children.map(s=>this.addChild(s,r,n))}:e:{...e,children:[...e.children??[],n]}},removeNode(e,r){if(e.id===r)return null;if(e.children&&e.children.length>0){const n=e.children.map(s=>this.removeNode(s,r)).filter(s=>s!==null);return{...e,children:n}}return e},getDescendants(e){const r=[e];return e.children&&e.children.length>0&&e.children.forEach(n=>{r.push(...this.getDescendants(n))}),r},getNodePath(e,r){if(e.id===r)return[e];if(e.children&&e.children.length>0)for(const n of e.children){const s=this.getNodePath(n,r);if(s.length>0)return[e,...s]}return[]},countNodes(e){let r=1;return e.children&&e.children.length>0&&(r+=e.children.reduce((n,s)=>n+this.countNodes(s),0)),r},getMaxDepth(e){return!e.children||e.children.length===0?1:1+Math.max(...e.children.map(r=>this.getMaxDepth(r)))},filter(e,r){const n=[];return this.traverse(e,s=>{r(s)&&n.push(s)}),n},map(e,r){const n=r(e);return n.children&&n.children.length>0?{...n,children:n.children.map(s=>this.map(s,r))}:n}};function mr(e){const r=te();return le({mutationFn:async s=>await dr(s),onMutate:async s=>{await r.cancelQueries({queryKey:M.orgTree(e)});const o=r.getQueryData(M.orgTree(e));if(!o||!s.id)return{previousTree:null};const a={};s.name!==void 0&&(a.name=s.name),s.details!==void 0&&(a.details=s.details),s.importance!==void 0&&(a.importance=s.importance),s.deadline!==void 0&&(a.deadline=s.deadline),s.completion_time!==void 0&&(a.completion_time=s.completion_time),s.unique_days_required!==void 0&&(a.unique_days_required=s.unique_days_required),s.is_completed!==void 0&&(a.is_completed=s.is_completed),s.completed_at!==void 0&&(a.completed_at=s.completed_at===null?void 0:s.completed_at),s.completion_comment!==void 0&&(a.completion_comment=s.completion_comment);const i=ur.updateNode(o,s.id,a);return r.setQueryData(M.orgTree(e),i),{previousTree:o}},onError:(s,o,a)=>{console.log("‚ùå EDIT ONERROR: Edit failed for node:",o.id,"Error:",s),a?.previousTree&&r.setQueryData(M.orgTree(e),a.previousTree)},onSettled:()=>{r.invalidateQueries({queryKey:M.orgTree(e)}),r.invalidateQueries({queryKey:M.urgentTaskCount()}),r.invalidateQueries({queryKey:M.recentTasks()})}})}function ee({task:e,onCancel:r,parentId:n,parentName:s,rootCategory:o,tabName:a}){const[i,l]=g.useState(e?.name??""),[c,m]=g.useState(e?.details??""),[h,x]=g.useState(e?.importance??1),[u,j]=g.useState(e?.deadline??""),[_,d]=g.useState(e?.completion_time??1),[k,S]=g.useState(e?.unique_days_required??1),[N,q]=g.useState(e?.is_completed??!1),[D,W]=g.useState(e?.completion_comment??""),[I,G]=g.useState(e?.completed_at??null),[b,v]=g.useState({recurrence_type:"none",recurrence_interval:void 0,recurrence_day_of_week:void 0,recurrence_day_of_month:void 0,recurrence_end_date:void 0,is_recurring_template:!1}),P=tr(),H=rr(),w=cr(),$=mr(e?.root_category||""),O=!e,A=!!e,L=g.useRef(!1),E=g.useRef(!1),[f,Y]=g.useState(!1);g.useEffect(()=>{if(e){l(e.name),m(e.details??""),x(e.importance??1),j(e.deadline??""),d(e.completion_time??1),S(e.unique_days_required??1),q(e.is_completed??!1),W(e.completion_comment??""),G(e.completed_at??null);const C=e.recurrence_type||"none";v({recurrence_type:C,recurrence_interval:C!=="none"?e.recurrence_interval||1:void 0,recurrence_day_of_week:C==="weekly"?e.recurrence_day_of_week:void 0,recurrence_day_of_month:C==="monthly"?e.recurrence_day_of_month:void 0,recurrence_end_date:C!=="none"?e.recurrence_end_date:void 0,is_recurring_template:C!=="none"}),L.current=!1,Y(!1)}},[e]),g.useEffect(()=>{e?.id&&w.mutate(String(e.id))},[e?.id]);const oe=C=>{q(C),Y(!0),C&&!e?.is_completed?G(new Date().toISOString()):!C&&e?.is_completed&&G(null)},ae=async()=>{if(!e)return;if(E.current){console.log("üîÑ Already processing completion, skipping...");return}E.current=!0;const C={id:e.id,is_completed:N,completion_comment:D||void 0,completed_at:I||void 0};console.log("üöÄ Saving task completion:",C),$.mutate(C,{onSuccess:async()=>{if(console.log("‚úÖ Task completion saved successfully"),Y(!1),N&&!e.is_completed&&!L.current&&b.recurrence_type!=="none"&&b.recurrence_type){console.log("üîÑ Task completed with recurrence, creating next instance..."),L.current=!0;try{const R={...e,is_completed:!0,completed_at:I||void 0,completion_comment:D,recurrence_type:b.recurrence_type,recurrence_interval:b.recurrence_interval,recurrence_day_of_week:b.recurrence_day_of_week,recurrence_day_of_month:b.recurrence_day_of_month,recurrence_end_date:b.recurrence_end_date,is_recurring_template:b.is_recurring_template},K=await lr(R);K&&console.log("‚úÖ Successfully created recurring instance:",K.name)}catch(R){console.error("‚ùå Failed to create recurring instance:",R),L.current=!1}}N&&r()},onError:R=>{console.error("‚ùå Failed to save task completion:",R),alert(`Failed to save completion: ${R.message}`)},onSettled:()=>{E.current=!1}})},ue=C=>{C.preventDefault();const R=e?.parent_id??n,K=e?.root_category??o,J=e?.tab_name??a;if(O&&(!R||!K||!J)){console.error("‚ùå Missing required parent context for new task:",{parentId:R,rootCategory:K,tabName:J}),alert("Missing parent information. Please try again.");return}const se={id:e?.id,name:i.trim(),details:c.trim()||void 0,importance:h,deadline:u||void 0,completion_time:_,unique_days_required:k,parent_id:R,root_category:K,tab_name:J,type:"task",...A&&!f&&{is_completed:N,completion_comment:D||void 0,completed_at:I||void 0},...b};console.log("üöÄ Submitting task data:",se),P.mutate(se,{onSuccess:X=>{console.log("‚úÖ Task saved successfully:",X),r()},onError:X=>{console.error("‚ùå Failed to save task:",X),alert(`Failed to save task: ${X.message}`)}})},U=()=>{if(e?.id){if(!confirm(`Are you sure you want to delete "${e.name}"?`))return;console.log("üóëÔ∏è Deleting task:",e.id),H.mutate(e.id,{onSuccess:()=>{console.log("‚úÖ Task deleted successfully"),r()},onError:C=>{console.error("‚ùå Failed to delete task:",C),alert(`Failed to delete task: ${C.message}`)}})}},B=C=>C?new Date(C).toISOString().split("T")[0]:"",re=()=>A&&e?.root_category?e.root_category:O&&s&&o?`${o} > ${s}`:"Unknown";return t.jsx("div",{className:"bg-opacity-50 fixed inset-0 z-[70] flex items-center justify-center bg-black",children:t.jsxs("form",{onSubmit:ue,className:"mx-4 max-h-[90vh] w-full max-w-md space-y-4 overflow-y-auto rounded-lg bg-white p-6 text-black shadow-md",children:[t.jsxs("div",{className:"mb-4 flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("h3",{className:"text-xl font-bold",children:O?"Create New Task":"Edit Task"}),t.jsx("p",{className:"text-sm text-gray-600",children:O?`Adding to: ${re()}`:`Category: ${re()}`})]}),t.jsx("button",{type:"button",onClick:r,className:"text-2xl font-bold text-gray-500 hover:text-gray-800",children:"√ó"})]}),A&&t.jsxs("div",{className:`mb-6 rounded-lg border p-4 ${N?"border-green-300 bg-green-50":"border-gray-200 bg-gray-50"}`,children:[t.jsxs("div",{className:"mb-3 flex items-center justify-between",children:[t.jsxs("label",{className:"flex cursor-pointer items-center font-semibold text-gray-700",children:[t.jsx("input",{type:"checkbox",checked:N,onChange:C=>oe(C.target.checked),className:"mr-2 h-5 w-5 cursor-pointer rounded text-green-600 focus:ring-green-500"}),t.jsx("span",{className:N?"text-green-700":"",children:N?"Task Completed":"Mark as Completed"})]}),I&&t.jsx("span",{className:"text-sm text-gray-500",children:new Date(I).toLocaleDateString()})]}),N&&t.jsxs("div",{className:"mt-3",children:[t.jsx("label",{className:"mb-1 block text-sm font-medium text-gray-700",children:"Completion Notes (optional):"}),t.jsx("textarea",{className:"w-full rounded border p-2 text-sm text-black focus:border-green-500 focus:ring-2 focus:ring-green-500",rows:3,placeholder:"Add any notes about completing this task...",value:D,onChange:C=>W(C.target.value)}),I&&t.jsxs("p",{className:"mt-1 text-xs text-gray-500",children:["Completed on ",new Date(I).toLocaleString()]})]}),A&&f&&N&&t.jsxs("div",{className:"mb-4 p-4",children:[t.jsx("button",{type:"button",onClick:ae,disabled:$.isPending,className:"w-full rounded bg-green-600 px-4 py-2 font-semibold text-white hover:bg-green-700 disabled:opacity-50",children:$.isPending?"Saving...":"Save Completed Task"}),t.jsx("p",{className:"mt-2 text-xs text-green-700",children:"Click to save task completion and create next recurring instance (if applicable)"})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"mb-1 block text-sm font-medium text-gray-700",children:"Task Name *"}),t.jsx("input",{className:"w-full rounded border border-gray-300 p-2 focus:border-blue-500 focus:ring-2 focus:ring-blue-500",value:i,onChange:C=>l(C.target.value),placeholder:"Enter task name",required:!0,disabled:N&&!f})]}),t.jsxs("div",{children:[t.jsx("label",{className:"mb-1 block text-sm font-medium text-gray-700",children:"Details"}),t.jsx("textarea",{className:"w-full rounded border border-gray-300 p-2 focus:border-blue-500 focus:ring-2 focus:ring-blue-500",rows:3,value:c,onChange:C=>m(C.target.value),placeholder:"Optional task description",disabled:N&&!f})]}),t.jsxs("div",{children:[t.jsx("label",{className:"mb-1 block text-sm font-medium text-gray-700",children:"Importance (1-10)"}),t.jsx("select",{className:"w-full rounded border border-gray-300 p-2 focus:border-blue-500 focus:ring-2 focus:ring-blue-500",value:h,onChange:C=>x(Number(C.target.value)),disabled:N&&!f,children:Array.from({length:10},(C,R)=>R+1).map(C=>t.jsxs("option",{value:C,children:["Level ",C]},C))})]}),t.jsxs("div",{children:[t.jsx("label",{className:"mb-1 block text-sm font-medium text-gray-700",children:"Deadline"}),t.jsx("input",{type:"date",className:"w-full rounded border border-gray-300 p-2 focus:border-blue-500 focus:ring-2 focus:ring-blue-500",value:B(u),onChange:C=>j(C.target.value),min:new Date().toISOString().split("T")[0],disabled:N&&!f})]}),t.jsxs("div",{children:[t.jsx("label",{className:"mb-1 block text-sm font-medium text-gray-700",children:"Estimated Completion Time (hours)"}),t.jsx("input",{type:"number",min:"0.5",step:"0.5",className:"w-full rounded border border-gray-300 p-2 focus:border-blue-500 focus:ring-2 focus:ring-blue-500",value:_,onChange:C=>d(Number(C.target.value)),placeholder:"e.g. 2.5",disabled:N&&!f})]}),t.jsxs("div",{children:[t.jsx("label",{className:"mb-1 block text-sm font-medium text-gray-700",children:"Unique Days Required"}),t.jsx("input",{type:"number",min:"0.5",step:"0.5",className:"w-full rounded border border-gray-300 p-2 focus:border-blue-500 focus:ring-2 focus:ring-blue-500",value:k,onChange:C=>S(Number(C.target.value)),placeholder:"e.g. 3",disabled:N&&!f}),t.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Number of separate days needed to complete this task"})]}),t.jsx(ir,{initialConfig:{type:b.recurrence_type,interval:b.recurrence_interval||1,dayOfWeek:b.recurrence_day_of_week,dayOfMonth:b.recurrence_day_of_month,endDate:b.recurrence_end_date},onChange:v,disabled:N&&!f,className:"border-t pt-4"}),t.jsxs("div",{className:"flex justify-between border-t pt-4",children:[A&&!(N&&!f)&&t.jsx("button",{type:"button",onClick:U,disabled:H.isPending,className:"rounded bg-red-600 px-4 py-2 text-white hover:bg-red-700 disabled:opacity-50",children:H.isPending?"Deleting...":"Delete Task"}),t.jsxs("div",{className:`${A&&!(N&&!f)?"ml-auto":""} space-x-2`,children:[t.jsx("button",{type:"button",onClick:r,className:"rounded bg-gray-300 px-4 py-2 text-white hover:bg-gray-400",children:"Cancel"}),!(N&&!f)&&t.jsx("button",{type:"submit",disabled:P.isPending||!i.trim(),className:"rounded bg-blue-600 px-4 py-2 text-white hover:bg-blue-700 disabled:opacity-50",children:P.isPending?O?"Creating...":"Saving...":O?"Create Task":"Save Changes"})]})]})]})})}const hr=()=>{const e=te();return le({mutationFn:async r=>{if(r.id){const{data:n,error:s}=await Q.from("org_nodes").update({...r,type:"category"}).eq("id",r.id).select().single();if(s)throw s;return n}else{const{data:n,error:s}=await Q.from("org_nodes").insert({...r,type:"category"}).select().single();if(s)throw s;return n}},onSuccess:r=>{e.setQueryData(M.category(r.id),r),e.invalidateQueries({queryKey:M.allOrgTrees()})},onError:r=>{console.error("‚ùå Save category error:",r)}})},it=()=>{const e=te();return le({mutationFn:async r=>{const{error:n}=await Q.from("org_nodes").delete().eq("id",r);if(n)throw n;return r},onSuccess:r=>{e.removeQueries({queryKey:M.category(r)}),e.invalidateQueries({queryKey:M.allOrgTrees()})},onError:r=>{console.error("‚ùå Delete category error:",r)}})};function ze({category:e,onCancel:r,parentId:n,parentName:s,rootCategory:o,tabName:a}){const[i,l]=g.useState(e?.name??""),c=hr(),m=it(),h=!e,x=!!e;g.useEffect(()=>{e&&l(e.name)},[e]);const u=()=>x&&e?.root_category?e.root_category:h&&s&&o?`${o} > ${s}`:"Unknown",j=d=>{d.preventDefault();const k=e?.parent_id??n,S=e?.root_category??o,N=e?.tab_name??a;if(h&&(!k||!S||!N)){console.error("‚ùå Missing required parent context for new category:",{parentId:k,rootCategory:S,tabName:N}),alert("Missing parent information. Please try again.");return}const q={id:e?.id,name:i.trim(),parent_id:k,root_category:S,tab_name:N,type:"category"};console.log("üöÄ Submitting category data:",q),c.mutate(q,{onSuccess:D=>{console.log("‚úÖ Category saved successfully:",D),r()},onError:D=>{console.error("‚ùå Failed to save category:",D),alert(`Failed to save category: ${D.message}`)}})},_=()=>{if(e?.id){if(!confirm(`Are you sure you want to delete "${e.name}"?`))return;console.log("üóëÔ∏è Deleting category:",e.id),m.mutate(e.id,{onSuccess:()=>{console.log("‚úÖ Category deleted successfully"),r()},onError:d=>{console.error("‚ùå Failed to delete category:",d),alert(`Failed to delete category: ${d.message}`)}})}};return t.jsx("div",{className:"bg-opacity-50 fixed inset-0 z-[70] flex items-center justify-center bg-black",children:t.jsxs("form",{onSubmit:j,className:"mx-4 max-h-[90vh] w-full max-w-md space-y-4 overflow-y-auto rounded-lg bg-white p-6 text-black shadow-md",children:[t.jsxs("div",{className:"mb-4 flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("h3",{className:"text-xl font-bold",children:h?"Create New Category":"Edit Category"}),t.jsx("p",{className:"text-sm text-gray-600",children:h?`Adding to: ${u()}`:`Location: ${u()}`})]}),t.jsx("button",{type:"button",onClick:r,className:"text-2xl font-bold text-gray-500 hover:text-gray-800",children:"√ó"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"mb-1 block text-sm font-medium text-gray-700",children:"Category Name *"}),t.jsx("input",{className:"w-full rounded border border-gray-300 p-2 focus:border-blue-500 focus:ring-2 focus:ring-blue-500",value:i,onChange:d=>l(d.target.value),placeholder:"Enter category name",required:!0})]}),t.jsxs("div",{className:"flex justify-between border-t pt-4",children:[x&&t.jsx("button",{type:"button",onClick:_,disabled:m.isPending,className:"rounded bg-red-600 px-4 py-2 text-white hover:bg-red-700 disabled:opacity-50",children:m.isPending?"Deleting...":"Delete Category"}),t.jsxs("div",{className:`${x?"ml-auto":""} space-x-2`,children:[t.jsx("button",{type:"button",onClick:r,className:"rounded bg-gray-300 px-4 py-2 text-white hover:bg-gray-400",children:"Cancel"}),t.jsx("button",{type:"submit",disabled:c.isPending||!i.trim(),className:"rounded bg-blue-600 px-4 py-2 text-white hover:bg-blue-700 disabled:opacity-50",children:c.isPending?h?"Creating...":"Saving...":h?"Create Category":"Save Changes"})]})]})]})})}function ye({node:e,level:r=0,onTaskClick:n,openMap:s,toggleOpen:o,path:a,disableExpand:i,isRoot:l=!1}){const c=e.type==="task",m=s[a]||!1,[h,x]=g.useState(!1),[u,j]=g.useState(!1),[_,d]=g.useState(!1),k=tt(e),S=Re(e),N=()=>x(!1),q=()=>j(!1);return it(),l?t.jsxs("div",{className:"grid auto-cols-min grid-flow-col gap-8",children:[t.jsx("h2",{className:"mb-8 text-center text-3xl font-bold text-gray-900 dark:text-gray-100",children:e.name}),e.children&&e.children.length>0?t.jsx("div",{className:"node-with-children",children:e.children.map(D=>t.jsx(ye,{node:D,level:r+1,onTaskClick:n,openMap:s,toggleOpen:o,path:`${a}/${D.name}`,disableExpand:i,isRoot:!1},D.name))}):t.jsx("div",{className:"py-12 text-center",children:t.jsx("p",{className:"text-gray-600 dark:text-gray-300",children:"No items in this category yet."})}),h&&t.jsx(ee,{parentId:e.id,parentName:e.name,rootCategory:e.root_category,tabName:e.root_category,onCancel:N}),u&&t.jsx(ze,{parentId:e.id,parentName:e.name,rootCategory:e.root_category,tabName:e.root_category,onCancel:N})]}):t.jsxs("div",{className:"flex w-full flex-col items-center",children:[t.jsxs("div",{"data-node-path":a,"data-urgency":k,className:`relative min-w-[120px] rounded-lg bg-white text-center shadow-amber-600 outline outline-gray-400 ${e.is_completed?"bg-green-50 opacity-60":""} ${Vt(S)} ${Yt(S)}`,children:[!e.is_completed&&Ce(k)&&t.jsx("div",{className:`pointer-events-none absolute z-10 rounded-full ${Wt(k)} ${Gt(k)} ${Kt(k)}`,"data-urgency-ball":a,style:{left:"50%",top:"50%",transform:"translate(-50%, -50%)"}}),c?t.jsxs("button",{className:`h-full w-full rounded-lg p-2 text-lg font-semibold underline hover:text-blue-200 focus:outline-none ${e.is_completed?"bg-green-600 text-white line-through":"bg-blue-600 text-white"}`,onClick:()=>n(e),children:[e.name,e.is_completed&&t.jsx("span",{className:"ml-2 text-xs",children:"‚úì"})]}):t.jsx("button",{className:"w-full rounded-lg bg-gray-800 p-2 text-center text-lg font-semibold text-white focus:outline-none",onClick:()=>!i&&o(a),type:"button",disabled:i,children:t.jsxs("span",{className:"flex items-center justify-center gap-2",children:[e.name,!i&&t.jsx("span",{className:"ml-1 text-gray-400",children:m?"‚ñº":"‚ñ∂"})]})})]}),!c&&m&&!i&&t.jsxs("div",{className:"mt-4 grid w-full auto-cols-min grid-flow-col gap-4",children:[e.children?.map(D=>t.jsx(ye,{node:D,level:r+1,onTaskClick:n,openMap:s,toggleOpen:o,path:`${a}/${D.name}`,disableExpand:i,isRoot:!1},D.name)),t.jsxs("div",{className:"flex gap-2",children:[t.jsx("button",{className:"flex h-8 w-8 items-center justify-center rounded-full bg-blue-600 text-xl font-bold text-white hover:bg-blue-700",onClick:()=>x(!0),title:"Add Task",type:"button",children:"+"}),t.jsx("button",{className:"flex h-8 w-8 items-center justify-center rounded-full bg-green-600 text-xl font-bold text-white hover:bg-green-700",onClick:()=>j(!0),title:"Add Category",type:"button",children:"üìÅ"}),(!e.children||e.children.length===0)&&t.jsx("button",{className:"flex h-8 w-8 items-center justify-center rounded-full bg-red-600 text-xl font-bold text-white hover:bg-red-700",onClick:()=>{d(!0)},title:"Delete Category",type:"button",children:"üóëÔ∏è"})]})]}),h&&t.jsx(ee,{parentId:e.id,parentName:e.name,rootCategory:e.root_category,tabName:e.root_category,onCancel:N}),_&&t.jsx("div",{className:"bg-opacity-50 fixed inset-0 z-[70] flex items-center justify-center bg-black",children:t.jsxs("div",{className:"mx-4 max-w-sm rounded-lg bg-white p-6 text-black",children:[t.jsx("h3",{className:"mb-4 text-lg font-bold",children:"Delete Category"}),t.jsxs("p",{className:"mb-4",children:['Are you sure you want to delete "',e.name,'"?']}),t.jsxs("div",{className:"flex justify-end gap-2",children:[t.jsx("button",{onClick:()=>d(!1),className:"rounded bg-gray-300 px-4 py-2 hover:bg-gray-400",children:"Cancel"}),t.jsx("button",{onClick:()=>{d(!1)},className:"rounded bg-red-600 px-4 py-2 text-white hover:bg-red-700",children:"Delete"})]})]})}),u&&t.jsx(ze,{parentId:e.id,parentName:e.name,rootCategory:e.root_category,tabName:e.root_category,onCancel:q})]})}function gr({currentNode:e,activePath:r,setActivePath:n,onTaskClick:s,tabName:o}){const[a,i]=g.useState(!1),l=x=>{const u=`${r}/${x.name}`;console.log(`Mobile: navigating forward to ${u}`),n(u)},c=()=>{const x=r.split("/").slice(0,-1).join("/")||`/${o}`;console.log(`Mobile: navigating back to ${x}`),n(x)},m=()=>i(!1),h=()=>{if(!r||typeof r!="string")return console.warn("MobileOrgChart: activePath is undefined or not a string:",r),o;try{return r.replace(`/${o}`,o).replace(/\//g," ‚Üí ")}catch(x){return console.error("Error generating breadcrumb:",x),o}};return r?t.jsxs("div",{className:"mx-auto flex w-full max-w-md flex-col p-4",children:[t.jsx("h2",{className:"mb-4 text-center text-2xl font-bold text-gray-900 dark:text-gray-100",children:o}),t.jsx("div",{className:"mb-2 text-sm text-gray-600 dark:text-gray-400",children:h()}),r!==`/${o}`&&t.jsx("button",{onClick:c,className:"mb-4 text-left font-semibold text-blue-600 transition-colors hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300",children:"‚Üê Back"}),e.type==="category"&&t.jsx("div",{className:"mb-4 flex justify-center",children:t.jsxs("button",{className:"flex items-center justify-center space-x-2 rounded-lg bg-blue-600 px-4 py-3 font-semibold text-white shadow-lg transition-colors hover:bg-blue-700 active:bg-blue-800",onClick:()=>i(!0),title:"Add new task or category",type:"button",children:[t.jsx("svg",{className:"h-5 w-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),t.jsx("span",{children:"Add Task"})]})}),t.jsxs("div",{className:"flex flex-col gap-4",children:[e.children?.map(x=>{const u=`${r}/${x.name}`;return t.jsxs("div",{className:"flex items-center justify-between gap-3",children:[t.jsx("div",{className:"flex-1",children:t.jsx(ye,{node:x,level:1,onTaskClick:s,openMap:{},toggleOpen:()=>{},path:u,disableExpand:!0,isRoot:!1})}),!x.is_completed&&x.children?.length?t.jsx("button",{onClick:()=>l(x),className:"flex-shrink-0 rounded border border-blue-600 px-3 py-1 text-sm text-blue-600 transition-colors hover:bg-blue-50 hover:text-blue-800 dark:border-blue-400 dark:text-blue-400 dark:hover:bg-blue-900/20 dark:hover:text-blue-300",children:"Enter ‚Üí"}):null]},u)}),!e.children?.length&&t.jsxs("div",{className:"py-8 text-center text-gray-500 dark:text-gray-400",children:["No items in this category",e.type==="category"&&t.jsx("div",{className:"mt-4",children:t.jsx("button",{className:"rounded-lg bg-blue-600 px-6 py-3 font-semibold text-white transition-colors hover:bg-blue-700",onClick:()=>i(!0),children:"Add First Task"})})]})]}),a&&t.jsx(ee,{parentId:e.id,parentName:e.name,rootCategory:e.root_category,tabName:e.root_category,onCancel:m})]}):(console.error("MobileOrgChart: activePath is required but was:",r),t.jsx("div",{className:"mx-auto flex w-full max-w-md flex-col p-4",children:t.jsx("div",{className:"py-8 text-center text-red-600",children:"Navigation error: Invalid path"})}))}const xr=(e,r)=>{const n=r.split("/").filter(Boolean);if(!n.length)return e;let s=e;for(let o=1;o<n.length;o++)if(!s?.children||(s=s.children.find(a=>a.name===n[o]),!s))return null;return s||null};function fr({tabName:e}){const r=g.useRef(null),n=at(),[s,o]=g.useState({}),[a,i]=g.useState(null),[l,c]=g.useState(`/${e}`);g.useEffect(()=>{c(`/${e}`)},[e]);const{data:m,isLoading:h,error:x}=ve({queryKey:M.orgTree(e),queryFn:()=>Me(e),placeholderData:Ye}),u=Zt(m||{},e,o);Xt({containerRef:r,tree:m||{},openMap:s,tabName:e,isMobile:n,activePath:n?l:void 0});const j=k=>i(k),_=()=>i(null);if(h)return t.jsxs("div",{className:"py-8 text-center text-gray-900 dark:text-gray-100",children:["Loading ",e," tree..."]});if(x)return t.jsxs("div",{className:"py-8 text-center text-red-600 dark:text-red-400",children:["Error loading ",e," tree"]});if(!m)return t.jsx("div",{className:"py-8 text-center text-gray-900 dark:text-gray-100",children:"No data found"});const d=n?xr(m,l):null;return t.jsxs(t.Fragment,{children:[t.jsx("div",{ref:r,className:"relative flex h-full w-full items-start p-4",children:n?d&&l?t.jsx(gr,{root:m,currentNode:d,activePath:l,setActivePath:c,onTaskClick:j,tabName:e}):t.jsxs("div",{className:"py-8 text-center text-red-600",children:["Navigation error: Node not found",t.jsxs("div",{className:"mt-2 text-sm",children:["Tab: ",e,", Path: ",l||"undefined"]})]}):t.jsx(ye,{node:m,level:0,onTaskClick:j,openMap:s,toggleOpen:u,path:`/${e}`,isRoot:!0})}),a&&t.jsx(ee,{task:a,onCancel:_})]})}function pr({isOpen:e,onClose:r}){const[n,s]=g.useState("add"),[o,a]=g.useState([]),[i,l]=g.useState([]),[c,m]=g.useState(!0),[h,x]=g.useState(null),[u,j]=g.useState(""),[_,d]=g.useState(!1),[k,S]=g.useState(""),[N,q]=g.useState(null),D=u?o.find(w=>w.id===u):null,W=(w,$)=>{const O=[w.name];let A=w;for(;A.parent_id;){const L=$.find(E=>E.id===A.parent_id);if(L)O.unshift(L.name),A=L;else break}return O.join(" > ")},I=async()=>{try{m(!0),x(null);const{data:w,error:$}=await Q.from("org_nodes").select("*").order("root_category, name");if($)throw $;const O=w,A=O.filter(E=>E.type==="category").map(E=>({id:E.id,name:E.name,type:E.type,root_category:E.root_category,path:W(E,O)})),L=O.filter(E=>E.type==="task").map(E=>({id:E.id,name:E.name,type:E.type,root_category:E.root_category,path:W(E,O)}));a(A),l(L)}catch(w){console.error("Error fetching data:",w),x(w instanceof Error?w.message:"Failed to load data")}finally{m(!1)}},G=async w=>{try{const{data:$,error:O}=await Q.from("org_nodes").select("*").eq("id",w).single();if(O)throw O;q($)}catch($){console.error("Error loading task:",$),x("Failed to load task data")}},b=w=>{s(w),j(""),S(""),d(!1),q(null)},v=w=>{j(w),d(!!w)},P=async w=>{S(w),w==="new"?(d(!1),q(null)):typeof w=="number"?await G(w):(q(null),d(!1))},H=()=>{q(null),S(""),I(),r()};return g.useEffect(()=>{e&&I()},[e]),e?t.jsxs("div",{className:"bg-opacity-50 fixed inset-0 z-[60] overflow-y-auto bg-black",children:[t.jsx("div",{className:"flex min-h-screen items-start justify-center px-4 py-6",children:t.jsxs("div",{className:"mx-auto w-full max-w-md rounded-lg bg-white shadow-xl dark:bg-gray-800",children:[t.jsxs("div",{className:"flex items-center justify-between border-b border-gray-200 p-6 dark:border-gray-600",children:[t.jsx("h2",{className:"text-xl font-bold text-gray-900 dark:text-gray-100",children:"Quick Task Manager"}),t.jsx("button",{onClick:r,className:"text-2xl font-bold text-gray-400 hover:text-gray-600 dark:text-gray-300 dark:hover:text-gray-100","aria-label":"Close",children:"√ó"})]}),t.jsx("div",{className:"border-b border-gray-200 p-6 dark:border-gray-600",children:t.jsxs("div",{className:"flex space-x-1 rounded-lg bg-gray-100 p-1 dark:bg-gray-700",children:[t.jsx("button",{type:"button",onClick:()=>b("add"),className:`flex-1 rounded-md px-4 py-2 text-sm font-medium transition-colors ${n==="add"?"bg-white text-blue-600 shadow-sm dark:bg-gray-600 dark:text-blue-400":"text-gray-600 hover:text-gray-900 dark:text-gray-300 dark:hover:text-gray-100"}`,children:"Add Task"}),t.jsx("button",{type:"button",onClick:()=>b("edit"),className:`flex-1 rounded-md px-4 py-2 text-sm font-medium transition-colors ${n==="edit"?"bg-white text-blue-600 shadow-sm dark:bg-gray-600 dark:text-blue-400":"text-gray-600 hover:text-gray-900 dark:text-gray-300 dark:hover:text-gray-100"}`,children:"Edit Task"})]})}),c&&t.jsxs("div",{className:"p-8 text-center",children:[t.jsx("div",{className:"mx-auto mb-4 h-8 w-8 animate-spin rounded-full border-b-2 border-blue-600"}),t.jsx("p",{className:"text-gray-600 dark:text-gray-300",children:"Loading..."})]}),h&&t.jsx("div",{className:"border-l-4 border-red-400 bg-red-50 p-4 text-sm text-red-700 dark:bg-red-900/20 dark:text-red-300",children:h}),!c&&t.jsxs("div",{className:"space-y-4 p-6",children:[n==="add"&&t.jsxs(t.Fragment,{children:[t.jsxs("div",{children:[t.jsx("label",{className:"mb-2 block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Add to Category *"}),t.jsxs("select",{value:u,onChange:w=>v(w.target.value?Number(w.target.value):""),className:"w-full rounded-lg border border-gray-300 bg-white p-3 text-gray-900 focus:border-blue-500 focus:ring-2 focus:ring-blue-500 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-100",children:[t.jsx("option",{value:"",children:"Select a category..."}),o.map(w=>t.jsx("option",{value:w.id,children:w.path},w.id))]})]}),!u&&t.jsx("p",{className:"text-sm text-gray-500 italic dark:text-gray-400",children:"Select a category above to add a new task"})]}),n==="edit"&&t.jsxs(t.Fragment,{children:[t.jsxs("div",{children:[t.jsx("label",{className:"mb-2 block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Select Task *"}),t.jsxs("select",{value:k,onChange:w=>{const $=w.target.value;P($==="new"?"new":$===""?"":Number($))},className:"w-full rounded-lg border border-gray-300 bg-white p-3 text-gray-900 focus:border-blue-500 focus:ring-2 focus:ring-blue-500 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-100",children:[t.jsx("option",{value:"",children:"Choose an option..."}),t.jsx("option",{value:"new",children:"Create New Task"}),t.jsx("optgroup",{label:"Existing Tasks",children:i.map(w=>t.jsx("option",{value:w.id,children:w.path},w.id))})]})]}),k==="new"&&t.jsxs("div",{children:[t.jsx("label",{className:"mb-2 block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Add to Category *"}),t.jsxs("select",{value:u,onChange:w=>v(w.target.value?Number(w.target.value):""),className:"w-full rounded-lg border border-gray-300 bg-white p-3 text-gray-900 focus:border-blue-500 focus:ring-2 focus:ring-blue-500 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-100",children:[t.jsx("option",{value:"",children:"Select a category..."}),o.map(w=>t.jsx("option",{value:w.id,children:w.path},w.id))]})]}),!k&&t.jsx("p",{className:"text-sm text-gray-500 italic dark:text-gray-400",children:"Select a task above to edit, or create a new one"})]})]})]})}),_&&D&&t.jsx(ee,{parentId:u,parentName:D.name,rootCategory:D.root_category,tabName:D.root_category,onCancel:()=>{d(!1),j("")}}),N&&t.jsx(ee,{task:N,onCancel:H})]}):null}function lt({icon:e,title:r,description:n,action:s}){const o=t.jsx("svg",{fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",className:"w-full h-full",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})});return t.jsxs("div",{className:"text-center py-12",children:[t.jsx("div",{className:"mx-auto h-24 w-24 text-gray-400 mb-4",children:e||o}),t.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:r}),n&&t.jsx("p",{className:"text-gray-600 mb-4",children:n}),s]})}function ct({tasks:e}){const r=e.filter(o=>o.urgencyLevel>=7).length,n=e.filter(o=>(o.importance||1)>=7).length,s=e.reduce((o,a)=>o+(a.completion_time||0),0);return t.jsx("div",{className:"mb-6",children:t.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[t.jsxs("div",{className:"bg-red-50 p-4 rounded border-l-4 border-red-500",children:[t.jsx("div",{className:"text-sm text-red-700",children:"High Urgency"}),t.jsx("div",{className:"text-2xl font-bold text-red-800",children:r})]}),t.jsxs("div",{className:"bg-purple-50 p-4 rounded border-l-4 border-purple-500",children:[t.jsx("div",{className:"text-sm text-purple-700",children:"High Importance"}),t.jsx("div",{className:"text-2xl font-bold text-purple-800",children:n})]}),t.jsxs("div",{className:"bg-gray-50 p-4 rounded border-l-4 border-gray-500",children:[t.jsx("div",{className:"text-sm text-gray-700",children:"Total Time"}),t.jsxs("div",{className:"text-2xl font-bold text-gray-800",children:[s.toFixed(1),"h"]})]})]})})}function yr({task:e,onClick:r}){const n=i=>i<=3?{dot:"bg-green-400",text:"text-green-600"}:i<=6?{dot:"bg-yellow-400",text:"text-yellow-600"}:i<=8?{dot:"bg-orange-400",text:"text-orange-600"}:{dot:"bg-red-500",text:"text-red-600"},s=i=>i<=3?{dot:"bg-gray-300",text:"text-gray-600"}:i<=6?{dot:"bg-blue-400",text:"text-blue-600"}:i<=8?{dot:"bg-purple-400",text:"text-purple-600"}:{dot:"bg-purple-600",text:"text-purple-800"},o=n(e.urgencyLevel),a=s(e.importance||1);return t.jsx("div",{className:"bg-white rounded-lg border border-gray-200 p-4 hover:bg-gray-50 cursor-pointer transition-colors shadow-sm",onClick:()=>r(e),children:t.jsxs("div",{className:"flex items-start justify-between",children:[t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsx("h3",{className:"font-semibold text-gray-900 hover:text-blue-600 transition-colors",children:e.name}),e.details&&t.jsx("p",{className:"text-sm text-gray-600 mt-1 line-clamp-2",children:e.details}),t.jsxs("div",{className:"flex items-center space-x-4 mt-2",children:[t.jsx("span",{className:"inline-block bg-blue-100 text-blue-800 text-xs px-2 py-1 rounded",children:e.root_category}),e.completion_time&&t.jsxs("span",{className:"text-xs text-gray-500",children:[e.completion_time,"h estimated"]})]})]}),t.jsxs("div",{className:"flex flex-col items-end space-y-2 ml-4",children:[t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx("span",{className:`inline-block w-3 h-3 rounded-full ${o.dot}`}),t.jsxs("span",{className:`text-xs font-medium ${o.text}`,children:["U",e.urgencyLevel]})]}),t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx("span",{className:`inline-block w-3 h-3 rounded-full ${a.dot}`}),t.jsxs("span",{className:`text-xs font-medium ${a.text}`,children:["I",e.importance||1]})]})]})]})})}function br(e){const r=new Date().toISOString().split("T")[0],n=new Date(r),s=[],o=a=>{a.type==="task"&&a.deadline&&!a.is_completed&&new Date(a.deadline)<=n&&s.push(a),a.children&&a.children.forEach(o)};return e.forEach(o),console.log(`Collected ${s.length} tasks due today/overdue from ${e.length} org trees`),s}function vr(e){return e.map(r=>({...r,urgencyLevel:we(r.deadline,r.completion_time,r.unique_days_required),daysUntilDeadline:r.deadline?Ue(r.deadline):0,isOverdue:r.deadline?Ue(r.deadline)<0:!1}))}function Ue(e){const r=new Date,s=new Date(e).getTime()-r.getTime();return Math.ceil(s/(1e3*60*60*24))}const wr={byUrgencyThenImportance:(e,r)=>r.urgencyLevel!==e.urgencyLevel?r.urgencyLevel-e.urgencyLevel:(r.importance||1)-(e.importance||1)},jr=["Household","Finances","Cleo","Job","Social","Personal","Orphans"];function kr({isOpen:e,onClose:r}){const[n,s]=g.useState(null),o=te(),a=Xe({queries:jr.map(u=>({queryKey:M.orgTree(u),queryFn:()=>Me(u),enabled:e,staleTime:300*1e3}))});if(!e)return null;const i=a.some(u=>u.isLoading),l=a.some(u=>u.error);if(i)return t.jsx("div",{className:"bg-opacity-50 fixed inset-0 z-50 flex items-center justify-center bg-black",children:t.jsx("div",{className:"rounded-lg bg-white p-8",children:t.jsxs("div",{className:"flex items-center space-x-3",children:[t.jsx("div",{className:"h-6 w-6 animate-spin rounded-full border-b-2 border-blue-600"}),t.jsx("span",{children:"Loading tasks from all categories..."})]})})});if(l)return t.jsx("div",{className:"bg-opacity-50 fixed inset-0 z-50 flex items-center justify-center bg-black",children:t.jsx("div",{className:"rounded-lg bg-white p-8",children:t.jsx("div",{className:"text-red-600",children:"Error loading tasks. Please try again."})})});const c=a.filter(u=>u.data&&u.isSuccess).map(u=>u.data);console.log(`Found ${c.length} org tree roots from all tabs`);const m=vr(br(c)).sort(wr.byUrgencyThenImportance);console.log(`Found ${m.length} tasks due today/overdue across all tabs`);const h=()=>{s(null),o.invalidateQueries({queryKey:M.allOrgTrees()})},x=new Date().toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"});return t.jsx("div",{className:"bg-opacity-50 fixed inset-0 z-50 flex items-start justify-center bg-black pt-10",children:t.jsxs("div",{className:"mx-4 max-h-[calc(90vh-2.5rem)] w-full max-w-4xl overflow-y-auto rounded-lg bg-white p-6 shadow-lg",children:[t.jsxs("div",{className:"mb-6 flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:"Tasks Due Today & Overdue"}),t.jsxs("p",{className:"text-sm text-gray-600",children:[x," ‚Ä¢ ",m.length," task",m.length!==1?"s":""," due or overdue across all categories"]})]}),t.jsx("button",{onClick:r,className:"text-2xl font-bold text-gray-500 transition-colors hover:text-gray-800","aria-label":"Close",children:"√ó"})]}),m.length===0&&t.jsx(lt,{title:"No tasks due today!",description:"Great job staying on top of your schedule. Enjoy your day!"}),m.length>0&&t.jsxs(t.Fragment,{children:[t.jsx(ct,{tasks:m}),t.jsxs("div",{children:[t.jsxs("h3",{className:"mb-4 text-lg font-semibold text-gray-800",children:["Today's Tasks & Overdue Items",t.jsx("span",{className:"ml-2 text-sm font-normal text-gray-600",children:"(Click any task to edit)"})]}),t.jsx("div",{className:"space-y-3",children:m.map(u=>t.jsx(yr,{task:u,onClick:s},u.id))})]})]}),n&&t.jsx(ee,{task:n,onCancel:h})]})})}const be=["Household","Finances","Cleo","Job","Social","Personal","Orphans"];function Nr(){return Xe({queries:be.map(r=>({queryKey:M.criticalTaskCount(r),queryFn:async()=>{const{data:n,error:s}=await Q.from("org_nodes").select("deadline, completion_time, unique_days_required").eq("type","task").eq("root_category",r).not("deadline","is",null).not("completion_time","is",null).not("unique_days_required","is",null).not("is_completed","is",!0);if(s)throw s;return(n||[]).reduce((a,i)=>we(i.deadline,i.completion_time,i.unique_days_required)===10?a+1:a,0)},staleTime:12e4,gcTime:3e5})),combine:r=>{const n={},s=r.some(a=>a.isLoading),o=r.some(a=>a.error);return r.forEach((a,i)=>{n[be[i]]=a.data||0}),{counts:n,isLoading:s,hasError:o}}}).counts}function dt({activeTab:e,variant:r="desktop",onTabClick:n}){const s=Nr();return r==="mobile"?t.jsx("div",{className:"flex flex-col gap-2",children:be.map(o=>{const a=s[o]||0,i=e===o;return t.jsxs(pe,{to:`/org-chart/${o}`,onClick:n,className:`flex items-center justify-between rounded-lg px-4 py-3 text-base font-medium transition-all ${i?"bg-blue-600 text-white dark:bg-blue-700":"text-gray-300 hover:bg-gray-800/60 hover:text-white dark:hover:bg-gray-700/60"}`,children:[t.jsx("span",{children:o}),a>0&&t.jsx("span",{className:"flex h-6 min-w-[24px] items-center justify-center rounded-full bg-red-500 px-2 text-xs font-bold text-white",children:a>99?"99+":a})]},o)})}):t.jsx("div",{className:"flex items-center gap-1",children:be.map(o=>{const a=s[o]||0,i=e===o;return t.jsxs(pe,{to:`/org-chart/${o}`,onClick:n,className:`relative flex items-center gap-2 rounded-lg px-4 py-2.5 text-sm font-semibold transition-all ${i?"bg-blue-600/20 text-blue-400 shadow-inner dark:bg-blue-700/30 dark:text-blue-300":"text-gray-300 hover:bg-gray-800/60 hover:text-white dark:hover:bg-gray-700/60"}`,children:[t.jsx("span",{children:o}),a>0&&t.jsx("span",{className:"flex h-5 min-w-[20px] items-center justify-center rounded-full bg-red-500 px-1.5 text-[10px] font-bold text-white shadow-sm",children:a>99?"99+":a}),i&&t.jsx("span",{className:"absolute bottom-0 left-1/2 h-0.5 w-3/4 -translate-x-1/2 rounded-full bg-blue-400 dark:bg-blue-300"})]},o)})})}async function _r(){const{data:e,error:r}=await Q.from("org_nodes").select("*").eq("type","task").not("is_completed","is",!0).order("last_touched_at",{ascending:!1}).limit(10);return e}function ut(){return ve({queryKey:M.recentTasks(),queryFn:_r,staleTime:1e3*60})}function Cr({isOpen:e,onClose:r,activeTab:n,onRecentTaskClick:s}){const{data:o,isLoading:a}=ut(),i=l=>{s?.(l),r()};return e?t.jsxs("div",{className:"fixed inset-0 z-50 lg:hidden",children:[t.jsx("div",{className:"bg-opacity-50 fixed inset-0 bg-black",onClick:r}),t.jsxs("div",{className:"fixed top-0 left-0 h-full w-80 transform bg-gray-900 shadow-xl transition-transform dark:bg-gray-800",children:[t.jsxs("div",{className:"flex items-center justify-between border-b border-gray-700 p-4",children:[t.jsx("h2",{className:"text-lg font-semibold text-white",children:"Navigation"}),t.jsx("button",{onClick:r,className:"text-2xl text-gray-400 hover:text-white","aria-label":"Close menu",children:"√ó"})]}),t.jsxs("div",{className:"p-4",children:[t.jsx(pe,{to:"/",className:"mb-2 block rounded px-4 py-3 text-gray-300 transition-colors hover:bg-gray-800 hover:text-white",onClick:r,children:"‚Üê Home"}),t.jsxs("div",{className:"mt-4 border-t border-gray-700 pt-4",children:[t.jsx("h3",{className:"mb-3 text-sm font-medium tracking-wide text-gray-400 uppercase",children:"Categories"}),t.jsx(dt,{activeTab:n,variant:"mobile",onTabClick:r})]}),s&&t.jsxs("div",{className:"mt-4 border-t border-gray-700 pt-4",children:[t.jsx("h3",{className:"mb-3 text-sm font-medium tracking-wide text-gray-400 uppercase",children:"Recent Tasks"}),a&&t.jsx("div",{className:"flex items-center justify-center py-4",children:t.jsx("div",{className:"h-5 w-5 animate-spin rounded-full border-b-2 border-blue-600"})}),!a&&(!o||o.length===0)&&t.jsx("p",{className:"px-4 py-2 text-sm text-gray-500",children:"No recent tasks yet"}),!a&&o&&o.length>0&&t.jsx("div",{className:"space-y-1",children:o.map(l=>t.jsxs("button",{onClick:()=>i(l),className:"w-full rounded px-4 py-2 text-left text-sm text-gray-300 transition-colors hover:bg-gray-800 hover:text-white",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("span",{className:"truncate",children:l.name}),l.importance&&l.importance>=8&&t.jsx("span",{className:"ml-2 text-purple-400",children:"‚òÖ"})]}),t.jsx("div",{className:"mt-0.5 text-xs text-gray-500",children:l.root_category})]},l.id))})]})]})]})]}):null}function Sr(e,r){const n=new Date,s=e==="28-days"?new Date(n.getTime()+672*60*60*1e3):r?new Date(r):new Date(n.getTime()+672*60*60*1e3);return{startDate:n,endDate:s}}function Tr(e,r){if(r==="All levels")return!0;const n=e||1;return{1:o=>o===1,"2-4":o=>o>=2&&o<=4,"5-6":o=>o>=5&&o<=6,"7-9":o=>o>=7&&o<=9,10:o=>o===10,"All levels":()=>!0}[r](n)}function Dr(e,r){const n=r.getTime()-e.getTime();return Math.ceil(n/(1e3*60*60*24))/7*25}function Qe(e){const r=new Date,s=new Date(e).getTime()-r.getTime();return Math.ceil(s/(1e3*60*60*24))}function Be(e){return e<=.5?"text-green-600":e<=.8?"text-yellow-600":e<=1?"text-orange-600":"text-red-600"}function Er(e){return e<=.5?"Light load":e<=.8?"Moderate load":e<=1?"Heavy load":"Overloaded"}function Rr(e){return e.toISOString().split("T")[0]}function mt(e){return e.map(r=>({...r,daysUntilDeadline:r.deadline?Qe(r.deadline):0,isOverdue:r.deadline?Qe(r.deadline)<0:!1})).sort((r,n)=>r.daysUntilDeadline-n.daysUntilDeadline)}function Mr(e,r,n){let s=0;const o=[],a=[];return e.forEach(i=>{if(!i.deadline||!i.completion_time)return;const l=new Date(i.deadline),c=new Date,m=Math.ceil((l.getTime()-c.getTime())/(1e3*60*60*24));if(l<=n)s+=i.completion_time,o.push(i);else{const x=i.completion_time/m*r;s+=x,a.push({task:i,partialTime:x,totalTime:i.completion_time})}}),{totalRequiredTime:s,tasksInWindow:o,tasksWithPartialTime:a}}function Or(e,r){const n=[...e,...r.map(o=>o.task)];return mt(n).map(o=>{const a=r.find(i=>i.task.id===o.id);return{...o,isPartialTime:!!a,partialRequiredTime:a?.partialTime,effectiveRequiredTime:a?a.partialTime:o.completion_time||0}})}async function $r(){const{data:e,error:r}=await Q.from("org_nodes").select("*").eq("type","task").not("deadline","is",null).not("is_completed","is",!0);if(r)throw r;return mt(e).map(o=>({...o,urgencyLevel:we(o.deadline,o.completion_time,o.unique_days_required)})).sort((o,a)=>o.isOverdue&&!a.isOverdue?-1:!o.isOverdue&&a.isOverdue?1:o.isOverdue&&a.isOverdue?a.daysUntilDeadline-o.daysUntilDeadline:o.daysUntilDeadline-a.daysUntilDeadline)}function Ar(e=!0){const{data:r=[],isLoading:n,error:s,refetch:o}=ve({queryKey:["allTasks"],queryFn:$r,enabled:e,staleTime:3e5,gcTime:18e5});return{tasks:r,isLoading:n,error:s?.message||null,refetch:o,reload:o}}function Lr({tasks:e,onTaskSelect:r}){return t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"min-w-full border border-gray-200",children:[t.jsx("thead",{className:"bg-gray-50",children:t.jsx("tr",{children:["Task","Category","Deadline","Days Left","Time Required","Unique Days","Urgency","Importance"].map(n=>t.jsx("th",{className:"px-3 py-2 text-left text-sm font-medium text-gray-700",children:n},n))})}),t.jsx("tbody",{children:e.map((n,s)=>t.jsxs("tr",{className:`${s%2===0?"bg-gray-50":"bg-white"} ${n.isOverdue?"bg-red-50":""} hover:bg-blue-50 cursor-pointer transition-colors`,onClick:()=>r(n),title:"Click to view/edit task details",children:[t.jsxs("td",{className:"px-3 py-2 text-sm",children:[t.jsx("div",{className:"font-medium text-gray-800 hover:text-blue-600",children:n.name}),n.details&&t.jsx("div",{className:"text-xs text-gray-500 mt-1 max-w-xs truncate",title:n.details,children:n.details})]}),t.jsx("td",{className:"px-3 py-2 text-sm text-gray-600",children:t.jsx("span",{className:"inline-block bg-blue-100 text-blue-800 text-xs px-2 py-1 rounded",children:n.root_category})}),t.jsx("td",{className:"px-3 py-2 text-sm text-gray-600",children:n.deadline?new Date(n.deadline).toLocaleDateString():"No deadline"}),t.jsx("td",{className:`px-3 py-2 text-sm font-medium ${n.isOverdue?"text-red-600":n.daysUntilDeadline<=7?"text-orange-600":n.daysUntilDeadline<=30?"text-yellow-600":"text-gray-600"}`,children:n.isOverdue?`${Math.abs(n.daysUntilDeadline)} overdue`:`${n.daysUntilDeadline} days`}),t.jsxs("td",{className:"px-3 py-2 text-sm text-gray-600",children:[n.completion_time?.toFixed(1)||0,"h"]}),t.jsx("td",{className:"px-3 py-2 text-sm text-gray-600",children:n.unique_days_required?.toFixed(1)||0}),t.jsx("td",{className:"px-3 py-2 text-sm",children:t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx("span",{className:`inline-block w-3 h-3 rounded-full ${n.urgencyLevel<=3?"bg-green-400":n.urgencyLevel<=6?"bg-yellow-400":n.urgencyLevel<=8?"bg-orange-400":"bg-red-500"}`}),t.jsxs("span",{className:"text-xs font-medium",children:["Level ",n.urgencyLevel]})]})}),t.jsx("td",{className:"px-3 py-2 text-sm",children:t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx("span",{className:`inline-block w-3 h-3 rounded-full ${(n.importance||1)<=3?"bg-gray-300":(n.importance||1)<=6?"bg-blue-400":(n.importance||1)<=8?"bg-purple-400":"bg-purple-600"}`}),t.jsxs("span",{className:"text-xs font-medium",children:["Level ",n.importance||1]})]})})]},n.id))})]})})}function qr(){return t.jsx("div",{className:"text-center py-8",children:t.jsxs("div",{className:"inline-flex items-center space-x-2 text-gray-600",children:[t.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-blue-600"}),t.jsx("span",{children:"Loading tasks..."})]})})}function Ir({error:e,onClick:r}){return t.jsxs("div",{className:"text-center py-8 text-red-600",children:[t.jsxs("p",{className:"mt-2",children:["Error: ",e]}),t.jsx("button",{onClick:()=>r(),className:"mt-2 px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700",children:"Try Again"})]})}function Pr({isOpen:e,onClose:r}){const{tasks:n=[],isLoading:s,error:o,reload:a}=Ar(e),[i,l]=g.useState(null),c=()=>{l(null),a()};return e?t.jsx("div",{className:"bg-opacity-50 fixed inset-0 z-50 flex items-start justify-center bg-black pt-20",children:t.jsxs("div",{className:"mx-4 max-h-[calc(90vh-5rem)] w-full max-w-6xl overflow-y-auto rounded-lg bg-white p-6 shadow-lg",children:[t.jsxs("div",{className:"mb-4 flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:"Complete Task List"}),t.jsxs("p",{className:"text-sm text-gray-600",children:["All tasks sorted by deadline ‚Ä¢ Total: ",n.length," tasks"]})]}),t.jsx("button",{onClick:r,className:"text-2xl font-bold text-gray-500 hover:text-gray-800",children:"√ó"})]}),s&&t.jsx(qr,{}),o&&t.jsx(Ir,{error:o,onClick:()=>a()}),!s&&!o&&n.length===0&&t.jsx(lt,{title:"No tasks found with deadlines"}),!s&&!o&&n.length>0&&t.jsxs(t.Fragment,{children:[t.jsx(ct,{tasks:n}),t.jsxs("div",{children:[t.jsx("h3",{className:"mb-3 text-lg font-semibold text-gray-800",children:"Task Details"}),t.jsx("p",{className:"mb-3 text-sm text-gray-600",children:"Click on any task to view or edit its details"}),t.jsx(Lr,{tasks:n,onTaskSelect:l})]})]}),i&&t.jsx(ee,{task:i,onCancel:c})]})}):null}function Fr(){const[e,r]=g.useState({totalRequiredTime:0,totalAvailableTime:0,taskCount:0,ratio:0,tasks:[]}),[n,s]=g.useState(!0),[o,a]=g.useState(null),[i,l]=g.useState(!1),[c,m]=g.useState(!1),[h,x]=g.useState("28-days"),[u,j]=g.useState(""),[_,d]=g.useState("All levels"),k=async()=>{try{s(!0),a(null);const{startDate:v,endDate:P}=Sr(h,u),H=Math.ceil((P.getTime()-v.getTime())/(1e3*60*60*24)),{data:w,error:$}=await Q.from("org_nodes").select("*").eq("type","task").gte("deadline",v.toISOString().split("T")[0]).not("deadline","is",null).not("completion_time","is",null).not("is_completed","is",!0);if($)throw $;const O=w.filter(ae=>Tr(ae.importance,_)),{totalRequiredTime:A,tasksInWindow:L,tasksWithPartialTime:E}=Mr(O,H,P),f=Dr(v,P),Y=f>0?A/f:0,oe=Or(L,E);r({totalRequiredTime:A,totalAvailableTime:f,taskCount:O.length,ratio:Y,tasks:oe})}catch(v){console.error("Error fetching time report data:",v),a(v instanceof Error?v.message:"An error occurred")}finally{s(!1)}};if(g.useEffect(()=>{k()},[h,u,_]),n)return t.jsxs("div",{className:"flex items-center space-x-2 text-sm text-white",children:[t.jsx("div",{className:"h-4 w-4 animate-spin rounded-full border-b-2 border-white"}),t.jsx("span",{children:"Loading..."})]});if(o)return t.jsxs("div",{className:"text-sm text-red-400",children:["Error: ",o]});const S=()=>t.jsxs("div",{className:"flex flex-col",children:[t.jsx("label",{className:"text-xs text-gray-300",children:"Time Window:"}),t.jsxs("select",{className:"rounded border-gray-600 bg-gray-700 px-2 py-1 text-xs text-white",value:h,onChange:v=>x(v.target.value),children:[t.jsx("option",{value:"28-days",children:"Next 28 days"}),t.jsx("option",{value:"custom",children:"Custom date"})]}),h==="custom"&&t.jsx("input",{type:"date",className:"mt-1 rounded border border-gray-600 bg-gray-700 px-2 py-1 text-xs text-white",value:u,onChange:v=>j(v.target.value),min:Rr(new Date)})]}),N=()=>t.jsxs("div",{className:"flex flex-col",children:[t.jsx("label",{className:"text-xs text-gray-300",children:"Importance:"}),t.jsxs("select",{className:"rounded border border-gray-600 bg-gray-700 px-2 py-1 text-xs text-white",value:_,onChange:v=>d(v.target.value),children:[t.jsx("option",{value:"All levels",children:"All levels"}),t.jsx("option",{value:"1",children:"Level 1"}),t.jsx("option",{value:"2-4",children:"Levels 2-4"}),t.jsx("option",{value:"5-6",children:"Levels 5-6"}),t.jsx("option",{value:"7-9",children:"Levels 7-9"}),t.jsx("option",{value:"10",children:"Level 10"})]})]}),q=()=>t.jsxs("button",{onClick:()=>l(!0),className:"flex flex-col rounded border-l border-gray-600 p-2 pl-4 transition-colors hover:bg-gray-800",children:[t.jsx("div",{className:"text-xs text-gray-300",children:"Time Analysis:"}),t.jsxs("div",{className:"flex items-center",children:[t.jsxs("div",{className:`font-bold ${Be(e.ratio)}`,children:[(e.ratio*100).toFixed(1),"%"]}),t.jsxs("div",{className:"text-xs text-gray-400",children:["(",e.totalRequiredTime.toFixed(1),"h /"," ",e.totalAvailableTime.toFixed(1),"h)"]})]}),t.jsxs("div",{className:"text-xs text-gray-400",children:[e.taskCount," tasks ‚Ä¢ ",Er(e.ratio)]})]}),D=()=>t.jsx("button",{onClick:()=>m(!0),className:"text-gray-400 transition-colors hover:text-white",title:"View all tasks",children:t.jsx("svg",{className:"h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-3 7h3m-3 4h3m-6-4h.01M9 16h.01"})})}),W=()=>t.jsx("button",{onClick:k,className:"text-gray-400 transition-colors hover:text-white",title:"Refresh report",children:t.jsx("svg",{className:"h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})}),I=()=>{const v=[{label:"Total Required Time",value:`${e.totalRequiredTime.toFixed(1)}h`,color:"text-gray-800"},{label:"Available Time",value:`${e.totalAvailableTime.toFixed(1)}h`,color:"text-gray-800"},{label:"Utilization",value:`${(e.ratio*100).toFixed(1)}%`,color:Be(e.ratio).replace("text-","text-")},{label:"Task Count",value:`${e.taskCount}`,color:"text-gray-800"}];return t.jsx("div",{className:"grid grid-cols-2 gap-4 sm:grid-cols-4",children:v.map((P,H)=>t.jsxs("div",{className:"rounded bg-gray-100 p-4",children:[t.jsx("div",{className:"text-sm text-gray-600",children:P.label}),t.jsx("div",{className:`text-xl font-bold ${P.color} sm:text-2xl`,children:P.value})]},H))})},G=()=>t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"min-w-full border border-gray-200",children:[t.jsx("thead",{className:"bg-gray-50",children:t.jsx("tr",{children:["Task","Deadline","Days Left","Time Required","Effective Time","Importance","Category"].map(v=>t.jsx("th",{className:"px-4 py-2 text-left text-sm font-medium text-gray-700",children:v},v))})}),t.jsx("tbody",{children:e.tasks.map((v,P)=>t.jsxs("tr",{className:P%2===0?"bg-gray-50":"bg-white",children:[t.jsxs("td",{className:"px-4 py-2 text-sm text-gray-800",children:[v.name,v.isPartialTime&&t.jsx("span",{className:"ml-2 text-xs font-medium text-blue-600",children:"(Partial)"})]}),t.jsx("td",{className:"px-4 py-2 text-sm text-gray-600",children:v.deadline?new Date(v.deadline).toLocaleDateString():"No deadline"}),t.jsx("td",{className:`px-4 py-2 text-sm ${v.isOverdue?"font-bold text-red-600":v.daysUntilDeadline<=7?"text-orange-600":"text-gray-600"}`,children:v.isOverdue?`${Math.abs(v.daysUntilDeadline)} overdue`:`${v.daysUntilDeadline} days`}),t.jsxs("td",{className:"px-4 py-2 text-sm text-gray-600",children:[v.completion_time?.toFixed(1)||0,"h"]}),t.jsxs("td",{className:"px-4 py-2 text-sm text-gray-600",children:[t.jsxs("span",{className:v.isPartialTime?"font-medium text-blue-600":"",children:[v.effectiveRequiredTime?.toFixed(1)||v.completion_time?.toFixed(1)||0,"h"]}),v.isPartialTime&&t.jsxs("div",{className:"text-xs text-gray-500",children:["(",((v.partialRequiredTime||0)/(v.completion_time||1)*100).toFixed(1),"% of total)"]})]}),t.jsxs("td",{className:"px-4 py-2 text-sm text-gray-600",children:["Level ",v.importance||1]}),t.jsx("td",{className:"px-4 py-2 text-sm text-gray-600",children:v.root_category})]},v.id))})]})}),b=()=>t.jsx("div",{className:"bg-opacity-50 fixed inset-0 z-50 flex items-start justify-center bg-black p-4 pt-8",children:t.jsxs("div",{className:"mx-auto max-h-[90vh] w-full max-w-6xl overflow-y-auto rounded-lg bg-white shadow-lg",children:[t.jsxs("div",{className:"sticky top-0 z-10 flex items-center justify-between border-b border-gray-200 bg-white px-6 py-4",children:[t.jsx("h2",{className:"text-xl font-bold text-gray-800 sm:text-2xl",children:"Time Availability Report"}),t.jsx("button",{onClick:()=>l(!1),className:"text-2xl font-bold text-gray-500 hover:text-gray-800","aria-label":"Close modal",children:"√ó"})]}),t.jsxs("div",{className:"space-y-6 p-6",children:[t.jsx(I,{}),t.jsxs("div",{children:[t.jsx("h3",{className:"mb-3 text-lg font-semibold text-gray-800",children:"Task Breakdown"}),t.jsx(G,{})]})]})]})});return t.jsxs(t.Fragment,{children:[t.jsx("aside",{className:"aside",children:t.jsxs("div",{className:"flex flex-col items-center space-y-2 text-sm text-white",children:[t.jsx(S,{}),t.jsx(N,{}),t.jsx(q,{}),t.jsxs("div",{className:"flex space-x-2",children:[t.jsx(D,{}),t.jsx(W,{})]})]})}),i&&t.jsx(b,{}),t.jsx(Pr,{isOpen:c,onClose:()=>m(!1)})]})}function zr({isOpen:e,onClose:r}){return e?t.jsxs("div",{className:"fixed inset-0 z-50",children:[t.jsx("div",{className:"bg-opacity-50 fixed inset-0 bg-black",onClick:r}),t.jsxs("div",{className:"fixed inset-4 flex max-h-full flex-col rounded-lg bg-white shadow-xl dark:bg-gray-800",children:[t.jsxs("div",{className:"flex items-center justify-between border-b border-gray-200 p-4 dark:border-gray-600",children:[t.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100",children:"Time Report"}),t.jsx("button",{onClick:r,className:"text-2xl text-gray-500 hover:text-gray-800 dark:text-gray-400 dark:hover:text-gray-200","aria-label":"Close",children:"√ó"})]}),t.jsx("div",{className:"flex-1 overflow-y-auto p-4",children:t.jsx(Fr,{})})]})]}):null}function ht(e){var r,n,s="";if(typeof e=="string"||typeof e=="number")s+=e;else if(typeof e=="object")if(Array.isArray(e)){var o=e.length;for(r=0;r<o;r++)e[r]&&(n=ht(e[r]))&&(s&&(s+=" "),s+=n)}else for(n in e)e[n]&&(s&&(s+=" "),s+=n);return s}function Ur(){for(var e,r,n=0,s="",o=arguments.length;n<o;n++)(e=arguments[n])&&(r=ht(e))&&(s&&(s+=" "),s+=r);return s}const Oe="-",Qr=e=>{const r=Wr(e),{conflictingClassGroups:n,conflictingClassGroupModifiers:s}=e;return{getClassGroupId:i=>{const l=i.split(Oe);return l[0]===""&&l.length!==1&&l.shift(),gt(l,r)||Br(i)},getConflictingClassGroupIds:(i,l)=>{const c=n[i]||[];return l&&s[i]?[...c,...s[i]]:c}}},gt=(e,r)=>{if(e.length===0)return r.classGroupId;const n=e[0],s=r.nextPart.get(n),o=s?gt(e.slice(1),s):void 0;if(o)return o;if(r.validators.length===0)return;const a=e.join(Oe);return r.validators.find(({validator:i})=>i(a))?.classGroupId},We=/^\[(.+)\]$/,Br=e=>{if(We.test(e)){const r=We.exec(e)[1],n=r?.substring(0,r.indexOf(":"));if(n)return"arbitrary.."+n}},Wr=e=>{const{theme:r,classGroups:n}=e,s={nextPart:new Map,validators:[]};for(const o in n)Se(n[o],s,o,r);return s},Se=(e,r,n,s)=>{e.forEach(o=>{if(typeof o=="string"){const a=o===""?r:Ge(r,o);a.classGroupId=n;return}if(typeof o=="function"){if(Gr(o)){Se(o(s),r,n,s);return}r.validators.push({validator:o,classGroupId:n});return}Object.entries(o).forEach(([a,i])=>{Se(i,Ge(r,a),n,s)})})},Ge=(e,r)=>{let n=e;return r.split(Oe).forEach(s=>{n.nextPart.has(s)||n.nextPart.set(s,{nextPart:new Map,validators:[]}),n=n.nextPart.get(s)}),n},Gr=e=>e.isThemeGetter,Hr=e=>{if(e<1)return{get:()=>{},set:()=>{}};let r=0,n=new Map,s=new Map;const o=(a,i)=>{n.set(a,i),r++,r>e&&(r=0,s=n,n=new Map)};return{get(a){let i=n.get(a);if(i!==void 0)return i;if((i=s.get(a))!==void 0)return o(a,i),i},set(a,i){n.has(a)?n.set(a,i):o(a,i)}}},Te="!",De=":",Kr=De.length,Vr=e=>{const{prefix:r,experimentalParseClassName:n}=e;let s=o=>{const a=[];let i=0,l=0,c=0,m;for(let _=0;_<o.length;_++){let d=o[_];if(i===0&&l===0){if(d===De){a.push(o.slice(c,_)),c=_+Kr;continue}if(d==="/"){m=_;continue}}d==="["?i++:d==="]"?i--:d==="("?l++:d===")"&&l--}const h=a.length===0?o:o.substring(c),x=Yr(h),u=x!==h,j=m&&m>c?m-c:void 0;return{modifiers:a,hasImportantModifier:u,baseClassName:x,maybePostfixModifierPosition:j}};if(r){const o=r+De,a=s;s=i=>i.startsWith(o)?a(i.substring(o.length)):{isExternal:!0,modifiers:[],hasImportantModifier:!1,baseClassName:i,maybePostfixModifierPosition:void 0}}if(n){const o=s;s=a=>n({className:a,parseClassName:o})}return s},Yr=e=>e.endsWith(Te)?e.substring(0,e.length-1):e.startsWith(Te)?e.substring(1):e,Jr=e=>{const r=Object.fromEntries(e.orderSensitiveModifiers.map(s=>[s,!0]));return s=>{if(s.length<=1)return s;const o=[];let a=[];return s.forEach(i=>{i[0]==="["||r[i]?(o.push(...a.sort(),i),a=[]):a.push(i)}),o.push(...a.sort()),o}},Xr=e=>({cache:Hr(e.cacheSize),parseClassName:Vr(e),sortModifiers:Jr(e),...Qr(e)}),Zr=/\s+/,es=(e,r)=>{const{parseClassName:n,getClassGroupId:s,getConflictingClassGroupIds:o,sortModifiers:a}=r,i=[],l=e.trim().split(Zr);let c="";for(let m=l.length-1;m>=0;m-=1){const h=l[m],{isExternal:x,modifiers:u,hasImportantModifier:j,baseClassName:_,maybePostfixModifierPosition:d}=n(h);if(x){c=h+(c.length>0?" "+c:c);continue}let k=!!d,S=s(k?_.substring(0,d):_);if(!S){if(!k){c=h+(c.length>0?" "+c:c);continue}if(S=s(_),!S){c=h+(c.length>0?" "+c:c);continue}k=!1}const N=a(u).join(":"),q=j?N+Te:N,D=q+S;if(i.includes(D))continue;i.push(D);const W=o(S,k);for(let I=0;I<W.length;++I){const G=W[I];i.push(q+G)}c=h+(c.length>0?" "+c:c)}return c};function ts(){let e=0,r,n,s="";for(;e<arguments.length;)(r=arguments[e++])&&(n=xt(r))&&(s&&(s+=" "),s+=n);return s}const xt=e=>{if(typeof e=="string")return e;let r,n="";for(let s=0;s<e.length;s++)e[s]&&(r=xt(e[s]))&&(n&&(n+=" "),n+=r);return n};function rs(e,...r){let n,s,o,a=i;function i(c){const m=r.reduce((h,x)=>x(h),e());return n=Xr(m),s=n.cache.get,o=n.cache.set,a=l,l(c)}function l(c){const m=s(c);if(m)return m;const h=es(c,n);return o(c,h),h}return function(){return a(ts.apply(null,arguments))}}const F=e=>{const r=n=>n[e]||[];return r.isThemeGetter=!0,r},ft=/^\[(?:(\w[\w-]*):)?(.+)\]$/i,pt=/^\((?:(\w[\w-]*):)?(.+)\)$/i,ss=/^\d+\/\d+$/,ns=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,os=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,as=/^(rgba?|hsla?|hwb|(ok)?(lab|lch)|color-mix)\(.+\)$/,is=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,ls=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,ie=e=>ss.test(e),T=e=>!!e&&!Number.isNaN(Number(e)),Z=e=>!!e&&Number.isInteger(Number(e)),ke=e=>e.endsWith("%")&&T(e.slice(0,-1)),V=e=>ns.test(e),cs=()=>!0,ds=e=>os.test(e)&&!as.test(e),yt=()=>!1,us=e=>is.test(e),ms=e=>ls.test(e),hs=e=>!p(e)&&!y(e),gs=e=>ce(e,wt,yt),p=e=>ft.test(e),ne=e=>ce(e,jt,ds),Ne=e=>ce(e,bs,T),He=e=>ce(e,bt,yt),xs=e=>ce(e,vt,ms),xe=e=>ce(e,kt,us),y=e=>pt.test(e),me=e=>de(e,jt),fs=e=>de(e,vs),Ke=e=>de(e,bt),ps=e=>de(e,wt),ys=e=>de(e,vt),fe=e=>de(e,kt,!0),ce=(e,r,n)=>{const s=ft.exec(e);return s?s[1]?r(s[1]):n(s[2]):!1},de=(e,r,n=!1)=>{const s=pt.exec(e);return s?s[1]?r(s[1]):n:!1},bt=e=>e==="position"||e==="percentage",vt=e=>e==="image"||e==="url",wt=e=>e==="length"||e==="size"||e==="bg-size",jt=e=>e==="length",bs=e=>e==="number",vs=e=>e==="family-name",kt=e=>e==="shadow",ws=()=>{const e=F("color"),r=F("font"),n=F("text"),s=F("font-weight"),o=F("tracking"),a=F("leading"),i=F("breakpoint"),l=F("container"),c=F("spacing"),m=F("radius"),h=F("shadow"),x=F("inset-shadow"),u=F("text-shadow"),j=F("drop-shadow"),_=F("blur"),d=F("perspective"),k=F("aspect"),S=F("ease"),N=F("animate"),q=()=>["auto","avoid","all","avoid-page","page","left","right","column"],D=()=>["center","top","bottom","left","right","top-left","left-top","top-right","right-top","bottom-right","right-bottom","bottom-left","left-bottom"],W=()=>[...D(),y,p],I=()=>["auto","hidden","clip","visible","scroll"],G=()=>["auto","contain","none"],b=()=>[y,p,c],v=()=>[ie,"full","auto",...b()],P=()=>[Z,"none","subgrid",y,p],H=()=>["auto",{span:["full",Z,y,p]},Z,y,p],w=()=>[Z,"auto",y,p],$=()=>["auto","min","max","fr",y,p],O=()=>["start","end","center","between","around","evenly","stretch","baseline","center-safe","end-safe"],A=()=>["start","end","center","stretch","center-safe","end-safe"],L=()=>["auto",...b()],E=()=>[ie,"auto","full","dvw","dvh","lvw","lvh","svw","svh","min","max","fit",...b()],f=()=>[e,y,p],Y=()=>[...D(),Ke,He,{position:[y,p]}],oe=()=>["no-repeat",{repeat:["","x","y","space","round"]}],ae=()=>["auto","cover","contain",ps,gs,{size:[y,p]}],ue=()=>[ke,me,ne],U=()=>["","none","full",m,y,p],B=()=>["",T,me,ne],re=()=>["solid","dashed","dotted","double"],C=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],R=()=>[T,ke,Ke,He],K=()=>["","none",_,y,p],J=()=>["none",T,y,p],se=()=>["none",T,y,p],X=()=>[T,y,p],he=()=>[ie,"full",...b()];return{cacheSize:500,theme:{animate:["spin","ping","pulse","bounce"],aspect:["video"],blur:[V],breakpoint:[V],color:[cs],container:[V],"drop-shadow":[V],ease:["in","out","in-out"],font:[hs],"font-weight":["thin","extralight","light","normal","medium","semibold","bold","extrabold","black"],"inset-shadow":[V],leading:["none","tight","snug","normal","relaxed","loose"],perspective:["dramatic","near","normal","midrange","distant","none"],radius:[V],shadow:[V],spacing:["px",T],text:[V],"text-shadow":[V],tracking:["tighter","tight","normal","wide","wider","widest"]},classGroups:{aspect:[{aspect:["auto","square",ie,p,y,k]}],container:["container"],columns:[{columns:[T,p,y,l]}],"break-after":[{"break-after":q()}],"break-before":[{"break-before":q()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],sr:["sr-only","not-sr-only"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:W()}],overflow:[{overflow:I()}],"overflow-x":[{"overflow-x":I()}],"overflow-y":[{"overflow-y":I()}],overscroll:[{overscroll:G()}],"overscroll-x":[{"overscroll-x":G()}],"overscroll-y":[{"overscroll-y":G()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:v()}],"inset-x":[{"inset-x":v()}],"inset-y":[{"inset-y":v()}],start:[{start:v()}],end:[{end:v()}],top:[{top:v()}],right:[{right:v()}],bottom:[{bottom:v()}],left:[{left:v()}],visibility:["visible","invisible","collapse"],z:[{z:[Z,"auto",y,p]}],basis:[{basis:[ie,"full","auto",l,...b()]}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["nowrap","wrap","wrap-reverse"]}],flex:[{flex:[T,ie,"auto","initial","none",p]}],grow:[{grow:["",T,y,p]}],shrink:[{shrink:["",T,y,p]}],order:[{order:[Z,"first","last","none",y,p]}],"grid-cols":[{"grid-cols":P()}],"col-start-end":[{col:H()}],"col-start":[{"col-start":w()}],"col-end":[{"col-end":w()}],"grid-rows":[{"grid-rows":P()}],"row-start-end":[{row:H()}],"row-start":[{"row-start":w()}],"row-end":[{"row-end":w()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":$()}],"auto-rows":[{"auto-rows":$()}],gap:[{gap:b()}],"gap-x":[{"gap-x":b()}],"gap-y":[{"gap-y":b()}],"justify-content":[{justify:[...O(),"normal"]}],"justify-items":[{"justify-items":[...A(),"normal"]}],"justify-self":[{"justify-self":["auto",...A()]}],"align-content":[{content:["normal",...O()]}],"align-items":[{items:[...A(),{baseline:["","last"]}]}],"align-self":[{self:["auto",...A(),{baseline:["","last"]}]}],"place-content":[{"place-content":O()}],"place-items":[{"place-items":[...A(),"baseline"]}],"place-self":[{"place-self":["auto",...A()]}],p:[{p:b()}],px:[{px:b()}],py:[{py:b()}],ps:[{ps:b()}],pe:[{pe:b()}],pt:[{pt:b()}],pr:[{pr:b()}],pb:[{pb:b()}],pl:[{pl:b()}],m:[{m:L()}],mx:[{mx:L()}],my:[{my:L()}],ms:[{ms:L()}],me:[{me:L()}],mt:[{mt:L()}],mr:[{mr:L()}],mb:[{mb:L()}],ml:[{ml:L()}],"space-x":[{"space-x":b()}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":b()}],"space-y-reverse":["space-y-reverse"],size:[{size:E()}],w:[{w:[l,"screen",...E()]}],"min-w":[{"min-w":[l,"screen","none",...E()]}],"max-w":[{"max-w":[l,"screen","none","prose",{screen:[i]},...E()]}],h:[{h:["screen","lh",...E()]}],"min-h":[{"min-h":["screen","lh","none",...E()]}],"max-h":[{"max-h":["screen","lh",...E()]}],"font-size":[{text:["base",n,me,ne]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:[s,y,Ne]}],"font-stretch":[{"font-stretch":["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded",ke,p]}],"font-family":[{font:[fs,p,r]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:[o,y,p]}],"line-clamp":[{"line-clamp":[T,"none",y,Ne]}],leading:[{leading:[a,...b()]}],"list-image":[{"list-image":["none",y,p]}],"list-style-position":[{list:["inside","outside"]}],"list-style-type":[{list:["disc","decimal","none",y,p]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"placeholder-color":[{placeholder:f()}],"text-color":[{text:f()}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...re(),"wavy"]}],"text-decoration-thickness":[{decoration:[T,"from-font","auto",y,ne]}],"text-decoration-color":[{decoration:f()}],"underline-offset":[{"underline-offset":[T,"auto",y,p]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:b()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",y,p]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],wrap:[{wrap:["break-word","anywhere","normal"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",y,p]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:Y()}],"bg-repeat":[{bg:oe()}],"bg-size":[{bg:ae()}],"bg-image":[{bg:["none",{linear:[{to:["t","tr","r","br","b","bl","l","tl"]},Z,y,p],radial:["",y,p],conic:[Z,y,p]},ys,xs]}],"bg-color":[{bg:f()}],"gradient-from-pos":[{from:ue()}],"gradient-via-pos":[{via:ue()}],"gradient-to-pos":[{to:ue()}],"gradient-from":[{from:f()}],"gradient-via":[{via:f()}],"gradient-to":[{to:f()}],rounded:[{rounded:U()}],"rounded-s":[{"rounded-s":U()}],"rounded-e":[{"rounded-e":U()}],"rounded-t":[{"rounded-t":U()}],"rounded-r":[{"rounded-r":U()}],"rounded-b":[{"rounded-b":U()}],"rounded-l":[{"rounded-l":U()}],"rounded-ss":[{"rounded-ss":U()}],"rounded-se":[{"rounded-se":U()}],"rounded-ee":[{"rounded-ee":U()}],"rounded-es":[{"rounded-es":U()}],"rounded-tl":[{"rounded-tl":U()}],"rounded-tr":[{"rounded-tr":U()}],"rounded-br":[{"rounded-br":U()}],"rounded-bl":[{"rounded-bl":U()}],"border-w":[{border:B()}],"border-w-x":[{"border-x":B()}],"border-w-y":[{"border-y":B()}],"border-w-s":[{"border-s":B()}],"border-w-e":[{"border-e":B()}],"border-w-t":[{"border-t":B()}],"border-w-r":[{"border-r":B()}],"border-w-b":[{"border-b":B()}],"border-w-l":[{"border-l":B()}],"divide-x":[{"divide-x":B()}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":B()}],"divide-y-reverse":["divide-y-reverse"],"border-style":[{border:[...re(),"hidden","none"]}],"divide-style":[{divide:[...re(),"hidden","none"]}],"border-color":[{border:f()}],"border-color-x":[{"border-x":f()}],"border-color-y":[{"border-y":f()}],"border-color-s":[{"border-s":f()}],"border-color-e":[{"border-e":f()}],"border-color-t":[{"border-t":f()}],"border-color-r":[{"border-r":f()}],"border-color-b":[{"border-b":f()}],"border-color-l":[{"border-l":f()}],"divide-color":[{divide:f()}],"outline-style":[{outline:[...re(),"none","hidden"]}],"outline-offset":[{"outline-offset":[T,y,p]}],"outline-w":[{outline:["",T,me,ne]}],"outline-color":[{outline:f()}],shadow:[{shadow:["","none",h,fe,xe]}],"shadow-color":[{shadow:f()}],"inset-shadow":[{"inset-shadow":["none",x,fe,xe]}],"inset-shadow-color":[{"inset-shadow":f()}],"ring-w":[{ring:B()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:f()}],"ring-offset-w":[{"ring-offset":[T,ne]}],"ring-offset-color":[{"ring-offset":f()}],"inset-ring-w":[{"inset-ring":B()}],"inset-ring-color":[{"inset-ring":f()}],"text-shadow":[{"text-shadow":["none",u,fe,xe]}],"text-shadow-color":[{"text-shadow":f()}],opacity:[{opacity:[T,y,p]}],"mix-blend":[{"mix-blend":[...C(),"plus-darker","plus-lighter"]}],"bg-blend":[{"bg-blend":C()}],"mask-clip":[{"mask-clip":["border","padding","content","fill","stroke","view"]},"mask-no-clip"],"mask-composite":[{mask:["add","subtract","intersect","exclude"]}],"mask-image-linear-pos":[{"mask-linear":[T]}],"mask-image-linear-from-pos":[{"mask-linear-from":R()}],"mask-image-linear-to-pos":[{"mask-linear-to":R()}],"mask-image-linear-from-color":[{"mask-linear-from":f()}],"mask-image-linear-to-color":[{"mask-linear-to":f()}],"mask-image-t-from-pos":[{"mask-t-from":R()}],"mask-image-t-to-pos":[{"mask-t-to":R()}],"mask-image-t-from-color":[{"mask-t-from":f()}],"mask-image-t-to-color":[{"mask-t-to":f()}],"mask-image-r-from-pos":[{"mask-r-from":R()}],"mask-image-r-to-pos":[{"mask-r-to":R()}],"mask-image-r-from-color":[{"mask-r-from":f()}],"mask-image-r-to-color":[{"mask-r-to":f()}],"mask-image-b-from-pos":[{"mask-b-from":R()}],"mask-image-b-to-pos":[{"mask-b-to":R()}],"mask-image-b-from-color":[{"mask-b-from":f()}],"mask-image-b-to-color":[{"mask-b-to":f()}],"mask-image-l-from-pos":[{"mask-l-from":R()}],"mask-image-l-to-pos":[{"mask-l-to":R()}],"mask-image-l-from-color":[{"mask-l-from":f()}],"mask-image-l-to-color":[{"mask-l-to":f()}],"mask-image-x-from-pos":[{"mask-x-from":R()}],"mask-image-x-to-pos":[{"mask-x-to":R()}],"mask-image-x-from-color":[{"mask-x-from":f()}],"mask-image-x-to-color":[{"mask-x-to":f()}],"mask-image-y-from-pos":[{"mask-y-from":R()}],"mask-image-y-to-pos":[{"mask-y-to":R()}],"mask-image-y-from-color":[{"mask-y-from":f()}],"mask-image-y-to-color":[{"mask-y-to":f()}],"mask-image-radial":[{"mask-radial":[y,p]}],"mask-image-radial-from-pos":[{"mask-radial-from":R()}],"mask-image-radial-to-pos":[{"mask-radial-to":R()}],"mask-image-radial-from-color":[{"mask-radial-from":f()}],"mask-image-radial-to-color":[{"mask-radial-to":f()}],"mask-image-radial-shape":[{"mask-radial":["circle","ellipse"]}],"mask-image-radial-size":[{"mask-radial":[{closest:["side","corner"],farthest:["side","corner"]}]}],"mask-image-radial-pos":[{"mask-radial-at":D()}],"mask-image-conic-pos":[{"mask-conic":[T]}],"mask-image-conic-from-pos":[{"mask-conic-from":R()}],"mask-image-conic-to-pos":[{"mask-conic-to":R()}],"mask-image-conic-from-color":[{"mask-conic-from":f()}],"mask-image-conic-to-color":[{"mask-conic-to":f()}],"mask-mode":[{mask:["alpha","luminance","match"]}],"mask-origin":[{"mask-origin":["border","padding","content","fill","stroke","view"]}],"mask-position":[{mask:Y()}],"mask-repeat":[{mask:oe()}],"mask-size":[{mask:ae()}],"mask-type":[{"mask-type":["alpha","luminance"]}],"mask-image":[{mask:["none",y,p]}],filter:[{filter:["","none",y,p]}],blur:[{blur:K()}],brightness:[{brightness:[T,y,p]}],contrast:[{contrast:[T,y,p]}],"drop-shadow":[{"drop-shadow":["","none",j,fe,xe]}],"drop-shadow-color":[{"drop-shadow":f()}],grayscale:[{grayscale:["",T,y,p]}],"hue-rotate":[{"hue-rotate":[T,y,p]}],invert:[{invert:["",T,y,p]}],saturate:[{saturate:[T,y,p]}],sepia:[{sepia:["",T,y,p]}],"backdrop-filter":[{"backdrop-filter":["","none",y,p]}],"backdrop-blur":[{"backdrop-blur":K()}],"backdrop-brightness":[{"backdrop-brightness":[T,y,p]}],"backdrop-contrast":[{"backdrop-contrast":[T,y,p]}],"backdrop-grayscale":[{"backdrop-grayscale":["",T,y,p]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[T,y,p]}],"backdrop-invert":[{"backdrop-invert":["",T,y,p]}],"backdrop-opacity":[{"backdrop-opacity":[T,y,p]}],"backdrop-saturate":[{"backdrop-saturate":[T,y,p]}],"backdrop-sepia":[{"backdrop-sepia":["",T,y,p]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":b()}],"border-spacing-x":[{"border-spacing-x":b()}],"border-spacing-y":[{"border-spacing-y":b()}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["","all","colors","opacity","shadow","transform","none",y,p]}],"transition-behavior":[{transition:["normal","discrete"]}],duration:[{duration:[T,"initial",y,p]}],ease:[{ease:["linear","initial",S,y,p]}],delay:[{delay:[T,y,p]}],animate:[{animate:["none",N,y,p]}],backface:[{backface:["hidden","visible"]}],perspective:[{perspective:[d,y,p]}],"perspective-origin":[{"perspective-origin":W()}],rotate:[{rotate:J()}],"rotate-x":[{"rotate-x":J()}],"rotate-y":[{"rotate-y":J()}],"rotate-z":[{"rotate-z":J()}],scale:[{scale:se()}],"scale-x":[{"scale-x":se()}],"scale-y":[{"scale-y":se()}],"scale-z":[{"scale-z":se()}],"scale-3d":["scale-3d"],skew:[{skew:X()}],"skew-x":[{"skew-x":X()}],"skew-y":[{"skew-y":X()}],transform:[{transform:[y,p,"","none","gpu","cpu"]}],"transform-origin":[{origin:W()}],"transform-style":[{transform:["3d","flat"]}],translate:[{translate:he()}],"translate-x":[{"translate-x":he()}],"translate-y":[{"translate-y":he()}],"translate-z":[{"translate-z":he()}],"translate-none":["translate-none"],accent:[{accent:f()}],appearance:[{appearance:["none","auto"]}],"caret-color":[{caret:f()}],"color-scheme":[{scheme:["normal","dark","light","light-dark","only-dark","only-light"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",y,p]}],"field-sizing":[{"field-sizing":["fixed","content"]}],"pointer-events":[{"pointer-events":["auto","none"]}],resize:[{resize:["none","","y","x"]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":b()}],"scroll-mx":[{"scroll-mx":b()}],"scroll-my":[{"scroll-my":b()}],"scroll-ms":[{"scroll-ms":b()}],"scroll-me":[{"scroll-me":b()}],"scroll-mt":[{"scroll-mt":b()}],"scroll-mr":[{"scroll-mr":b()}],"scroll-mb":[{"scroll-mb":b()}],"scroll-ml":[{"scroll-ml":b()}],"scroll-p":[{"scroll-p":b()}],"scroll-px":[{"scroll-px":b()}],"scroll-py":[{"scroll-py":b()}],"scroll-ps":[{"scroll-ps":b()}],"scroll-pe":[{"scroll-pe":b()}],"scroll-pt":[{"scroll-pt":b()}],"scroll-pr":[{"scroll-pr":b()}],"scroll-pb":[{"scroll-pb":b()}],"scroll-pl":[{"scroll-pl":b()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",y,p]}],fill:[{fill:["none",...f()]}],"stroke-w":[{stroke:[T,me,ne,Ne]}],stroke:[{stroke:["none",...f()]}],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-x","border-w-y","border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-x","border-color-y","border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],translate:["translate-x","translate-y","translate-none"],"translate-none":["translate","translate-x","translate-y","translate-z"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]},orderSensitiveModifiers:["*","**","after","backdrop","before","details-content","file","first-letter","first-line","marker","placeholder","selection"]}},js=rs(ws);function ks(...e){return js(Ur(e))}function Nt({onClick:e,showLabel:r=!1,className:n}){return t.jsxs("button",{onClick:e,className:ks("flex items-center space-x-1 rounded p-2 text-gray-300 transition-colors hover:text-white",!r&&"justify-center",n),title:"Quick Add Task",children:[t.jsx("svg",{className:"h-5 w-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),r&&t.jsx("span",{className:"hidden text-sm sm:inline",children:"Quick Add"})]})}function _t({onClick:e}){return t.jsxs("button",{onClick:e,className:"text-gray-300 hover:text-white transition-colors flex items-center space-x-1",title:"Tasks Due Today",children:[t.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2 2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})}),t.jsx("span",{className:"hidden sm:inline text-sm",children:"Today"})]})}function Ns({onOpenTasksDueToday:e,onOpenQuickAdd:r,onOpenTimeReport:n,onOpenHamburger:s}){return t.jsx(t.Fragment,{children:t.jsxs("div",{className:"flex items-center justify-between px-4 py-3",children:[t.jsx("button",{onClick:s,className:"rounded p-2 text-gray-300 transition-colors hover:text-white","aria-label":"Open navigation menu",children:t.jsx("svg",{className:"h-6 w-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})}),t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx(Je,{}),t.jsx(_t,{onClick:e}),t.jsx("button",{onClick:n,children:"‚è±Ô∏è"}),t.jsx(Nt,{onClick:r})]})]})})}function _s({onTaskClick:e}){const[r,n]=g.useState(!1),s=g.useRef(null),{data:o,isLoading:a}=ut();g.useEffect(()=>{function c(m){s.current&&!s.current.contains(m.target)&&n(!1)}if(r)return document.addEventListener("mousedown",c),()=>{document.removeEventListener("mousedown",c)}},[r]);const i=c=>{n(!1),e(c)},l=o?.length??0;return t.jsxs("div",{className:"relative",ref:s,children:[t.jsxs("button",{onClick:()=>n(!r),className:"flex items-center space-x-1 text-gray-300 transition-colors hover:text-white",title:"Recent Tasks",children:[t.jsx("svg",{className:"h-5 w-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),t.jsx("span",{className:"hidden text-sm sm:inline",children:"Recent"}),l>0&&t.jsx("span",{className:"flex h-5 min-w-5 items-center justify-center rounded-full bg-blue-600 px-1.5 text-xs font-bold text-white",children:l})]}),r&&t.jsxs("div",{className:"absolute right-0 top-full z-50 mt-2 w-80 rounded-lg border border-gray-700 bg-gray-800 shadow-xl",children:[t.jsxs("div",{className:"border-b border-gray-700 px-4 py-3",children:[t.jsx("h3",{className:"font-semibold text-white",children:"Recently Touched Tasks"}),t.jsx("p",{className:"text-xs text-gray-400",children:"Last 10 tasks you've created, edited, or viewed"})]}),t.jsxs("div",{className:"max-h-96 overflow-y-auto",children:[a&&t.jsx("div",{className:"flex items-center justify-center py-8",children:t.jsx("div",{className:"h-6 w-6 animate-spin rounded-full border-b-2 border-blue-600"})}),!a&&l===0&&t.jsx("div",{className:"py-8 text-center",children:t.jsx("p",{className:"text-sm text-gray-400",children:"No recent tasks yet"})}),!a&&l>0&&t.jsx("ul",{className:"divide-y divide-gray-700",children:o?.map(c=>t.jsx("li",{children:t.jsxs("button",{onClick:()=>i(c),className:"w-full px-4 py-3 text-left transition-colors hover:bg-gray-700/50",children:[t.jsxs("div",{className:"flex items-start justify-between",children:[t.jsxs("div",{className:"flex-1",children:[t.jsx("p",{className:"font-medium text-white",children:c.name}),t.jsxs("p",{className:"text-xs text-gray-400",children:[c.root_category,c.deadline&&t.jsxs(t.Fragment,{children:[" ","‚Ä¢ Due"," ",new Date(c.deadline).toLocaleDateString()]})]})]}),c.importance&&c.importance>=8&&t.jsx("span",{className:"ml-2 flex-shrink-0 text-xs text-purple-400",children:"‚òÖ"})]}),c.last_touched_at&&t.jsx("p",{className:"mt-1 text-xs text-gray-500",children:Cs(c.last_touched_at)})]})},c.id))})]})]})]})}function Cs(e){const r=new Date(e),s=Math.floor((new Date().getTime()-r.getTime())/1e3);return s<60?"Just now":s<3600?`${Math.floor(s/60)}m ago`:s<86400?`${Math.floor(s/3600)}h ago`:s<604800?`${Math.floor(s/86400)}d ago`:r.toLocaleDateString()}function Ss({onOpenTasksDueToday:e,onOpenQuickAdd:r,onOpenHamburger:n,activeTab:s,onRecentTaskClick:o}){return t.jsx("div",{className:"border-b border-gray-700/50 bg-gray-900/95 shadow-md backdrop-blur-sm dark:border-gray-600/50 dark:bg-gray-800/95",children:t.jsxs("div",{className:"mx-auto flex max-w-[1800px] items-center justify-between px-6 py-3",children:[t.jsxs("div",{className:"flex items-center gap-6",children:[t.jsxs(pe,{to:"/",className:"flex items-center gap-2 rounded-lg px-3 py-2 text-base font-semibold text-gray-300 transition-all hover:bg-gray-800/60 hover:text-white dark:hover:bg-gray-700/60",children:[t.jsx("svg",{className:"h-5 w-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"})}),t.jsx("span",{children:"Home"})]}),t.jsx("div",{className:"block min-[1000px]:hidden",children:t.jsx("button",{onClick:n,className:"rounded-lg p-2 text-gray-300 transition-colors hover:bg-gray-800/60 hover:text-white","aria-label":"Open navigation menu",children:t.jsx("svg",{className:"h-6 w-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})})}),t.jsx("div",{className:"hidden min-[1000px]:block",children:t.jsx(dt,{activeTab:s,variant:"desktop"})})]}),t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx(Je,{}),t.jsx(_s,{onTaskClick:o}),t.jsx(_t,{onClick:e}),t.jsx(Nt,{onClick:r,showLabel:!0,className:"bg-blue-600 hover:bg-blue-700 dark:bg-blue-700 dark:hover:bg-blue-600"})]})]})})}const Ts=new Pt,Ds=["Household","Finances","Cleo","Job","Social","Personal","Orphans"];function Es(){const{tabName:e}=St(),r=e||"Household",[n,s]=g.useState(!1),[o,a]=g.useState(!1),[i,l]=g.useState(!1),[c,m]=g.useState(!1),h=at(),{data:x,isLoading:u,error:j}=ve({queryKey:["orgTree",r],queryFn:()=>Me(r),placeholderData:Ye});return e&&!Ds.includes(e)?t.jsx(Tt,{to:"/org-chart/Household",replace:!0}):t.jsxs("div",{className:"app-layout",children:[t.jsx("nav",{className:"nav sticky top-0 z-40 bg-gray-900 dark:bg-gray-800",children:h?t.jsx(Ns,{onOpenTasksDueToday:()=>s(!0),onOpenTimeReport:()=>l(!0),onOpenQuickAdd:()=>a(!0),onOpenHamburger:()=>m(!0)}):t.jsx(Ss,{onOpenTasksDueToday:()=>s(!0),onOpenQuickAdd:()=>a(!0),onOpenHamburger:()=>m(!0),activeTab:r})}),t.jsxs("main",{className:"main p-4",children:[u&&t.jsxs("div",{className:"text-gray-900 dark:text-gray-100",children:["Loading ",r," tree..."]}),j&&t.jsxs("div",{className:"text-red-600 dark:text-red-400",children:["Error loading ",r," tree"]}),x&&t.jsx(fr,{tabName:r})]}),n&&t.jsx(kr,{isOpen:n,onClose:()=>s(!1)}),o&&t.jsx(pr,{isOpen:o,onClose:()=>a(!1)}),i&&t.jsx(zr,{isOpen:i,onClose:()=>l(!1)}),c&&t.jsx(Cr,{isOpen:c,onClose:()=>m(!1),activeTab:r})]})}const qs=Ct(function(){return t.jsx(Ft,{client:Ts,children:t.jsx(Es,{})})});export{qs as default};
