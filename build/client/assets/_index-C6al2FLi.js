import{p as e,t as A,a as g,w as _}from"./chunk-PVWAREVJ-C9qE2fA-.js";import{P as O}from"./ProtectedRoute-DvR4G2Fq.js";import{u as k,Q as q,a as H}from"./QueryClientProvider-CC2Z6-5f.js";import{u as W,a as R,b as K,M as z,D as I,T as U,Q as G,c as Y,d as $}from"./MobileHamburgerMenu-CgqagZ5h.js";import{u as N,Q as l}from"./TaskForm-zXqqAvTt.js";import{s as f}from"./supabaseClient-Btf0BZYh.js";import{u as B}from"./AuthContext-CtIaUxkA.js";import{u as V}from"./useQuery-jVOp7vHI.js";import"./DarkModeToggle-B8WQ3-QW.js";function J({category:t,nodeCount:s=0,criticalCount:r=0,onEdit:a,onDelete:o}){return e.jsxs("div",{className:"group relative overflow-hidden rounded-lg border border-gray-700/50 bg-gray-900/50 transition-all hover:border-blue-500/50 hover:bg-gray-800/50 hover:shadow-lg hover:shadow-blue-500/10 dark:border-gray-600/50 dark:bg-gray-800/50",children:[e.jsx("div",{className:"absolute left-0 top-0 h-full w-1",style:{backgroundColor:t.color}}),e.jsxs(A,{to:`/org-chart/${t.id}`,className:"block p-6 pl-8",children:[e.jsx("h3",{className:"mb-2 text-lg font-semibold text-white group-hover:text-blue-400",children:t.name}),t.description&&e.jsx("p",{className:"mb-3 text-sm text-gray-400 line-clamp-2",children:t.description}),e.jsxs("div",{className:"flex items-center gap-4 text-sm",children:[r>0&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"flex h-6 min-w-[24px] items-center justify-center rounded-full bg-red-500 px-2 text-xs font-bold text-white",children:r>99?"99+":r}),e.jsxs("span",{className:"text-gray-400",children:["Critical task",r!==1?"s":""]})]}),r===0&&e.jsxs("span",{className:"text-gray-500",children:[s," node",s!==1?"s":""]})]}),e.jsx("div",{className:"absolute bottom-4 right-4 opacity-0 transition-opacity group-hover:opacity-100",children:e.jsx("svg",{className:"h-5 w-5 text-blue-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})})]}),e.jsxs("div",{className:"absolute right-2 top-2 flex gap-1 opacity-0 transition-opacity group-hover:opacity-100",children:[e.jsx("button",{onClick:i=>{i.preventDefault(),a(t)},className:"rounded bg-gray-800/90 p-2 text-gray-400 transition-colors hover:bg-gray-700 hover:text-blue-400",title:"Edit category",children:e.jsx("svg",{className:"h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})})}),e.jsx("button",{onClick:i=>{i.preventDefault(),o(t)},className:"rounded bg-gray-800/90 p-2 text-gray-400 transition-colors hover:bg-red-600 hover:text-white",title:"Delete category",children:e.jsx("svg",{className:"h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})]})}const X=[{name:"Blue",value:"#3B82F6"},{name:"Green",value:"#10B981"},{name:"Red",value:"#EF4444"},{name:"Yellow",value:"#F59E0B"},{name:"Purple",value:"#8B5CF6"},{name:"Pink",value:"#EC4899"},{name:"Cyan",value:"#06B6D4"},{name:"Gray",value:"#6B7280"}];function Z({isOpen:t,onClose:s,onSubmit:r,initialData:a,isLoading:o=!1}){const[i,d]=g.useState(""),[h,n]=g.useState(""),[m,x]=g.useState("#3B82F6"),[y,p]=g.useState("");g.useEffect(()=>{a?(d(a.name),n(a.description||""),x(a.color)):(d(""),n(""),x("#3B82F6"))},[a,t]);const v=c=>{if(c.preventDefault(),!i.trim())return;const C=y||m;r({name:i.trim(),description:h.trim()||void 0,color:C}),d(""),n(""),x("#3B82F6"),p("")},E=()=>{d(""),n(""),x("#3B82F6"),p(""),s()};return t?e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 p-4",children:e.jsxs("div",{className:"w-full max-w-md rounded-lg border border-gray-700 bg-gray-900 p-6 shadow-xl dark:border-gray-600 dark:bg-gray-800",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-white",children:a?"Edit Category":"Create Category"}),e.jsx("p",{className:"mt-2 text-sm text-gray-400",children:a?"Update your category details":"Add a new category to organize your tasks"})]}),e.jsxs("form",{onSubmit:v,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"category-name",className:"mb-2 block text-sm font-medium text-gray-300",children:["Name ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{id:"category-name",type:"text",value:i,onChange:c=>d(c.target.value),placeholder:"e.g., Work, Personal, Home",required:!0,maxLength:255,className:"w-full rounded-lg border border-gray-600 bg-gray-800 px-4 py-2 text-white placeholder-gray-500 focus:border-blue-500 focus:outline-none focus:ring-2 focus:ring-blue-500/50"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"category-description",className:"mb-2 block text-sm font-medium text-gray-300",children:"Description (optional)"}),e.jsx("textarea",{id:"category-description",value:h,onChange:c=>n(c.target.value),placeholder:"What is this category for?",rows:3,maxLength:500,className:"w-full rounded-lg border border-gray-600 bg-gray-800 px-4 py-2 text-white placeholder-gray-500 focus:border-blue-500 focus:outline-none focus:ring-2 focus:ring-blue-500/50"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"mb-2 block text-sm font-medium text-gray-300",children:"Color"}),e.jsx("div",{className:"mb-3 grid grid-cols-4 gap-2",children:X.map(c=>e.jsx("button",{type:"button",onClick:()=>{x(c.value),p("")},className:`flex h-10 items-center justify-center rounded-lg border-2 transition-all ${m===c.value&&!y?"border-white scale-105":"border-gray-600 hover:border-gray-400"}`,style:{backgroundColor:c.value},title:c.name,children:m===c.value&&!y&&e.jsx("svg",{className:"h-5 w-5 text-white drop-shadow",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})},c.value))}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"color",value:y||m,onChange:c=>p(c.target.value),className:"h-10 w-16 cursor-pointer rounded border border-gray-600 bg-gray-800"}),e.jsxs("span",{className:"text-sm text-gray-400",children:["Custom color: ",y||m]})]})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx("button",{type:"submit",disabled:o||!i.trim(),className:"flex-1 rounded-lg bg-blue-600 px-4 py-2 font-medium text-white transition-colors hover:bg-blue-700 disabled:cursor-not-allowed disabled:opacity-50",children:o?"Saving...":a?"Update Category":"Create Category"}),e.jsx("button",{type:"button",onClick:E,disabled:o,className:"flex-1 rounded-lg border border-gray-600 bg-gray-800 px-4 py-2 font-medium text-gray-300 transition-colors hover:bg-gray-700 disabled:cursor-not-allowed disabled:opacity-50",children:"Cancel"})]})]})]})}):null}const ee=[{name:"Default",description:"Balanced mix for personal task management",categories:[{name:"Household",description:"Home maintenance, chores, and household tasks",color:"#10B981"},{name:"Finances",description:"Financial planning, budgeting, and money management",color:"#3B82F6"},{name:"Job",description:"Work-related tasks and career development",color:"#8B5CF6"},{name:"Social",description:"Social events, relationships, and networking",color:"#EC4899"},{name:"Personal",description:"Personal goals, hobbies, and self-improvement",color:"#06B6D4"},{name:"Health",description:"Health, fitness, and wellness activities",color:"#F59E0B"},{name:"Misc",description:"Miscellaneous and uncategorized tasks",color:"#6B7280"}]},{name:"Work-Focused",description:"Optimized for professional task management",categories:[{name:"Projects",description:"Active project work and deliverables",color:"#3B82F6"},{name:"Meetings",description:"Scheduled meetings and calls",color:"#8B5CF6"},{name:"Planning",description:"Strategy, planning, and roadmapping",color:"#06B6D4"},{name:"Admin",description:"Administrative tasks and paperwork",color:"#6B7280"},{name:"Learning",description:"Professional development and training",color:"#F59E0B"},{name:"Personal",description:"Personal tasks and errands",color:"#10B981"}]},{name:"Student Life",description:"Designed for academic and student needs",categories:[{name:"Classes",description:"Course work, lectures, and assignments",color:"#3B82F6"},{name:"Study",description:"Study sessions and exam preparation",color:"#8B5CF6"},{name:"Projects",description:"Group projects and presentations",color:"#06B6D4"},{name:"Extracurricular",description:"Clubs, sports, and activities",color:"#EC4899"},{name:"Personal",description:"Personal tasks and self-care",color:"#10B981"},{name:"Social",description:"Social events and friendships",color:"#F59E0B"}]},{name:"Family-Focused",description:"For managing family and household responsibilities",categories:[{name:"Kids",description:"Children's activities, school, and care",color:"#EC4899"},{name:"Home",description:"Home maintenance and household chores",color:"#10B981"},{name:"Shopping",description:"Groceries, supplies, and errands",color:"#F59E0B"},{name:"Finances",description:"Bills, budgeting, and financial planning",color:"#3B82F6"},{name:"Health",description:"Medical appointments and health tasks",color:"#EF4444"},{name:"Personal",description:"Personal time and self-care",color:"#8B5CF6"},{name:"Social",description:"Family events and social activities",color:"#06B6D4"}]},{name:"Minimal",description:"Simple setup with just the essentials",categories:[{name:"Work",description:"Work and professional tasks",color:"#3B82F6"},{name:"Personal",description:"Personal tasks and goals",color:"#10B981"},{name:"Other",description:"Everything else",color:"#6B7280"}]}];async function re(t){const{data:s,error:r}=await f.from("categories").insert({user_id:t.user_id,name:t.name,description:t.description,color:t.color||"#3B82F6",order_index:t.order_index}).select().single();if(r)throw console.error("Error adding category:",r),new Error(r.message);return s}function F(){const t=k(),{user:s}=B();return N({mutationFn:async r=>{if(!s?.id)throw new Error("User not authenticated");const a=t.getQueryData(l.allCategories()),o=a?Math.max(...a.map(i=>i.order_index),-1):-1;return re({user_id:s.id,name:r.name,description:r.description,color:r.color,order_index:o+1})},onMutate:async r=>{await t.cancelQueries({queryKey:l.allCategories()});const a=t.getQueryData(l.allCategories());if(!a||!s?.id)return{previousCategories:null};const o=Math.max(...a.map(d=>d.order_index),-1),i={id:`temp-${Date.now()}`,user_id:s.id,name:r.name,description:r.description,color:r.color||"#3B82F6",order_index:o+1,created_at:new Date().toISOString(),updated_at:new Date().toISOString()};return t.setQueryData(l.allCategories(),[...a,i]),{previousCategories:a}},onSuccess:r=>{const a=t.getQueryData(l.allCategories());if(a){const o=a.filter(i=>!i.id.startsWith("temp-"));t.setQueryData(l.allCategories(),[...o,r])}},onError:(r,a,o)=>{console.error("Error adding category:",r),o?.previousCategories&&t.setQueryData(l.allCategories(),o.previousCategories)},onSettled:()=>{t.invalidateQueries({queryKey:l.allCategories()})}})}function te({isOpen:t,onClose:s}){const[r,a]=g.useState(null),[o,i]=g.useState(!1),d=F(),h=async()=>{if(r){i(!0);try{for(const n of r.categories)await d.mutateAsync({name:n.name,description:n.description,color:n.color});s()}catch(n){console.error("Failed to apply template:",n)}finally{i(!1)}}};return t?e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 p-4",children:e.jsxs("div",{className:"w-full max-w-3xl rounded-lg border border-gray-700 bg-gray-900 p-6 shadow-xl dark:border-gray-600 dark:bg-gray-800",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-white",children:"Category Templates"}),e.jsx("p",{className:"mt-2 text-sm text-gray-400",children:"Choose a template to quickly set up your categories"})]}),r?e.jsxs("div",{children:[e.jsxs("button",{onClick:()=>a(null),className:"mb-4 flex items-center gap-2 text-sm text-gray-400 hover:text-white",children:[e.jsx("svg",{className:"h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})}),"Back to templates"]}),e.jsxs("div",{className:"rounded-lg border border-gray-700 bg-gray-800 p-4 dark:border-gray-600",children:[e.jsx("h3",{className:"mb-2 text-xl font-semibold text-white",children:r.name}),e.jsx("p",{className:"mb-4 text-sm text-gray-400",children:r.description}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("p",{className:"text-sm font-medium text-gray-300",children:["Categories (",r.categories.length,"):"]}),r.categories.map(n=>e.jsxs("div",{className:"flex items-start gap-3 rounded bg-gray-750 p-3",children:[e.jsx("span",{className:"mt-1 h-3 w-3 flex-shrink-0 rounded-full",style:{backgroundColor:n.color}}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-medium text-white",children:n.name}),e.jsx("p",{className:"text-sm text-gray-400",children:n.description})]})]},n.name))]})]})]}):e.jsx("div",{className:"space-y-3",children:ee.map(n=>e.jsx("button",{onClick:()=>a(n),className:"w-full rounded-lg border border-gray-700 bg-gray-800 p-4 text-left transition-all hover:border-blue-500 hover:bg-gray-750 dark:border-gray-600",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-lg font-semibold text-white",children:n.name}),e.jsx("p",{className:"mt-1 text-sm text-gray-400",children:n.description}),e.jsx("div",{className:"mt-3 flex flex-wrap gap-2",children:n.categories.map(m=>e.jsxs("span",{className:"flex items-center gap-1.5 rounded-full bg-gray-700 px-2.5 py-1 text-xs text-gray-300",children:[e.jsx("span",{className:"h-2 w-2 rounded-full",style:{backgroundColor:m.color}}),m.name]},m.name))})]}),e.jsx("svg",{className:"h-5 w-5 flex-shrink-0 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]})},n.name))}),e.jsx("div",{className:"mt-6 flex gap-3",children:r?e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:h,disabled:o,className:"flex-1 rounded-lg bg-blue-600 px-4 py-2 font-medium text-white transition-colors hover:bg-blue-700 disabled:cursor-not-allowed disabled:opacity-50",children:o?"Creating Categories...":"Apply Template"}),e.jsx("button",{onClick:s,disabled:o,className:"rounded-lg border border-gray-600 bg-gray-800 px-4 py-2 font-medium text-gray-300 transition-colors hover:bg-gray-700 disabled:cursor-not-allowed disabled:opacity-50",children:"Cancel"})]}):e.jsx("button",{onClick:s,className:"flex-1 rounded-lg border border-gray-600 bg-gray-800 px-4 py-2 font-medium text-gray-300 transition-colors hover:bg-gray-700",children:"Close"})})]})}):null}async function se(t){const{id:s,...r}=t,{data:a,error:o}=await f.from("categories").update(r).eq("id",s).select().single();if(o)throw console.error("Error editing category:",o),new Error(o.message);return a}function ae(){const t=k();return N({mutationFn:se,onMutate:async s=>{await t.cancelQueries({queryKey:l.allCategories()});const r=t.getQueryData(l.allCategories());if(!r)return{previousCategories:null};const a=r.map(o=>o.id===s.id?{...o,...s,updated_at:new Date().toISOString()}:o);return t.setQueryData(l.allCategories(),a),{previousCategories:r}},onSuccess:s=>{const r=t.getQueryData(l.allCategories());if(r){const a=r.map(o=>o.id===s.id?s:o);t.setQueryData(l.allCategories(),a)}},onError:(s,r,a)=>{console.error("Error editing category:",s),a?.previousCategories&&t.setQueryData(l.allCategories(),a.previousCategories)},onSettled:()=>{t.invalidateQueries({queryKey:l.allCategories()}),t.invalidateQueries({queryKey:l.allOrgTrees()})}})}async function oe(t){const{count:s,error:r}=await f.from("org_nodes").select("*",{count:"exact",head:!0}).eq("category_id",t);if(r)throw console.error("Error checking category nodes:",r),new Error(r.message);return s||0}async function ne(t){const{error:s}=await f.from("categories").delete().eq("id",t);if(s)throw console.error("Error deleting category:",s),new Error(s.message)}function ie(){const t=k();return N({mutationFn:async s=>{if(!s.skipNodeCheck){const r=await oe(s.id);if(r>0)throw new Error(`Cannot delete category: it contains ${r} node(s). Please delete or move the nodes first.`)}return await ne(s.id),s.id},onMutate:async s=>{await t.cancelQueries({queryKey:l.allCategories()});const r=t.getQueryData(l.allCategories());if(!r)return{previousCategories:null};const a=r.filter(o=>o.id!==s.id);return t.setQueryData(l.allCategories(),a),{previousCategories:r}},onError:(s,r,a)=>{console.error("Error deleting category:",s),a?.previousCategories&&t.setQueryData(l.allCategories(),a.previousCategories)},onSettled:()=>{t.invalidateQueries({queryKey:l.allCategories()}),t.invalidateQueries({queryKey:l.allOrgTrees()})}})}async function le(t){const{data:s,error:r}=await f.from("categories").update({archived:!0,archived_at:new Date().toISOString()}).eq("id",t).select().single();if(r)throw console.error("Error archiving category:",r),new Error(r.message);return s}async function de(t){const{data:s,error:r}=await f.from("categories").update({archived:!1,archived_at:null}).eq("id",t).select().single();if(r)throw console.error("Error unarchiving category:",r),new Error(r.message);return s}function ce(){const t=k();return N({mutationFn:async({id:s,archive:r})=>r?le(s):de(s),onSuccess:(s,r)=>{const a=t.getQueryData(l.allCategories());if(a)if(r.archive){const o=a.filter(i=>i.id!==r.id);t.setQueryData(l.allCategories(),o)}else t.setQueryData(l.allCategories(),[...a,s])},onError:s=>{console.error("Error archiving/unarchiving category:",s)},onSettled:()=>{t.invalidateQueries({queryKey:l.allCategories()})}})}async function ue(t){const{data:s,error:r}=await f.from("org_nodes").select("category_id").eq("user_id",t).not("category_id","is",null);if(r)throw console.error("Error fetching category node counts:",r),new Error(r.message);const a={};return(s||[]).forEach(o=>{o.category_id&&(a[o.category_id]=(a[o.category_id]||0)+1)}),a}function ge(){const{user:t}=B();return V({queryKey:["categoryNodeCounts",t?.id],queryFn:()=>{if(!t?.id)throw new Error("User not authenticated");return ue(t.id)},enabled:!!t?.id,staleTime:1e3*60*2})}function me(){const[t,s]=g.useState(!1),[r,a]=g.useState(!1),[o,i]=g.useState(void 0),[d,h]=g.useState(void 0),[n,m]=g.useState(void 0),{data:x,isLoading:y,error:p}=W(),{data:v}=ge(),E=R(),c=F(),C=ae(),b=ie(),j=ce(),S=()=>{i(void 0),s(!0)},M=u=>{i(u),s(!0)},D=u=>{(v?.[u.id]||0)>0?m(u):h(u)},Q=async()=>{if(d)try{await b.mutateAsync({id:d.id}),h(void 0)}catch(u){console.error("Failed to delete category:",u)}},T=async()=>{if(n)try{await j.mutateAsync({id:n.id,archive:!0}),m(void 0)}catch(u){console.error("Failed to archive category:",u)}},L=async u=>{try{o?await C.mutateAsync({id:o.id,...u}):await c.mutateAsync(u),s(!1),i(void 0)}catch(w){console.error("Failed to save category:",w)}};return y?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx("div",{className:"text-gray-400",children:"Loading categories..."})}):p?e.jsxs("div",{className:"rounded-lg border border-red-500/50 bg-red-500/10 p-6",children:[e.jsx("h3",{className:"mb-2 text-lg font-semibold text-red-400",children:"Error loading categories"}),e.jsx("p",{className:"text-sm text-red-300",children:p instanceof Error?p.message:"Unknown error occurred"})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"mb-8",children:[e.jsxs("div",{className:"mb-4 flex items-center justify-between",children:[e.jsx("h2",{className:"text-xl font-semibold text-white",children:"Categories"}),e.jsxs("button",{onClick:S,className:"flex items-center gap-2 rounded-lg bg-blue-600 px-4 py-2 text-sm font-medium text-white transition-colors hover:bg-blue-700",children:[e.jsx("svg",{className:"h-5 w-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"Create Category"]})]}),x&&x.length>0?e.jsx("div",{className:"grid gap-4 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4",children:x.map(u=>{const w=v?.[u.id]||0,P=E[u.name]||0;return e.jsx(J,{category:u,nodeCount:w,criticalCount:P,onEdit:M,onDelete:D},u.id)})}):e.jsxs("div",{className:"rounded-lg border border-gray-700/50 bg-gray-900/30 p-12 text-center dark:border-gray-600/50 dark:bg-gray-800/30",children:[e.jsx("svg",{className:"mx-auto mb-4 h-12 w-12 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20 13V6a2 2 0 00-2-2H6a2 2 0 00-2 2v7m16 0v5a2 2 0 01-2 2H6a2 2 0 01-2-2v-5m16 0h-2.586a1 1 0 00-.707.293l-2.414 2.414a1 1 0 01-.707.293h-3.172a1 1 0 01-.707-.293l-2.414-2.414A1 1 0 006.586 13H4"})}),e.jsx("h3",{className:"mb-2 text-lg font-semibold text-white",children:"No categories yet"}),e.jsx("p",{className:"mb-4 text-sm text-gray-400",children:"Create your first category or use a template to get started quickly"}),e.jsxs("div",{className:"flex justify-center gap-3",children:[e.jsx("button",{onClick:S,className:"rounded-lg bg-blue-600 px-4 py-2 text-sm font-medium text-white transition-colors hover:bg-blue-700",children:"Create Category"}),e.jsx("button",{onClick:()=>a(!0),className:"rounded-lg border border-gray-600 bg-gray-800 px-4 py-2 text-sm font-medium text-gray-300 transition-colors hover:bg-gray-700",children:"Use Template"})]})]})]}),e.jsx(Z,{isOpen:t,onClose:()=>{s(!1),i(void 0)},onSubmit:L,initialData:o,isLoading:c.isPending||C.isPending}),e.jsx(te,{isOpen:r,onClose:()=>a(!1)}),n&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 p-4",children:e.jsxs("div",{className:"w-full max-w-md rounded-lg border border-yellow-700 bg-gray-900 p-6 shadow-xl dark:border-yellow-600 dark:bg-gray-800",children:[e.jsxs("div",{className:"mb-4 flex items-start gap-3",children:[e.jsx("div",{className:"flex h-10 w-10 items-center justify-center rounded-full bg-yellow-500/20",children:e.jsx("svg",{className:"h-6 w-6 text-yellow-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 8h14M5 8a2 2 0 110-4h14a2 2 0 110 4M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8m-9 4h4"})})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-lg font-semibold text-white",children:"Archive Category?"}),e.jsxs("p",{className:"mt-2 text-sm text-gray-400",children:[e.jsx("span",{className:"font-medium text-white",children:n.name})," ","contains ",v?.[n.id]||0," nodes."]}),e.jsx("p",{className:"mt-2 text-sm text-yellow-400",children:"Archiving is recommended instead of deleting. Archived categories can be restored later."})]})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:T,disabled:j.isPending,className:"flex-1 rounded-lg bg-yellow-600 px-4 py-2 font-medium text-white transition-colors hover:bg-yellow-700 disabled:cursor-not-allowed disabled:opacity-50",children:j.isPending?"Archiving...":"Archive Category"}),e.jsx("button",{onClick:()=>m(void 0),disabled:j.isPending,className:"flex-1 rounded-lg border border-gray-600 bg-gray-800 px-4 py-2 font-medium text-gray-300 transition-colors hover:bg-gray-700 disabled:cursor-not-allowed disabled:opacity-50",children:"Cancel"})]})]})}),d&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 p-4",children:e.jsxs("div",{className:"w-full max-w-md rounded-lg border border-red-700 bg-gray-900 p-6 shadow-xl dark:border-red-600 dark:bg-gray-800",children:[e.jsxs("div",{className:"mb-4 flex items-start gap-3",children:[e.jsx("div",{className:"flex h-10 w-10 items-center justify-center rounded-full bg-red-500/20",children:e.jsx("svg",{className:"h-6 w-6 text-red-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-lg font-semibold text-white",children:"Delete Category"}),e.jsxs("p",{className:"mt-2 text-sm text-gray-400",children:["Are you sure you want to delete"," ",e.jsx("span",{className:"font-medium text-white",children:d.name}),"?"]}),e.jsx("p",{className:"mt-2 text-sm text-red-400",children:"Warning: This will also delete all nodes in this category. This action cannot be undone."})]})]}),b.error&&e.jsx("div",{className:"mb-4 rounded bg-red-500/10 p-3 text-sm text-red-400",children:b.error instanceof Error?b.error.message:"Failed to delete category"}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:Q,disabled:b.isPending,className:"flex-1 rounded-lg bg-red-600 px-4 py-2 font-medium text-white transition-colors hover:bg-red-700 disabled:cursor-not-allowed disabled:opacity-50",children:b.isPending?"Deleting...":"Delete Category"}),e.jsx("button",{onClick:()=>h(void 0),disabled:b.isPending,className:"flex-1 rounded-lg border border-gray-600 bg-gray-800 px-4 py-2 font-medium text-gray-300 transition-colors hover:bg-gray-700 disabled:cursor-not-allowed disabled:opacity-50",children:"Cancel"})]})]})})]})}const xe=new q;function he(){const t=K(),[s,r]=g.useState(!1),[a,o]=g.useState(!1),[i,d]=g.useState(void 0),[h,n]=g.useState(!1),[m,x]=g.useState(!1),y=p=>{d(p.id),o(!0)};return e.jsxs("div",{className:"app-layout",children:[e.jsx("nav",{className:"nav bg-gray-900 dark:bg-gray-800",children:t?e.jsx(z,{onOpenTasksDueToday:()=>r(!0),onOpenTimeReport:()=>n(!0),onOpenQuickAdd:()=>o(!0),onOpenHamburger:()=>x(!0)}):e.jsx(I,{onOpenTasksDueToday:()=>r(!0),onOpenQuickAdd:()=>o(!0),onOpenHamburger:()=>x(!0),onRecentTaskClick:y})}),e.jsx("div",{className:"border-b border-gray-700/50 bg-gray-900/95 px-6 py-8 dark:border-gray-600/50 dark:bg-gray-800/95",children:e.jsxs("div",{className:"mx-auto max-w-[1400px]",children:[e.jsx("h1",{className:"text-3xl font-bold text-white",children:"Organization Chart"}),e.jsx("p",{className:"mt-2 text-gray-400",children:"Manage your categories and track tasks across all areas of your life"})]})}),e.jsx("main",{className:"main p-4",children:e.jsx("div",{className:"mx-auto max-w-[1400px] px-2 py-4",children:e.jsx(me,{})})}),s&&e.jsx(U,{isOpen:s,onClose:()=>r(!1)}),a&&e.jsx(G,{isOpen:a,onClose:()=>{o(!1),d(void 0)},initialTaskId:i}),h&&e.jsx(Y,{isOpen:h,onClose:()=>n(!1)}),m&&e.jsx($,{isOpen:m,onClose:()=>x(!1),activeTab:""})]})}const Ne=_(function(){return e.jsx(O,{children:e.jsx(H,{client:xe,children:e.jsx(he,{})})})});export{Ne as default};
